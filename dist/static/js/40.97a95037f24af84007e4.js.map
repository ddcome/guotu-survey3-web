{"version":3,"sources":["webpack:///./node_modules/@greatmap/vue-webgis/lib/intersect-analysis-760289f0.js"],"names":["Object","defineProperty","__webpack_exports__","value","__webpack_require__","__WEBPACK_IMPORTED_MODULE_1_core_js_modules_es6_function_name__","__WEBPACK_IMPORTED_MODULE_2_core_js_modules_es7_array_includes__","n","__WEBPACK_IMPORTED_MODULE_3_core_js_modules_es6_string_includes__","__WEBPACK_IMPORTED_MODULE_4_core_js_modules_es6_array_find__","__WEBPACK_IMPORTED_MODULE_5_core_js_modules_web_dom_iterable__","__WEBPACK_IMPORTED_MODULE_6_core_js_modules_es6_object_keys__","__WEBPACK_IMPORTED_MODULE_8_core_js_modules_es6_string_iterator__","__WEBPACK_IMPORTED_MODULE_9_core_js_library_fn_object_get_own_property_descriptor__","__WEBPACK_IMPORTED_MODULE_10__chunk_786165bb_js__","__WEBPACK_IMPORTED_MODULE_11_core_js_library_fn_object_get_own_property_symbols__","__WEBPACK_IMPORTED_MODULE_12_core_js_library_fn_object_keys__","__WEBPACK_IMPORTED_MODULE_13_core_js_library_fn_object_define_property__","__WEBPACK_IMPORTED_MODULE_14__chunk_82f2c815_js__","__WEBPACK_IMPORTED_MODULE_15__chunk_bc626433_js__","__WEBPACK_IMPORTED_MODULE_16_axios__","__WEBPACK_IMPORTED_MODULE_17_qs_lib_stringify__","__WEBPACK_IMPORTED_MODULE_18__chunk_81d749a9_js__","IntersectAnalysis","map","this","_map","key","layerID","geometry","_this","params","getLayerInfoParams","getLayerInfo","then","res","features","Promise","resolve","sourceFeaturesData","geometries","item","geometryType","geometryObject","formatGeometryObject","sr","url","arcgisRestService","method","data","f","analysisToken","getIntersectGeometry","mapConfig","wkid","JSON","stringify","resultData","attributes","meta","intersectSizeStr","intersectSizeNum","renderFeatureData","forEach","index","area","formatGeometrySize","getGeometry","str","num","layerIDs","_this2","all","doAnalysis"],"mappings":"uDAAAA,OAAAC,eAAAC,EAAA,cAAAC,OAAA,IAAAC,EAAA,YAAAC,EAAAD,EAAA,QAAAE,GAAAF,EAAAG,EAAAF,GAAAD,EAAA,SAAAI,GAAAJ,EAAAG,EAAAD,GAAAF,EAAA,SAAAK,GAAAL,EAAAG,EAAAC,GAAAJ,EAAA,SAAAM,GAAAN,EAAAG,EAAAE,GAAAL,EAAA,SAAAO,GAAAP,EAAAG,EAAAG,GAAAN,EAAA,SAAAQ,GAAAR,EAAAG,EAAAI,GAAAP,EAAA,QAAAA,EAAA,SAAAS,GAAAT,EAAAG,EAAAK,GAAAR,EAAA,SAAAU,GAAAV,EAAAG,EAAAM,GAAAT,EAAA,SAAAW,EAAAX,EAAA,QAAAY,GAAAZ,EAAAG,EAAAQ,GAAAX,EAAA,SAAAa,GAAAb,EAAAG,EAAAS,GAAAZ,EAAA,SAAAc,GAAAd,EAAAG,EAAAU,GAAAb,EAAA,SAAAe,EAAAf,EAAA,QAAAgB,EAAAhB,EAAA,QAAAiB,GAAAjB,EAAAG,EAAAa,GAAAhB,EAAA,SAAAkB,GAAAlB,EAAAG,EAAAc,GAAAjB,EAAA,SAsCA,IAAAmB,EAEA,WACA,SAAAA,EAAAC,GACIxB,OAAAkB,EAAA,EAAAlB,CAAeyB,KAAAF,GAEfvB,OAAAkB,EAAA,EAAAlB,CAAeyB,KAAA,eAEnBA,KAAAC,KAAAF,EAyEA,OAtEExB,OAAAkB,EAAA,EAAAlB,CAAYuB,IACdI,IAAA,aACAxB,MAAA,SAAAyB,EAAAC,GACA,IAAAC,EAAAL,KAEAM,EAAAN,KAAAC,KAAAM,mBAAAJ,GAEA,OAAAG,EACAN,KAAAC,KAAAO,aAAAF,GAAAG,KAAA,SAAAC,GACA,IAAenC,OAAAsB,EAAA,EAAAtB,CAAemC,EAAAC,UAC9B,OAAAC,QAAAC,YAGA,IAAAC,EAAAJ,EACAK,GACAA,WAAAL,EAAAC,SAAAZ,IAAA,SAAAiB,GACA,OAAAA,EAAAZ,WAEAa,aAAAP,EAAAO,cAGAC,EAAAb,EAAAJ,KAAAkB,qBAAAf;;;;AAEA,OAhDA,SAAAgB,EAAAL,EAAAX,GACA,OAAS7B,OAAAsB,EAAA,EAAAtB,EACT8C,IAAS3B,EAAA,EAAa4B,kBAAA,8CACtBC,OAAA,OACAC,MACAC,EAAA,OACAL,KACAhB,WACAW,cAEAW,eAAA,IAsCAC,CAAAtB,EAAAJ,KAAA2B,UAAAC,KAAAC,KAAAC,UAAAhB,GAAAe,KAAAC,UAAAb,IAAAT,KAAA,SAAAC,GACA,IAAAsB,EAAAlB,EAAAH,SAAAZ,IAAA,SAAAiB,GACA,OAAqBzC,OAAAc,EAAA,EAAAd,IAAgByC,EAAAiB,YACrCC,MACAC,iBAAA,GACAC,iBAAA,OAKgB7D,OAAAsB,EAAA,EAAAtB,CAAemC,EAAAK,aAC/BV,EAAAJ,KAAAoC,mBACA1B,SAAAD,EAAAK,WAAAhB,IAAA,SAAAiB,GACA,OACAZ,SAAAY,OAKAsB,QAAA,SAAAtB,EAAAuB,GACA,IAAAC,EAAAnC,EAAAJ,KAAAwC,mBAAAzB,EAAA0B,eAEAV,EAAAO,GAAAL,MACAC,iBAAAK,EAAAG,IACAP,iBAAAI,EAAAI,OAKA,OAAAZ,MAIApB,QAAAC,eAIAX,IAAA,kBACAxB,MAAA,SAAAmE,EAAAzC,GACA,IAAA0C,EAAA9C,KAEA,OAAAY,QAAAmC,IAAAF,EAAA9C,IAAA,SAAAiB,GACA,OAAA8B,EAAAE,WAAAhC,EAAAZ,UAKAN,EA/EA,GAkFerB,EAAA","file":"static/js/40.97a95037f24af84007e4.js","sourcesContent":["/*!\n * vue-webgis v0.7.3\n */\n\nimport 'vue';\nimport 'core-js/modules/es6.function.name';\nimport 'core-js/modules/es7.array.includes';\nimport 'core-js/modules/es6.string.includes';\nimport 'core-js/modules/es6.array.find';\nimport 'core-js/modules/web.dom.iterable';\nimport 'core-js/modules/es6.object.keys';\nimport './chunk-8430f437.js';\nimport 'core-js/modules/es6.string.iterator';\nimport 'core-js/library/fn/object/get-own-property-descriptor';\nimport { _ as _objectSpread } from './chunk-786165bb.js';\nimport 'core-js/library/fn/object/get-own-property-symbols';\nimport 'core-js/library/fn/object/keys';\nimport 'core-js/library/fn/object/define-property';\nimport { _ as _createClass, a as _classCallCheck, b as _defineProperty } from './chunk-82f2c815.js';\nimport { S as SERVER_CONFIG } from './chunk-bc626433.js';\nimport 'axios';\nimport 'qs/lib/stringify';\nimport { r as request, c as checkValidArray } from './chunk-81d749a9.js';\n\nfunction getIntersectGeometry(sr, geometries, geometry) {\n  return request({\n    url: SERVER_CONFIG.arcgisRestService + 'Utilities/Geometry/GeometryServer/intersect',\n    method: 'post',\n    data: {\n      f: 'json',\n      sr: sr,\n      geometry: geometry,\n      geometries: geometries\n    },\n    analysisToken: true\n  });\n}\n\nvar IntersectAnalysis =\n/*#__PURE__*/\nfunction () {\n  function IntersectAnalysis(map) {\n    _classCallCheck(this, IntersectAnalysis);\n\n    _defineProperty(this, \"_map\", void 0);\n\n    this._map = map;\n  }\n\n  _createClass(IntersectAnalysis, [{\n    key: \"doAnalysis\",\n    value: function doAnalysis(layerID, geometry) {\n      var _this = this;\n\n      var params = this._map.getLayerInfoParams(layerID);\n\n      if (params) {\n        return this._map.getLayerInfo(params).then(function (res) {\n          if (!checkValidArray(res.features)) {\n            return Promise.resolve([]);\n          }\n\n          var sourceFeaturesData = res;\n          var geometries = {\n            geometries: res.features.map(function (item) {\n              return item.geometry;\n            }),\n            geometryType: res.geometryType\n          };\n\n          var geometryObject = _this._map.formatGeometryObject(geometry);\n\n          return getIntersectGeometry(_this._map.mapConfig.wkid, JSON.stringify(geometries), JSON.stringify(geometryObject)).then(function (res) {\n            var resultData = sourceFeaturesData.features.map(function (item) {\n              return _objectSpread({}, item.attributes, {\n                meta: {\n                  intersectSizeStr: '',\n                  intersectSizeNum: 0\n                }\n              });\n            });\n\n            if (checkValidArray(res.geometries)) {\n              var features = _this._map.renderFeatureData({\n                features: res.geometries.map(function (item) {\n                  return {\n                    geometry: item\n                  };\n                })\n              });\n\n              features.forEach(function (item, index) {\n                var area = _this._map.formatGeometrySize(item.getGeometry());\n\n                resultData[index].meta = {\n                  intersectSizeStr: area.str,\n                  intersectSizeNum: area.num\n                };\n              });\n            }\n\n            return resultData;\n          });\n        });\n      } else {\n        return Promise.resolve([]);\n      }\n    }\n  }, {\n    key: \"doAnalysisMulti\",\n    value: function doAnalysisMulti(layerIDs, geometry) {\n      var _this2 = this;\n\n      return Promise.all(layerIDs.map(function (item) {\n        return _this2.doAnalysis(item, geometry);\n      }));\n    }\n  }]);\n\n  return IntersectAnalysis;\n}();\n\nexport default IntersectAnalysis;\n//# sourceMappingURL=intersect-analysis-760289f0.js.map\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/@greatmap/vue-webgis/lib/intersect-analysis-760289f0.js\n// module id = 32o1\n// module chunks = 40"],"sourceRoot":""}