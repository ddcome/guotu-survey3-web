<template>
  <div class="webgis-screen-setting webgis-box-shadow-base">
    <CommonHeader title="分屏展示">
      <el-button
        @click="splitScreenToggle()"
        class="webgis-screen-setting__close"
        type="text"
        icon="el-icon-close"
      ></el-button>
    </CommonHeader>
    <div class="webgis-screen-setting__body">
      <h3 class="webgis-screen-setting__title">设置屏数</h3>
      <div class="webgis-screen-setting__number">
        <span class="webgis-screen-setting__label">
          屏数选择
        </span>
        <el-select
          class="webgis-screen-setting__select"
          @change="$emit('changeScreenLen', number)"
          v-model="number"
          :value="number"
          size="mini"
          placeholder="请选择"
        >
          <el-option
            v-for="item in numberData"
            :key="item"
            :label="item"
            :value="item"
          >
          </el-option>
        </el-select>
      </div>
      <div class="webgis-screen-setting__view">
        <span class="webgis-screen-setting__label">
          分屏视图
        </span>
        <ul class="webgis-screen-setting__view-list webgis-list-unstyled">
          <li
            class="webgis-screen-setting__view-list-item"
            v-for="(item, index) in screenData"
            :key="index"
          >
            <el-button
              @click="$emit('changeScreenActive', index)"
              size="mini"
              :type="item.show ? 'primary' : ''"
            >
              {{ index + 1 }}
            </el-button>
          </li>
        </ul>
      </div>
      <h3 class="webgis-screen-setting__title">选择图层</h3>
      <ul class="webgis-screen-setting__layer webgis-list-unstyled">
        <li
          class="webgis-screen-setting__layer-item"
          v-for="(data, index) in screenData"
          :key="index"
        >
          <span class="webgis-screen-setting__layer-label">
            第{{ index + 1 }}屏
          </span>
          <el-select-tree
            class="webgis-screen-setting__layer-select"
            size="mini"
            placeholder="请选择"
            width="177px"
            :value="data.layer.id"
            :data="layerTree"
            :props="{ value: 'id', label: 'name', children: 'children' }"
            @change="$emit('changeScreenLayer', index, $event)"
          >
          </el-select-tree>
        </li>
      </ul>
      <div class="webgis-screen-setting__footer">
        <el-button size="mini" type="primary">分屏展示</el-button>
        <el-button @click="splitScreenToggle()" size="mini">取消</el-button>
      </div>
    </div>
  </div>
</template>

<script>
import ElSelectTree from 'el-select-tree';

import CommonHeader from '../components/common-header';
import splitScreenToggle from '../../../mixins/split-screen-toggle';

export default {
  name: 'WebGISSplitScreenSetting',
  mixins: [splitScreenToggle],
  components: { CommonHeader, ElSelectTree },
  props: {
    screenData: Array,
    layerTree: Array
  },
  data() {
    return {
      number: this.screenData.length,
      numberData: 6
    };
  }
};
</script>

<style lang="scss" scoped>
@import '../../../styles/common-variables';

.webgis-screen-setting {
  $label-width: 65px;
  $label-height: 28px;
  font-size: $font-size-small;
  &__body {
    border: $border-base;
    flex: 1;
    padding: $spacing-base;
  }
  &__title {
    margin-bottom: $spacing-base;
  }
  &__label {
    display: inline-block;
    width: $label-width;
  }
  &__number {
    margin-bottom: $spacing-medium;
    display: flex;
    align-items: center;
  }
  &__select {
    flex: 1;
  }
  &__view {
    margin-bottom: $spacing-base;
    display: flex;
  }
  $btn-size: 35px;
  &__view-list {
    display: flex;
    flex-wrap: wrap;
    width: 3 * ($btn-size + $spacing-base);
  }
  &__view-list-item {
    margin-bottom: $spacing-base;
    margin-right: $spacing-base;
    .el-button {
      width: $btn-size;
      height: $btn-size;
      padding: 0;
    }
  }
  &__layer {
    margin-bottom: $spacing-large;
  }
  &__layer-item {
    margin-bottom: 5px;
    display: flex;
    justify-content: space-between;
  }
  &__layer-label {
    background-color: $color-blue;
    color: white;
    display: flex;
    align-items: center;
    justify-content: center;
    width: $label-width;
    margin-right: 5px;
    border-radius: $border-radius-base;
  }
  &__footer {
    text-align: center;
    margin-bottom: $spacing-medium;
  }
}
</style>
