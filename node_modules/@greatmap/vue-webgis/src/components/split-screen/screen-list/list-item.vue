<template>
  <div
    class="webgis-screen-list-item webgis-box-shadow-base"
    v-loading="!webgisReady"
  >
    <ScreenHeader
      :title="data.layer.name || '未选择图层'"
      class="webgis-screen-list-item__header"
    />
    <Map
      :modules="webgisConfig.modules"
      :options="currentOptions"
      :show-controls="false"
      :controls="[]"
      @init="initWebgis"
    />
    <Modals class="webgis-screen-list-item__attribute-info" />
  </div>
</template>

<script>
import ScreenHeader from '../screen-header';
import { webgisProvide } from '../../../mixins/webgis-init';
import Map from '../../map';
import Modals from '../../modals';
import { privateEventHubProvide } from '../../../mixins/private-event-hub';
import { webgisPropsInject } from '../../../mixins/webgis-props';

export default {
  name: 'WebGISSplitScreenListItem',
  mixins: [webgisProvide, privateEventHubProvide, webgisPropsInject],
  components: {
    Map,
    ScreenHeader,
    Modals
  },
  props: {
    data: Object
  },
  computed: {
    currentOptions() {
      const layer = this.data.layer;
      return {
        ...this.webgisConfig.options,
        showLayers: layer.config && layer.config.name
      };
    }
  }
};
</script>

<style lang="scss" scoped>
@import '../../../styles/common-variables';

.webgis-screen-list-item {
  position: relative;
  overflow: hidden;
  $header-height: 42px;
  height: 100%;
  padding-top: $header-height;
  &__header {
    margin-top: -$header-height;
  }
  &__webgis {
    border: $border-base;
  }
  &__attribute-info {
    top: $header-height + $spacing-base;
  }
}
</style>
