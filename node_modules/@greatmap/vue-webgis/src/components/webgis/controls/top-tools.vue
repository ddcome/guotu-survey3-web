<template>
  <div
    class="webgis-top-tools webgis-box-shadow-default webgis-absolute-layer flex-center-justify"
  >
    <!-- 辖区 要素拾取 工具 分屏 基础量算 -->
    <el-popover placement="bottom-start" trigger="click">
      <RegionList />
      <el-button
        slot="reference"
        class="webgis-top-tools__item"
        icon="el-icon-s-grid"
      >
        辖区
      </el-button>
    </el-popover>

    <span class="webgis-top-tools__divider"></span>
    <el-button
      @click="featureSelectToggle()"
      class="webgis-top-tools__item"
      icon="el-icon-place"
      :class="{ active: featureSelectActive }"
    >
      要素拾取
    </el-button>
    <span class="webgis-top-tools__divider"></span>
    <el-dropdown @command="toolsHandle" trigger="click" size="small">
      <el-button class="webgis-top-tools__item" icon="el-icon-setting">
        工具
      </el-button>
      <el-dropdown-menu slot="dropdown">
        <el-dropdown-item command="measure" icon="el-icon-place">
          测量
        </el-dropdown-item>
        <el-dropdown-item command="screenshots" icon="el-icon-crop">
          截屏
        </el-dropdown-item>
        <el-dropdown-item
          command="rolling-screen"
          icon="el-icon-ice-cream-square"
        >
          卷帘
        </el-dropdown-item>
      </el-dropdown-menu>
    </el-dropdown>
    <span class="webgis-top-tools__divider"></span>
    <el-button
      @click="splitScreenToggle()"
      class="webgis-top-tools__item"
      icon="el-icon-menu"
    >
      分屏
    </el-button>
    <span class="webgis-top-tools__divider"></span>
    <el-button
      @click="
        clear();
        $webgis.clear();
      "
      class="webgis-top-tools__item"
      icon="el-icon-delete"
    >
      清理
    </el-button>
  </div>
</template>

<script>
import RegionList from './region-list';
import controlsClean from '../../../mixins/controls-clean';
import controlsFeatureSelect from '../../../mixins/controls-feature-select';
import splitScreenToggle from '../../../mixins/split-screen-toggle';
import { privateEventHubInject } from '../../../mixins/private-event-hub';
import { webgisInject } from '../../../mixins/webgis-init';

export default {
  name: 'WebGISTopTools',
  mixins: [
    webgisInject,
    controlsClean,
    controlsFeatureSelect,
    splitScreenToggle,
    privateEventHubInject
  ],
  components: {
    RegionList
  },
  methods: {
    toolsHandle(command) {
      switch (command) {
        case 'measure':
          this.$eventHub.$emit('changeModal', 'measure-select');
          break;
        case 'screenshots':
          this.$webgis.exportImage();
          break;
        case 'rolling-screen':
          this.$eventHub.$emit('changeModal', 'layer-swipe');
          break;
        default:
      }
    }
  }
};
</script>

<style lang="scss" scoped>
@import '../../../styles/common-variables';

.webgis-top-tools {
  display: flex;
  align-items: center;
  top: 10px;
  right: 10px;
  background: white;
  border-radius: 4px;
  height: 32px;
  &__item {
    font-size: $font-size-small;
    padding: 8px;
    border: none;
    background-color: transparent;
    color: inherit;
    &:hover,
    &:active,
    &.active {
      color: $color-primary;
    }
  }
  &__divider {
    height: 1em;
    border-left: 1px dashed #ddd;
  }
}
</style>
