{"version":3,"file":"chunk-bc626433.js","sources":["../src/utils/local-storage.js","../src/utils/auth.class.js","../src/gis/utils/gis-server-auth.js","../src/gis/config/server.js"],"sourcesContent":["/**\n * localStorage 操作\n * @description\n * 将 localStorage 获取/设置为 json 数据类型。\n */\n\n/**\n * 获取 localStorage 数据\n * @param {string} name localStorage 名称\n */\nexport function getLocalData(name) {\n  const data = localStorage.getItem(name);\n  if (data) {\n    return JSON.parse(data);\n  } else {\n    return data;\n  }\n}\n\n/**\n * 设置 localStorage 数据\n * @param {string} name localStorage 名称\n * @param {any} data 存储的内容\n */\nexport function setLocalData(name, data) {\n  localStorage.setItem(name, JSON.stringify(data));\n}\n","/**\n * token 管理类\n * @description\n * 获取有效的 token 值\n */\nimport { getLocalData, setLocalData } from './local-storage';\n\nexport class Auth {\n  name = '';\n  constructor(tokenName) {\n    this.name = tokenName;\n  }\n\n  /**\n   * 获取 token\n   * @returns {string/null} 如果有 token 并且未过期返回 token 值，否则返回 null\n   */\n  getToken() {\n    const data = getLocalData(this.name);\n    if (data && data.expires > Date.now()) {\n      return data.token;\n    } else {\n      return null;\n    }\n  }\n\n  /**\n   * 设置 token\n   * @param {object} token 设置 token 对象，例如：{token: 'token', expires: 'expires'}\n   */\n  setToken(token) {\n    setLocalData(this.name, token);\n  }\n}\n","/**\n * gis-server token 操作\n */\nimport { Auth } from '../../utils/auth.class';\n\n// 查询 token\nexport const gisServerAuth = new Auth('GIS_SERVER_TOKEN');\n\n// 分析 token\nexport const analysisAuth = new Auth('ANALYSIS_TOKEN');\n","/**\n * 服务地址配置\n */\n\n/**\n * @typedef {object} ServerAPI\n * @property {string} [host] 域名地址，默认取 location.host\n * @property {string} [arcgis] arcgis 接口地址，例如 http://wh.greatmap.com.cn:16442\n * @property {string} [arcgisQuery] arcgis 查询接口地址，例如 http://wh.greatmap.com.cn:16443\n * @property {string} [arcgisOrigin] arcgis 原始域名，例如 https://gis120.arcgisonline.cn\n * @property {string} [arcgisService] arcgis/service 接口\n * @property {string} [arcgisRestService] arcgis/rest/service 接口\n * @property {string} [superDataPath] arcgis 大数据目录\n * @property {string} [arcgisToken] arcgis 获取 token\n * @property {string} [arcgisServiceList] arcgis 获取服务列表\n * @property {string} [arcgisUsername] arcgis 用户名\n * @property {string} [arcgisPassword] arcgis 密码\n */\n\n/**@type ServerAPI 服务地址配置 */\nexport const SERVER_CONFIG = {\n  host: location.host,\n  arcgis: 'http://wh.greatmap.com.cn:16442',\n  arcgisQuery: 'http://wh.greatmap.com.cn:16443',\n  arcgisOrigin: 'https://gis120.arcgisonline.cn',\n  superDataPath: 'bigDataFileShares_XZSJ',\n  arcgisService: '',\n  arcgisRestService: '',\n  arcgisToken: '',\n  arcgisServiceList: '',\n  arcgisUsername: 'admin',\n  arcgisPassword: 'arcgis123'\n};\n\n/**\n * 更新服务地址\n * @param {ServerAPI} config\n */\nexport function updateServerAPI(config = {}) {\n  Object.assign(SERVER_CONFIG, config);\n  Object.assign(\n    SERVER_CONFIG,\n    {\n      arcgisService: SERVER_CONFIG.arcgisQuery + '/arcgis/services/',\n      arcgisRestService: SERVER_CONFIG.arcgisQuery + '/arcgis/rest/services/',\n      arcgisToken: SERVER_CONFIG.arcgis + '/portal/sharing/rest/generateToken',\n      arcgisServiceList: SERVER_CONFIG.arcgis + '/portal/sharing/rest/search'\n    },\n    config\n  );\n}\n\n// 初始化一次\nupdateServerAPI();\n"],"names":["getLocalData","name","data","localStorage","getItem","JSON","parse","setLocalData","setItem","stringify","Auth","tokenName","expires","Date","now","token","gisServerAuth","analysisAuth","SERVER_CONFIG","host","location","arcgis","arcgisQuery","arcgisOrigin","superDataPath","arcgisService","arcgisRestService","arcgisToken","arcgisServiceList","arcgisUsername","arcgisPassword","updateServerAPI","config","Object","assign"],"mappings":";;;;;;;AAUO,SAASA,YAAT,CAAsBC,IAAtB,EAA4B;MAC3BC,IAAI,GAAGC,YAAY,CAACC,OAAb,CAAqBH,IAArB,CAAb;;MACIC,IAAJ,EAAU;WACDG,IAAI,CAACC,KAAL,CAAWJ,IAAX,CAAP;GADF,MAEO;WACEA,IAAP;;;AASJ,AAAO,SAASK,YAAT,CAAsBN,IAAtB,EAA4BC,IAA5B,EAAkC;EACvCC,YAAY,CAACK,OAAb,CAAqBP,IAArB,EAA2BI,IAAI,CAACI,SAAL,CAAeP,IAAf,CAA3B;;;IClBWQ,IAAb;;AAAA;gBAEcC,SAAZ,EAAuB;;;kCADhB,EACgB;;SAChBV,IAAL,GAAYU,SAAZ;;;;;+BAOS;UACHT,IAAI,GAAGF,YAAY,CAAC,KAAKC,IAAN,CAAzB;;UACIC,IAAI,IAAIA,IAAI,CAACU,OAAL,GAAeC,IAAI,CAACC,GAAL,EAA3B,EAAuC;eAC9BZ,IAAI,CAACa,KAAZ;OADF,MAEO;eACE,IAAP;;;;;6BAQKA,KAvBX,EAuBkB;MACdR,YAAY,CAAC,KAAKN,IAAN,EAAYc,KAAZ,CAAZ;;;;;;;ICzBSC,aAAa,GAAG,IAAIN,IAAJ,CAAS,kBAAT,CAAtB;AAGP,IAAaO,YAAY,GAAG,IAAIP,IAAJ,CAAS,gBAAT,CAArB;;ICWMQ,aAAa,GAAG;EAC3BC,IAAI,EAAEC,QAAQ,CAACD,IADY;EAE3BE,MAAM,EAAE,iCAFmB;EAG3BC,WAAW,EAAE,iCAHc;EAI3BC,YAAY,EAAE,gCAJa;EAK3BC,aAAa,EAAE,wBALY;EAM3BC,aAAa,EAAE,EANY;EAO3BC,iBAAiB,EAAE,EAPQ;EAQ3BC,WAAW,EAAE,EARc;EAS3BC,iBAAiB,EAAE,EATQ;EAU3BC,cAAc,EAAE,OAVW;EAW3BC,cAAc,EAAE;CAXX;AAkBP,AAAO,SAASC,eAAT,GAAsC;MAAbC,MAAa,uEAAJ,EAAI;EAC3CC,MAAM,CAACC,MAAP,CAAchB,aAAd,EAA6Bc,MAA7B;EACAC,MAAM,CAACC,MAAP,CACEhB,aADF,EAEE;IACEO,aAAa,EAAEP,aAAa,CAACI,WAAd,GAA4B,mBAD7C;IAEEI,iBAAiB,EAAER,aAAa,CAACI,WAAd,GAA4B,wBAFjD;IAGEK,WAAW,EAAET,aAAa,CAACG,MAAd,GAAuB,oCAHtC;IAIEO,iBAAiB,EAAEV,aAAa,CAACG,MAAd,GAAuB;GAN9C,EAQEW,MARF;;AAaFD,eAAe;;;;"}