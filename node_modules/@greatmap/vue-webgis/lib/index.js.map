{"version":3,"file":"index.js","sources":["../src/gis/core/modules/index.js","../src/mixins/webgis-props.js","../src/gis/config/proj4.js","../node_modules/style-inject/dist/style-inject.es.js","../src/utils/update-config.js","../src/gis/config/index.js","../src/gis/core/layer-tree.js","../src/gis/api/service.js","../src/gis/config/alias.js","../src/gis/core/gis-config.js","../src/gis/config/animate.js","../src/gis/core/interactions/zoom.js","../src/gis/core/interactions/drag-pan.js","../src/gis/utils/export-map.js","../src/gis/core/controls/index.js","../src/gis/utils/format-object.js","../src/gis/utils/format-number.js","../src/gis/core/gis-utils.js","../src/gis/core/interactions/draw.js","../src/gis/core/interactions/drag-zoom.js","../src/utils/promise-queue.js","../src/gis/core/map.js","../src/components/map/index.vue","../node_modules/vue-runtime-helpers/dist/normalize-component.js","../src/components/webgis/aside/aside-opacity-set.vue","../src/mixins/webgis-init-common.js","../src/mixins/private-event-hub.js","../src/mixins/webgis-init.js","../src/components/webgis/aside/index.vue","../src/components/webgis/controls/aside-tools.vue","../src/components/webgis/controls/region-list.vue","../src/mixins/controls-clean.js","../src/mixins/controls-feature-select.js","../src/utils/event-hub.js","../src/mixins/split-screen-toggle.js","../src/components/webgis/controls/top-tools.vue","../src/components/webgis/controls/combined-search/list.vue","../src/components/webgis/controls/combined-search/keyboard.vue","../src/components/webgis/controls/combined-search/index.vue","../src/components/webgis/controls/top-search.vue","../src/components/webgis/controls/index.vue","../src/components/modals/components/modals-container.vue","../src/components/modals/attribute-info/index.vue","../src/components/modals/components/modals-radio-toggle.vue","../src/components/modals/measure-select/index.vue","../src/components/modals/layer-swipe/index.vue","../src/components/modals/index.vue","../src/components/webgis/rolling-screen/index.vue","../src/components/webgis/index.vue","../src/components/split-screen/screen-plan.js","../src/components/split-screen/components/common-header.vue","../src/components/split-screen/screen-header/index.vue","../src/components/split-screen/screen-list/list-item.vue","../src/components/split-screen/screen-list/index.vue","../src/components/split-screen/screen-setting/index.vue","../src/components/split-screen/index.vue","../src/components/index.vue","../packages/diff-analysis/main.vue","../packages/diff-analysis/index.js","../src/common.js"],"sourcesContent":["/**\n * 按需加载功能模块\n */\n\n/**\n * 模块集合类型定义\n * @typedef {Object} Modules\n * @property {BufferAnalysis} bufferAnalysis\n * @property {HistoryRecord} historyRecord\n * @property {FeatureSelect} featureSelect\n * @property {ImageLayer} imageLayer\n * @property {Measure} measure\n * @property {LayerSwipe} layerSwipe\n * @property {DiffAnalysis} diffAnalysis\n * @property {IntersectAnalysis} intersectAnalysis\n */\n\n// 存放所有模块（函数提供异步加载方式）\nexport const modules = {\n  BufferAnalysis: () => import('./buffer-analysis'),\n  HistoryRecord: () => import('./history-record'),\n  FeatureSelect: () => import('./feature-select'),\n  ImageLayer: () => import('./image-layer'),\n  Measure: () => import('./measure'),\n  LayerSwipe: () => import('./layer-swipe'),\n  DiffAnalysis: () => import('./diff-analysis'),\n  IntersectAnalysis: () => import('./intersect-analysis')\n};\n\n/**\n * 导入功能模块\n * @param {modules} name 功能模块名称\n * @return {Promise}\n */\nexport default function getModule(name) {\n  if (modules.hasOwnProperty(name)) {\n    return modules[name]().then((module) => module.default);\n  } else {\n    const msg = `${name} 模块不存在，是否已经注册？`;\n    return Promise.reject(msg);\n  }\n}\n","/**\n * 1. 主组件的 props 配置\n * 2. 组件的 props 以 webgisConfig 进行传递（webgisPropsProvide）\n * 3. 后代通过 `webgisPropsInject` 注入 `webgisConfig` 使用 props 参数\n */\nimport { modules } from '../gis/core/modules';\nimport { warnMessage } from '../utils/error-handler';\n\n// 通用 props\nconst props = {\n  // 模块配置\n  modules: {\n    type: Array,\n    default() {\n      return [];\n    },\n    validator(val) {\n      let isNotFound = false;\n      let module;\n      for (let i = 0; i < val.length; i++) {\n        module = val[i];\n        if (!modules.hasOwnProperty(module)) {\n          isNotFound = true;\n          break;\n        }\n      }\n      if (isNotFound) {\n        warnMessage(`module ${module} is not found.`);\n        return false;\n      } else {\n        return true;\n      }\n    }\n  },\n  // 是否展示控件\n  showControls: {\n    type: Boolean,\n    default: true\n  },\n  // 是否展示侧边栏\n  showAside: Boolean,\n  // 选项配置\n  options: {\n    type: Object,\n    default() {\n      return {};\n    }\n  },\n  // 控制模块\n  controls: {\n    type: Array || String,\n    default() {\n      return ['mousePosition', 'scaleLine'];\n    }\n  },\n  // 分屏状态\n  splitScreen: Boolean\n};\n\nexport const webgisProps = {\n  props\n};\n\n// 注册用混入对象\nexport const webgisPropsProvide = {\n  props,\n  provide() {\n    return {\n      $_webgisPropsProvide: this\n    };\n  },\n  computed: {\n    webgisConfig() {\n      return {\n        modules: this.modules,\n        showControls: this.showControls,\n        showAside: this.showAside,\n        options: this.options,\n        controls: this.controls\n      };\n    }\n  }\n};\n\n// 注入用混入对象\nexport const webgisPropsInject = {\n  inject: ['$_webgisPropsProvide'],\n  data() {\n    return {\n      webgisConfig: {}\n    };\n  },\n  created() {\n    this.webgisConfig = this.$_webgisPropsProvide.webgisConfig;\n    this.$_webgisPropsProvide.$watch('webgisConfig', (newVal) => {\n      this.webgisConfig = newVal;\n    });\n  }\n};\n","/**\n * 定义参考系\n * @description\n * [proj4 使用方式](http://proj4js.org/)\n * [proj4 与 openlayers 结合使用](https://openlayers.org/en/latest/examples/wms-image-custom-proj.html)\n */\nimport { register } from 'ol/proj/proj4';\nimport proj4 from 'proj4';\n\n// 定义 epsg 集合\nconst defaultEpsg = {\n  'EPSG:4490': '+proj=longlat +ellps=GRS80 +no_defs',\n  'EPSG:4610': '+proj=longlat +a=6378140 +b=6356755.288157528 +no_defs'\n};\n\n// 注册参考系\nexport function registerEPSG(epsgConfig) {\n  // 合并\n  const epsg = { ...defaultEpsg, ...epsgConfig };\n\n  // 定义 proj4\n  proj4.defs(Object.entries(epsg));\n\n  // openlayers 注册\n  register(proj4);\n}\n","function styleInject(css, ref) {\n  if ( ref === void 0 ) ref = {};\n  var insertAt = ref.insertAt;\n\n  if (!css || typeof document === 'undefined') { return; }\n\n  var head = document.head || document.getElementsByTagName('head')[0];\n  var style = document.createElement('style');\n  style.type = 'text/css';\n\n  if (insertAt === 'top') {\n    if (head.firstChild) {\n      head.insertBefore(style, head.firstChild);\n    } else {\n      head.appendChild(style);\n    }\n  } else {\n    head.appendChild(style);\n  }\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nexport default styleInject;\n","/**\n * 合并配置（深合并）\n * @param {Object} source 源配置\n * @param {Object} config 传入配置\n */\nexport function mergeConfig(source, config) {\n  if (config instanceof Object) {\n    let item, sourceItem;\n    for (let key in config) {\n      if (config.hasOwnProperty(key)) {\n        item = config[key];\n        sourceItem = source[key];\n        if (item || item === 0) {\n          if (item instanceof Object) {\n            if (!sourceItem) {\n              source[key] = item;\n            } else {\n              mergeConfig(sourceItem, item);\n            }\n          } else {\n            source[key] = item;\n          }\n        }\n      }\n    }\n  }\n}\n","import { mergeConfig } from '../../utils/update-config';\n\n// 默认的行政区代码（例如：620100，用于地图初始化展示），图层树中排序在最后\nexport const defaultVisibleService = {\n  land: '',\n  region: '', // 数组类型第一位在上面，最后一位在下面\n  special: '',\n  year: '',\n  scale: '',\n  layer: ''\n};\n\n// 默认图层配置\nexport const defaultLayerConfig = {\n  // wmts/wms 图层类型的临界值\n  // 1-3 展示 wmts，3- 展示 wms\n  zoomThreshold: 0\n};\n\n// 设置默认的图层配置\nexport function setDefaultLayerConfig(config) {\n  mergeConfig(defaultLayerConfig, config);\n}\n\n// 设置默认展示的服务\nexport function setDefaultVisibleService(config) {\n  mergeConfig(defaultVisibleService, config);\n}\n","import treeToFlatArray from 'operation-tree-node/dist/treeToFlatArray.esm';\nimport treeEach from 'operation-tree-node/dist/treeEach.esm';\nimport treeMerge from 'operation-tree-node/dist/treeMerge.esm';\nimport treeCheck from 'operation-tree-node/dist/treeCheck.esm';\n\nimport paramToArray from '../utils/param-to-array';\nimport LayerManagement from './layer-management';\nimport { defaultLayerConfig } from '../config';\n\n/**\n * Layer-Tree\n * @mixin LayerTree\n * @description\n * 图层树类\n */\nexport default class LayerTree {\n  showLayers = [];\n  treeNodes = [];\n  treeLayers = [];\n  treeLayersIds = [];\n  _treeNodesFlat = [];\n  _projection;\n  _layerType;\n\n  /**@type LayerManagement*/\n  _layerManagement;\n\n  /**\n   * @param {Object} olMap\n   */\n  constructor(olMap) {\n    this._projection = olMap.getView().getProjection();\n    this._layerManagement = new LayerManagement(olMap);\n    olMap.on('moveend', () => this._updateOlLayer());\n  }\n\n  /**\n   * 节点的勾选切换\n   * @param {Array<Number|Symbol>|Number|Symbol} nodeId 节点 ID\n   * @param {Boolean} checked 节点勾选状态\n   */\n  checkChange(nodeId, checked) {\n    const showLayers = this.showLayers;\n    let needUpdate = false;\n    let index;\n\n    // 获取影响的所有节点 ID\n    nodeId = paramToArray(nodeId);\n    nodeId = treeCheck(this.treeNodes, nodeId).filter((item) =>\n      this.treeLayersIds.includes(item)\n    );\n\n    nodeId.forEach((id) => {\n      index = showLayers.indexOf(id);\n      // 只有状态更改了才取更新树结构\n      if (index !== -1) {\n        if (!checked) {\n          showLayers.splice(index, 1);\n          needUpdate = true;\n        }\n      } else if (checked) {\n        showLayers.push(id);\n        needUpdate = true;\n      }\n    });\n\n    if (needUpdate) {\n      this.layerChange();\n      this.eventHub.dispatch('checkChange', nodeId, checked);\n    }\n  }\n\n  /**\n   * 修改当前展示的图层，例如仅展示图层：X510183TDXZG2017XGQ\n   * @param {Array|String} [showLayers] 需要展示的图层名称集合，默认全部展示\n   */\n  layerChange(showLayers) {\n    if (showLayers) {\n      this.showLayers = paramToArray(showLayers);\n    }\n    this._updateNodeChecked();\n    this._updateLayersVisible();\n    this.eventHub.dispatch('layerChange', this.showLayers);\n  }\n\n  /**\n   * 为图层配置创建树结构\n   * @param {Array} groupLayers mapConfig.groupLayers\n   * @param {Array} showLayers 展示的图层名数组\n   */\n  createLayerTree(groupLayers = [], showLayers = []) {\n    const treeNodes = [];\n\n    // 为每一个组创建一棵树\n    groupLayers.forEach((item) => treeNodes.push(this._createNode(item)));\n\n    // 递归合并树的公共节点（根据 letter 参数）\n    this.treeNodes = treeMerge(\n      treeNodes,\n      (curr, next) => curr.letter && curr.letter === next.letter\n    );\n\n    // 创建树节点对父级的引用\n    treeEach(\n      this.treeNodes,\n      (node, index, arr, parent) => (node.parent = parent)\n    );\n\n    // 获取树结构的相关数据\n    this._updateTreeData();\n\n    // 初始化 zIndex（zIndex 取反）\n    const nodeMaxIndex = this._treeNodesFlat.length - 1;\n    this._treeNodesFlat.forEach(\n      (item, index) => (item.zIndex = nodeMaxIndex - index)\n    );\n\n    // 更新 ol 图层\n    this._updateOlLayer(true);\n\n    // 初始化图层\n    // 如果没有则默认选择最后一个\n    showLayers = paramToArray(showLayers);\n    if (!showLayers.length) {\n      const lastNode = this.treeLayers.slice(-1)[0];\n      showLayers.push(lastNode.id);\n    }\n    this.layerChange(showLayers);\n  }\n\n  /**\n   * 设置图层的透明度\n   * @param {String} layerId 图层 id，例如：X510183TDXZG2017XGQ\n   * @param {Number} opacity 0 ～ 1\n   */\n  setLayerOpacity(layerId, opacity) {\n    const layers = this.getOlLayer(layerId);\n    layers.forEach((item) => item.setOpacity(opacity));\n  }\n\n  /**\n   * 设置图层的排序\n   * @param {String} layerId 图层 id，例如：X510183TDXZG2017XGQ\n   * @param {String} type 排序方向 down 向下移动，up 向上移动\n   */\n  setLayerSort(layerId, type) {\n    const direction = type === 'down' ? 1 : -1; // 数组向上移动 index 越小，所以 -1\n    const node = this._treeNodesFlat.find((item) => item.id === layerId);\n    const parentChildren = node.parent.children;\n    const currIndex = parentChildren.indexOf(node);\n    const nextIndex = currIndex + direction;\n    const next = parentChildren[nextIndex];\n\n    if (next) {\n      const curr = parentChildren[currIndex];\n\n      // replace sort and zIndex\n      [curr.zIndex, next.zIndex] = [next.zIndex, curr.zIndex];\n      parentChildren.splice(\n        currIndex,\n        0,\n        parentChildren.splice(nextIndex, 1)[0]\n      );\n\n      // update layer zIndex\n      this._updateLayersZIndex([curr, next]);\n\n      this._updateTreeData();\n    }\n  }\n\n  /**\n   * 获取对应 id 的图层\n   * @param {String|Array} layerId 图层 id，例如：X510183TDXZG2017XGQ\n   * @return {Array} 返回 ol.Layer 实例\n   */\n  getOlLayer(layerId) {\n    layerId = paramToArray(layerId);\n    return this.treeLayers\n      .filter((item) => layerId.includes(item.id))\n      .map((item) => item.olLayer);\n  }\n\n  /**\n   * 获取最上层展示的图层数据\n   * @return {Object|null}\n   */\n  getTopVisibleLayer() {\n    return this.treeLayers.find((item) => item.checked);\n  }\n\n  /**\n   * 创建节点\n   * @private\n   */\n  _createNode(configGroup) {\n    /**@type {{land,landLetter,special,specialLetter,region,regionLetter,year,yearLetter}} */\n    const alias = configGroup.alias;\n    const layers = configGroup.layers;\n\n    // 将 wmts 的 id 放在图层的父级节点上\n    const parentId = configGroup.id;\n\n    // 五级：图层\n    const nodeLayer = layers.map((layer) => {\n      return {\n        id: layer.id,\n        letter: layer.letter,\n        name: layer.caption,\n        config: layer,\n        configGroup,\n        nodeType: 'layer'\n      };\n    });\n\n    return {\n      // 一级：地类\n      id: Symbol(),\n      letter: alias.landLetter,\n      name: alias.land,\n      config: configGroup,\n      nodeType: 'DL',\n      children: [\n        {\n          // 二级：专题\n          id: Symbol(),\n          letter: alias.specialLetter,\n          name: alias.special,\n          config: configGroup,\n          nodeType: 'ZT',\n          children: [\n            {\n              // 三级：行政区\n              id: Symbol(),\n              letter: alias.regionLetter,\n              name: alias.region,\n              config: configGroup,\n              nodeType: 'XZQ',\n              children: [\n                {\n                  // 四级：年度\n                  id: parentId,\n                  letter: alias.yearLetter,\n                  name: alias.year,\n                  config: configGroup,\n                  nodeType: 'ND',\n                  children: nodeLayer\n                }\n              ]\n            }\n          ]\n        }\n      ]\n    };\n  }\n\n  /**\n   * 更新 ol 图层\n   * @param {Boolean} [reload] 是否重新加载\n   * @private\n   */\n  _updateOlLayer(reload = false) {\n    // 判断是否需要更新图层\n    const zoomThreshold = defaultLayerConfig.zoomThreshold;\n    const layerType =\n      !zoomThreshold || this.olView.getZoom() >= zoomThreshold ? 'wms' : 'wmts';\n    if (!reload && layerType === this._layerType) {\n      return;\n    }\n    this._layerType = layerType;\n\n    const layerManagement = this._layerManagement;\n    let layerConfig, layerConfigGroup, olLayer;\n    this.treeLayers.forEach((item) => {\n      layerConfig = item.config;\n      layerConfigGroup = item.configGroup;\n      olLayer = item.olLayer;\n\n      // 移除旧的\n      if (olLayer) {\n        layerManagement.removeLayer(olLayer);\n      }\n\n      // 添加新的\n      item.olLayer = layerManagement.addLayer(\n        // 如果是 ImageServer，则会使用图片图层（image）\n        layerConfig.type === 'MapServer' ? layerType : 'image',\n        {\n          serverId: layerConfig.serverId,\n          serverType: layerConfig.type,\n          serverIdWMS: layerConfig.serverIdWMS,\n          serviceCode: layerConfig.serviceCode,\n          extent: layerConfigGroup.extent,\n          zIndex: item.zIndex,\n          resolutions: layerConfigGroup.resolutions,\n          tileInfo: layerConfigGroup.tileInfo,\n          projection: layerConfigGroup.epsg,\n          visible: item.checked\n        }\n      );\n    });\n  }\n\n  /**\n   * 获取树结构的相关数据\n   * @private\n   */\n  _updateTreeData() {\n    // 获取树节点的扁平数据\n    this._treeNodesFlat = treeToFlatArray(this.treeNodes);\n    this.treeLayers = this._treeNodesFlat.filter(\n      (item) => item.nodeType === 'layer'\n    );\n    this.treeLayersIds = this.treeLayers.map((item) => item.id);\n  }\n\n  /**\n   * 更新图层的展示状态\n   * @private\n   */\n  _updateLayersVisible() {\n    this.treeLayers.forEach((item) => {\n      item.olLayer.setVisible(item.checked);\n    });\n  }\n\n  /**\n   * 更新节点勾选状态\n   * @private\n   */\n  _updateNodeChecked() {\n    const checkedIds = treeCheck(this.treeNodes, this.showLayers);\n    this.treeLayers.forEach((node) => {\n      node.checked = checkedIds.includes(node.id);\n    });\n  }\n\n  /**\n   * 更新图层的层级\n   * @param {Object|Array} node 图层节点\n   * @private\n   */\n  _updateLayersZIndex(node) {\n    node.forEach((item) => {\n      item.olLayer.setZIndex(item.zIndex);\n    });\n  }\n}\n","import request from '../utils/request';\nimport { SERVER_CONFIG } from '../config/server';\n\n/**\n * 获取服务列表\n * @returns {Promise}\n */\nexport function getServiceList(type = 'Map Service') {\n  return request({\n    url: SERVER_CONFIG.arcgisServiceList,\n    method: 'post',\n    data: {\n      q: `owner:${\n        SERVER_CONFIG.arcgisUsername\n      } orgid:0123456789ABCDEF (type:(\"${type}\")\n      -typekeywords:(\"Tiled\" OR \"Hosted\") -type:(\"Web Map\" OR \"Web Mapping Application\" OR \"Shapefile\"))\n      ownerfolder:root -type:(\"Code Attachment\" OR \"Featured Items\")\n      -typekeywords:(\"MapAreaPackage\") -type:(\"Map Area\")`,\n      f: 'json',\n      num: 999\n    },\n    analysisToken: true\n  });\n}\n\n/**\n * 获取服务配置\n * @returns {Promise}\n */\nexport function getServiceConfig(code, type = 'MapServer', id = '') {\n  return request({\n    baseURL: SERVER_CONFIG.arcgisQuery,\n    url: `/arcgis/rest/services/${code}/${type}/${id}`,\n    method: 'post',\n    data: {\n      f: 'json'\n    }\n  });\n}\n\n/**\n * 获取服务详情（features，attributes）\n *\n * @param {string} serviceCode 服务地址，例如：X510183TDXZG2017XZQ\n * @param {string} layerId 图层的 id，例如：0\n * @param {string} epsgNum 参考系，例如：4499\n * @param {string} geometry 几何范围，JSON 字符串\n * @param {string} geometryType geometry 类型，例如：esriGeometryPolygon|esriGeometryEnvelope\n * @param {string} [where] 查询语句，例如：BSM='123'\n * @param {boolean} [returnGeometry=true] 是否返回 geometry 数据\n * @param {string} [outFields=*] 输出 fields，例如：'BSM,DLTB'\n * @param {String} [groupByFieldsForStatistics] 字段组合分析\n * @param {String} [outStatistics] 返回分析的字段\n * @return {Promise}\n */\nexport function getServiceDetail({\n  serviceCode,\n  layerId,\n  epsgNum,\n  geometry,\n  geometryType,\n  where = '1=1',\n  outFields = '*',\n  returnGeometry = true,\n  groupByFieldsForStatistics = '',\n  outStatistics\n}) {\n  return request({\n    baseURL: SERVER_CONFIG.arcgisQuery,\n    url: `/arcgis/rest/services/${serviceCode}/MapServer/${layerId}/query`,\n    method: 'post',\n    data: {\n      f: 'json',\n      returnGeometry,\n      spatialRel: 'esriSpatialRelIntersects',\n      geometry,\n      geometryType,\n      outFields,\n      inSR: epsgNum,\n      outSR: epsgNum,\n      groupByFieldsForStatistics,\n      outStatistics,\n      where\n    }\n  });\n}\n","import { mergeConfig } from '../../utils/update-config';\n\nexport const aliasMap = {\n  land: {\n    X: '现状',\n    B: '基础地理',\n    G: '规划',\n    M: '管理',\n    S: '社会经济'\n  },\n  region: {\n    '621122': '陇西县',\n    '510183': '邛崃市',\n    '620102': '城关区',\n    '620103': '七里河',\n    '620100': '兰州市',\n    '620104': '西固区',\n    '620922': '瓜州县',\n    '620923': '肃北区',\n    '620000': '甘肃省'\n  },\n  scale: {\n    G: '1:10000'\n  },\n  special: {\n    TDLYXZ: '土地利用现状',\n    TDGY: '土地供应',\n    JCDL: '基础地理',\n    JSYDXM: '建设用地项目'\n  },\n  year: {\n    // 读取 serviceCode 中年份\n    // 2017: '2017'\n  },\n  layer: {\n    PZWJSTD: '批准未建设土地',\n    TDXZ: '土地利用现状',\n    XZQ: '行政区',\n    XJXZQ: '县级行政区',\n    CJDCQ: '村级调查区',\n    DLTB: '地类图斑',\n    YJJBNTTB: '永久基本农田图斑',\n    CZCDYD: '城镇村等用地',\n    TDGY: '土地供应',\n    YDBP: '用地报批'\n  }\n};\n\n// 更新 aliasMap 配置\nexport function setAliasMap(config) {\n  mergeConfig(aliasMap, config);\n}\n","import { getServiceConfig, getServiceList } from '../api/service';\nimport { errorMessage, warnMessage } from '../../utils/error-handler';\nimport { aliasMap } from '../config/alias';\nimport { defaultVisibleService } from '../config';\nimport paramToArray from '../utils/param-to-array';\nimport { extend as olExtent } from 'ol/extent';\nimport { checkValidArray } from '../../utils/check-array';\n\n/**\n * 服务 ID 校验规则与转译规则\n * [地类] - [行政区] - [专题] - [年度] - [比例尺] - [图层]\n *\n * @example\n * 'X621122TDXZ2019GXZQ' => {\n *   land: 'X',\n *   region: '621122',\n *   special: 'TDXZ',\n *   year: '2019',\n *   scale: 'G',\n *   layer: 'XZQ'\n * }\n */\nconst parseCheckReg = /^[A-Z]\\d{6}[A-Z]{2,}\\d{4}[A-Z_](YX|$)/;\nconst parseRules = {\n  // 一级：地类\n  land: (code) => code.slice(0, 1),\n  // 二级：专题\n  special: (code) =>\n    code.replace(/^[A-Z]\\d{6}/, '').replace(/\\d{4}[A-Z_]+$/, ''),\n  // 三级：行政区\n  region: (code) => code.slice(1, 7),\n  // 四级：年份\n  year: (code) => code.replace(/^[A-Z]\\d{6}[A-Z]+/, '').replace(/[A-Z_]+$/, ''),\n  // （暂不展示）比例尺\n  // scale: (code) => code.slice(-1),\n  // 五层：图层\n  layer: (code) => code.replace(/.*\\d/g, '').slice(1)\n};\n\n/**\n * GIS-Config\n * @description\n * 地图配置类\n * @returns {Promise<Array>}\n */\nexport default class GISConfig {\n  constructor() {}\n\n  /**\n   * 创建地图配置\n   * @param {String|Array?} serviceCode\n   * @returns {Promise}\n   */\n  static create(serviceCode = 'default') {\n    // 兼容无效数据\n    if (!serviceCode || !serviceCode.length) {\n      serviceCode = 'default';\n    }\n\n    const gisConfig = new GISConfig();\n\n    // 判断是否默认配置\n    let promise;\n    if (serviceCode === 'default') {\n      promise = gisConfig.getMapConfig();\n    } else {\n      const services = paramToArray(serviceCode);\n      promise = gisConfig.getMultiService(services);\n    }\n\n    return promise.then((res) => {\n      if (res.length) {\n        // 进行排序\n        GISConfig.sortServiceList(res);\n\n        // 合并配置，取最后一个作为默认配置\n        const defaultItem = res[res.length - 1];\n        return {\n          zoom: defaultItem.zoom,\n          wkid: defaultItem.wkid,\n          epsg: defaultItem.epsg,\n          extent: defaultItem.extent,\n          center: defaultItem.center,\n          resolutions: defaultItem.resolutions,\n          groupLayers: res\n        };\n      } else {\n        return Promise.reject('未获取到有效的服务地址');\n      }\n    });\n  }\n\n  /**\n   * 进行默认配置的排序\n   * **根据相似度得分 score 参数来进行排序**\n   * @param {Array<{\n   *  alias: {\n   *    landLetter,regionLetter,specialLetter,\n   *    yearLetter,layerLetter,scaleLetter\n   *  }\n   * }>} serviceList 初始化后的配置\n   */\n  static sortServiceList(serviceList) {\n    const defaultLetterConfig = {};\n    let compareKeys = Object.keys(defaultVisibleService);\n\n    // 创建相同的数据结果（项为数组类型）\n    compareKeys.forEach((key) => {\n      defaultLetterConfig[key + 'Letter'] = paramToArray(\n        defaultVisibleService[key]\n      );\n    });\n    compareKeys = compareKeys.map((item) => item + 'Letter');\n\n    // 进行评分，数组最后一个最高分（高分在底部）\n    let letterItem, defaultLetterItem, findIndex;\n    const compareConfig = (item) => {\n      const itemAlias = item.alias;\n      let score = 0;\n      compareKeys.forEach((key) => {\n        letterItem = itemAlias[key];\n        defaultLetterItem = defaultLetterConfig[key];\n        findIndex = defaultLetterItem.indexOf(letterItem);\n        score += findIndex === -1 ? 0 : findIndex + 1;\n      });\n      return score;\n    };\n    serviceList.sort((a, b) => {\n      return compareConfig(a) - compareConfig(b);\n    });\n  }\n\n  /**\n   * 获取服务列表\n   * @returns {Promise<Array>}\n   */\n  getMapConfig() {\n    return Promise.all([\n      getServiceList('Image Service'),\n      getServiceList()\n    ]).then((res) => {\n      const results = res.reduce(\n        (curr, next) => [...curr, ...next.results],\n        []\n      );\n      if (checkValidArray(results)) {\n        const services = results\n          .filter((item) => parseCheckReg.test(item.title))\n          .map((item) => ({\n            id: item.title,\n            type: item.type === 'Map Service' ? 'MapServer' : 'ImageServer'\n          }));\n        if (services.length) {\n          return this.getMultiService(services);\n        } else {\n          errorMessage('获取地图配置数据全部无效');\n          return Promise.reject(res);\n        }\n      } else {\n        errorMessage(`获取地图配置为空`);\n        return Promise.reject(res);\n      }\n    });\n  }\n\n  /**\n   * 获取多个服务配置\n   * @param {Array<Object>} services\n   * @returns {Promise<Array>}\n   */\n  getMultiService(services) {\n    return Promise.all(\n      services.map((item) => {\n        if (typeof item === 'string') {\n          item = { id: item, type: 'MapServer' };\n        }\n        const { id, type } = item;\n\n        return getServiceConfig(id, type).then((restRes) => {\n          const result = [];\n          if (restRes) {\n            // 兼容 ImageServer 图层\n            if (!restRes.layers && type === 'ImageServer') {\n              restRes.layers = [{ id: '', name: id }];\n            }\n            if (restRes.layers instanceof Array) {\n              restRes.layers.forEach((layer, index, arr) => {\n                layer.layerLength = arr.length; // 存储所在 layers 的数量，用于计算 serverIdWMS\n                result.push(\n                  this._formatConfig(id, layer.name, {\n                    ...restRes,\n                    type,\n                    layers: [layer]\n                  })\n                );\n              });\n            }\n          }\n          return result;\n        });\n      })\n    ).then((res) => {\n      return res\n        .filter((item) => item instanceof Array)\n        .reduce((current, next) => [...current, ...next], [])\n        .filter((item) => {\n          if (item && checkValidArray(item.resolutions)) {\n            return true;\n          } else {\n            warnMessage(`${item.serviceCode} resolutions 为空`);\n          }\n        });\n    });\n  }\n\n  /**\n   * 获取对应的别名（layer 为数组，所以不在其中）\n   * @param {String} serviceCode 服务 ID\n   * @private\n   */\n  _parseAlias(serviceCode) {\n    const words = Object.keys(parseRules);\n    const result = {};\n    words.forEach((item) => {\n      const parseResult = parseRules[item](serviceCode);\n      result[item + 'Letter'] = parseResult;\n      result[item] = aliasMap[item][parseResult] || parseResult;\n    });\n    return result;\n  }\n\n  /**\n   * 格式化 serverConfig\n   * @param {String} serviceCode 服务 ID 例如：E652324LQSJ2019G\n   * @param {String} serviceCodeLayer 服务 ID (带图层代码）例如：E652324LQSJ2019GZDJBXX\n   * @param {{\n   *  initialExtent: number[], tileInfo: {lods: []|undefined}|undefined,\n   *  fullExtent: number[], layers: Object[], type: string\n   * }} response restService 服务返回的结果\n   * @returns {{\n   *  extent: *[], epsg: string, center: number[], wkid: Number,\n   *  zoom: number, resolutions: Array, groupLayer: *\n   * }}\n   * @private\n   */\n  _formatConfig(serviceCode, serviceCodeLayer, response) {\n    const alias = this._parseAlias(serviceCodeLayer);\n    const layers = this._formatLayers(\n      serviceCode,\n      response.layers,\n      response.type\n    );\n    const fullExtent = olExtent(response.fullExtent, response.initialExtent);\n    const extent = [\n      fullExtent.xmin,\n      fullExtent.ymin,\n      fullExtent.xmax,\n      fullExtent.ymax\n    ];\n    const center = [(extent[0] + extent[2]) / 2, (extent[1] + extent[3]) / 2];\n    const wkid = fullExtent.spatialReference.wkid;\n    const tileInfo = response.tileInfo;\n    const resolutions = [];\n\n    tileInfo &&\n      tileInfo.lods &&\n      tileInfo.lods.forEach((lod) => {\n        resolutions.push(lod.resolution);\n      });\n\n    return {\n      id: Symbol(),\n      extent,\n      zoom: 0,\n      epsg: 'EPSG:' + wkid,\n      wkid,\n      center,\n      resolutions,\n      serviceCode,\n      tileInfo,\n      alias,\n      viewZoom: {\n        wfs: [-1, -1],\n        wms: [0, tileInfo && tileInfo.lods.length],\n        wmts: [-1, -1]\n      },\n      layers\n    };\n  }\n\n  /**\n   * 格式化 layers\n   * @param {String} serviceCode 服务 ID\n   * @param {Array} layers rest/services 返回的 layers\n   * @param {String} type 服务类型（MapServer/ImageServer)\n   * @private\n   */\n  _formatLayers(serviceCode, layers, type) {\n    return layers.map((layer) => {\n      const layerNameKey = parseRules.layer(layer.name);\n      return {\n        caption: aliasMap.layer[layerNameKey] || layerNameKey,\n        serviceCode,\n        type,\n        id: layer.name, // id 在多个树节点中不唯一，使用 name 作为 id 使用\n        serverId: layer.id, // serverId 作为请求服务的 id 使用\n        serverIdWMS: layer.layerLength - 1 - layer.id, // 作为 WMS 服务请求的 id（WMS 的 id 是颠倒的）\n        name: layer.name,\n        letter: parseRules.layer(layer.name),\n        label: 'BSM',\n        permission: '1=1'\n      };\n    });\n  }\n}\n","/**\n * 地图动画设置\n */\n// 动画时长\nexport const animateDuration = 500;\n","import { animateDuration } from '../../config/animate';\nimport { extend as olExtent } from 'ol/extent';\n\nexport default class Zoom {\n  _defaultZoom;\n  _defaultCenter;\n  _mapView;\n  _map;\n\n  /**\n   * @param map\n   */\n  constructor(map) {\n    this._defaultZoom = map.mapConfig.zoom;\n    this._defaultCenter = map.mapConfig.center;\n    this._mapView = map.olView;\n    this._map = map;\n  }\n\n  /**\n   * 视图缩放\n   * @param {String|Number} type 视图缩放类型\n   * - String: zoom-in/zoom-out/revert\n   * - Number: 直接更改 zoom 值\n   * @api\n   */\n  change(type) {\n    let center;\n    let zoom = this._mapView.getZoom();\n    if (typeof type === 'string') {\n      switch (type) {\n        case 'zoom-in':\n          zoom++;\n          break;\n        case 'zoom-out':\n          zoom--;\n          break;\n        case 'revert':\n          zoom = this._defaultZoom;\n          center = this._defaultCenter;\n          break;\n        default:\n      }\n    } else {\n      zoom = type;\n    }\n    this.animate({ zoom, center });\n  }\n\n  /**\n   * 同步多个地图\n   * @param {Array<Map>|Map} maps Map 实例\n   */\n  syncMapsMove(maps) {\n    const [center, zoom] = [this._mapView.getCenter(), this._mapView.getZoom()];\n    maps.forEach((map) => {\n      map.interactions.zoom.animate({ center, zoom });\n    });\n  }\n\n  /**\n   * 重置视图为当前展示的图层范围内\n   */\n  resetView(padding) {\n    const treeLayers = this._map.treeLayers;\n    const extents = treeLayers\n      .filter((item) => item.checked)\n      .map((item) => item.configGroup.extent);\n    this.focusExtents(extents, padding);\n  }\n\n  /**\n   * 动画缩放\n   * @param {Array<Number>} center\n   * @param {Number} zoom\n   */\n  animate({\n    center = this._mapView.getCenter(),\n    zoom = this._mapView.getZoom()\n  }) {\n    this._mapView.animate({ center, zoom, duration: animateDuration });\n  }\n\n  /**\n   * 缩放至要素\n   * @param {*[]} features 要素集合\n   * @param {Array<Number>} [padding]\n   */\n  toFeatures(features = [], padding) {\n    const extents = features.map((item) => item.getGeometry().getExtent());\n    this.focusExtents(extents, padding);\n  }\n\n  /**\n   * 聚焦范围内\n   * @param {Array} extents 范围集合\n   * @param {Array<Number>} padding\n   */\n  focusExtents(extents, padding = [0, 0, 0, 0]) {\n    const extent = extents.reduce((prev, curr) => {\n      return prev ? olExtent(prev, curr) : curr;\n    }, null);\n    this._mapView.fit(extent, {\n      constrainResolution: true,\n      nearest: true,\n      duration: animateDuration,\n      maxZoom: 2,\n      padding\n    });\n  }\n}\n","import OlDragPan from 'ol/interaction/DragPan';\nimport ToggleActive from '../common/toggle-active';\n\nexport default class DragPan extends ToggleActive {\n  _olMap;\n  _dragPan = new OlDragPan();\n\n  /**\n   * @param {Object<Map>} olMap\n   */\n  constructor({ olMap }) {\n    super();\n\n    this._olMap = olMap;\n    this.toggleActive();\n  }\n\n  // 激活 extends ToggleActive\n  activateHandle() {\n    this._olMap.addInteraction(this._dragPan);\n  }\n\n  // 关闭 extends ToggleActive\n  deactivateHandle() {\n    this._olMap.removeInteraction(this._dragPan);\n  }\n}\n","import { saveAs } from 'file-saver';\nimport { errorMessage } from '../../utils/error-handler';\n\n/**\n * 将 canvas 导出为图片\n * @param canvas\n */\nexport default function saveCanvas(canvas) {\n  const filename = 'map.png';\n  try {\n    if (navigator.msSaveBlob) {\n      navigator.msSaveBlob(canvas.msToBlob(), filename);\n    } else {\n      canvas.toBlob((blob) => saveAs(blob, filename));\n    }\n  } catch (e) {\n    errorMessage(e, false);\n  }\n}\n","import OlMousePosition from 'ol/control/MousePosition';\nimport { format as olFormat } from 'ol/coordinate';\nimport OlScaleLine from 'ol/control/ScaleLine';\nimport { errorMessage } from '../../../utils/error-handler';\nimport paramToArray from '../../utils/param-to-array';\n\n// 控件生成函数\nconst controls = {\n  mousePosition: () =>\n    new OlMousePosition({\n      undefinedHTML: '',\n      coordinateFormat(coordinate) {\n        const text = olFormat(coordinate, '当前鼠标位置 X:{x}, Y:{y}', 4);\n        return `<p>${text}</p>`;\n      }\n    }),\n  scaleLine: () => new OlScaleLine()\n};\n\nexport function getControls(controlNames) {\n  const result = [];\n  controlNames = paramToArray(controlNames);\n  controlNames.forEach((name) => {\n    if (controls.hasOwnProperty(name)) {\n      result.push(controls[name]());\n    } else {\n      errorMessage(`控件列表中无法找到 ${name}`);\n    }\n  });\n  return result;\n}\n\nexport default controls;\n","const allowedTypes = ['boolean', 'string', 'number'];\n\n/**\n * 将对象转换为简单格式（去掉对象）\n */\nexport function formatObjectSimple(obj) {\n  const result = {};\n  let item;\n  for (let key in obj) {\n    if (obj.hasOwnProperty(key)) {\n      item = obj[key];\n      if (allowedTypes.includes(typeof item)) {\n        result[key] = item;\n      }\n    }\n  }\n  return result;\n}\n","/**\n * 格式化长度单位\n */\nexport function formatLengthToStr(length) {\n  let output;\n  if (length > 999) {\n    output = Math.round((length / 1000) * 100) / 100 + ' ' + 'km';\n  } else {\n    output = Math.round(length * 100) / 100 + ' ' + 'm';\n  }\n  return output;\n}\n\n/**\n * 格式化面积单位\n */\nexport function formatAreaToString(area) {\n  let output;\n  if (area > 99999) {\n    output = Math.round((area / 1000000) * 100) / 100 + ' ' + 'k㎡';\n  } else {\n    output = Math.round(area * 100) / 100 + ' ' + '㎡';\n  }\n  return output;\n}\n","/**\n * gis 工具类\n */\nimport Style from 'ol/style/Style';\nimport Fill from 'ol/style/Fill';\nimport Stroke from 'ol/style/Stroke';\nimport EsriJSON from 'ol/format/EsriJSON';\nimport { getArea, getLength } from 'ol/sphere';\n\nimport saveCanvas from '../utils/export-map';\nimport { getControls } from './controls';\nimport { getServiceDetail } from '../api/service';\nimport paramToArray from '../utils/param-to-array';\nimport { mergeConfig } from '../../utils/update-config';\nimport { warnMessage } from '../../utils/error-handler';\nimport { formatObjectSimple } from '../utils/format-object';\nimport { checkValidArray } from '../../utils/check-array';\nimport { formatAreaToString, formatLengthToStr } from '../utils/format-number';\n\n/**\n * @typedef {module:ol/geom/Point|module:ol/geom/LineString|module:ol/geom/Polygon} Geometry\n */\n\n/**\n * /rest/service/xxx/MapServer/x/query 接口的请求参数\n * @typedef {object} LayerQueryParams\n * @property {string} serviceCode 服务地址，例如：X510183TDXZG2017XZQ\n * @property {string} layerId 图层的 id，例如：0\n * @property {string} epsgNum 参考系，例如：4499\n * @property {number[]|Geometry} extent 范围，例如：[12, 122, 12, 12] 或者 geometry 对象\n * @property {string} [where] 查询语句，例如：BSM='123'\n * @property {boolean} [returnGeometry=true] 是否返回 geometry 数据\n * @property {string} [outFields=*] 输出 fields，例如：'BSM,DLTB'\n */\n\n/**\n * @typedef {import(\"ol/Feature.js\")} Feature\n */\n\n/**\n * @typedef {Feature|import(\"ol/render/Feature\")} FeatureLike\n */\n\n/**\n * @typedef {Object} FeatureData\n * @property {FeatureLike[]} features\n * @property {Object[]} fields\n */\n\n/**\n * Map 的混入类\n * @mixin GISUtils\n */\nexport default class GISUtils {\n  // EsriJSON\n  formatEsriJSON = new EsriJSON();\n\n  // 当前地图元素样式\n  _mapCursorStyle;\n  _defaultCursor = 'default';\n  _updateSizeTimeId = 0;\n  _selectInteractionState = true;\n\n  constructor(olMap) {\n    this._mapCursorStyle = olMap.getTarget().style;\n  }\n\n  /**\n   * 更新地图尺寸\n   * @description 使用 `requestAnimationFrame` 进行动画优化\n   * @param {Number} duration 持续时间，用于动画中进行过渡式更新大小\n   */\n  updateSize(duration = 0) {\n    const olMap = this.olMap;\n    if (this._updateSizeTimeId) cancelAnimationFrame(this._updateSizeTimeId);\n    this._updateSizeTimeId = setTimeout(() => {\n      this._updateSizeTimeId = 0;\n    }, duration);\n    const animationCallback = () => {\n      if (this._updateSizeTimeId) {\n        olMap.updateSize();\n        requestAnimationFrame(animationCallback);\n      }\n    };\n    requestAnimationFrame(animationCallback);\n  }\n\n  /**\n   * 导出 image\n   */\n  exportImage() {\n    this.olMap.once('rendercomplete', (event) =>\n      saveCanvas(event.context.canvas)\n    );\n    this.olMap.renderSync();\n  }\n\n  /**\n   * 切换光标样式\n   * @param {String} type\n   * @private\n   */\n  toggleCursorStyle(type = this._defaultCursor) {\n    this._defaultCursor = this._mapCursorStyle.cursor;\n    this._mapCursorStyle.cursor = type;\n  }\n\n  /**\n   * 切换地图控件\n   * @param {Boolean} state\n   * @param {Array?} controlsName\n   */\n  toggleControls(state, controlsName) {\n    if (state) {\n      const controls = getControls(controlsName);\n      controls.forEach((item, index) => {\n        this.olMap.addControl(item);\n        this.controls[controlsName[index]] = item;\n      });\n    } else {\n      if (!controlsName || !controlsName.length) {\n        controlsName = Object.keys(this.controls);\n      }\n      controlsName.forEach((item) => {\n        if (this.controls.hasOwnProperty(item)) {\n          this.olMap.removeControl(this.controls[item]);\n          delete this.controls[item];\n        }\n      });\n    }\n  }\n\n  /**\n   * 切换要去选取的状态\n   * @param state\n   */\n  toggleSelectInteraction(state = !this._selectInteractionState) {\n    this._selectInteractionState = state;\n    this.selectInteraction.setActive(state);\n  }\n\n  /**\n   * 获取图层信息\n   * @param {LayerQueryParams} param\n   * @return {Promise<FeatureData>}\n   */\n  getLayerInfo(param) {\n    // extent 转换为 geometry/geometryType\n    const newParam = { ...param };\n    const { geometry, geometryType } = this.formatGeometryObject(\n      newParam.extent\n    );\n\n    newParam.geometry = JSON.stringify(geometry);\n    newParam.geometryType = geometryType;\n    delete newParam.extent;\n\n    return getServiceDetail(newParam);\n  }\n\n  /**\n   * 获取图层的详情请求参数\n   * @param {String} layerId 图层ID\n   * @param {Object} elseParams 其他参数\n   * @return {{extent: *, layerId: *, serviceCode: *, epsgNum: *}|null}\n   */\n  getLayerInfoParams(layerId, elseParams = {}) {\n    const node = this.treeLayers.find((item) => item.id === layerId);\n    if (node) {\n      const nodeConfig = node.config;\n      const nodeConfigGroup = node.configGroup;\n      return {\n        serviceCode: nodeConfig.serviceCode,\n        layerId: nodeConfig.serverId,\n        epsgNum: nodeConfigGroup.wkid,\n        extent: nodeConfigGroup.extent,\n        ...elseParams\n      };\n    } else {\n      warnMessage(`未找到该图层 ${layerId}`);\n      return null;\n    }\n  }\n\n  /**\n   * 获取图层字段\n   * @param {String} layerId 图层ID\n   * @return {Promise<{label: *, value: *}[]>}\n   */\n  getLayerField(layerId) {\n    return this.getLayerInfo(\n      this.getLayerInfoParams(layerId, { returnGeometry: false })\n    ).then((res) => {\n      return res.fields\n        .map((item) => {\n          return {\n            value: item.name,\n            label: item.alias\n          };\n        })\n        .filter((res) => res.value);\n    });\n  }\n\n  /**\n   * 获取图层字段值\n   * @param {String} layerId 图层ID\n   * @param {String} field 字段名称\n   * @return {Promise<{label: *, value: *}[]>}\n   */\n  getLayerFieldValue(layerId, field) {\n    return this.getLayerInfo(\n      this.getLayerInfoParams(layerId, {\n        outFields: field,\n        returnGeometry: false\n      })\n    ).then((res) => {\n      const result = new Set();\n      const features = res.features;\n      let fieldValue;\n      features.forEach(\n        /**@type {Object<attributes>} item */ (item) => {\n          fieldValue = String(item.attributes[field]).trim();\n          fieldValue && result.add(fieldValue);\n        }\n      );\n      return Array.from(result).map((item) => ({ value: item, label: item }));\n    });\n  }\n\n  /**\n   * 解析要素\n   * @param {FeatureData} featureData\n   * @return {FeatureLike[]}\n   */\n  resolveFeatureData(featureData) {\n    return /**@type {FeatureLike[]} */ this.formatEsriJSON.readFeatures(\n      featureData\n    );\n  }\n\n  /**\n   * 渲染要素数据\n   * @param {FeatureData} featureData 要素数据\n   * @return {FeatureLike|FeatureLike[]}\n   */\n  renderFeatureData(featureData) {\n    const features = this.resolveFeatureData(featureData);\n    this.addFeature(features);\n\n    return features;\n  }\n\n  /**\n   * 添加要素\n   * @param {Feature|Feature[]} feature\n   */\n  addFeature(feature) {\n    const vectorSource = this.vectorSource;\n    feature = paramToArray(feature);\n    feature.forEach((item) => {\n      if (item && !vectorSource.hasFeature(item)) {\n        vectorSource.addFeature(item);\n      }\n    });\n  }\n\n  /**\n   * 移除 feature\n   * @param {Feature|Feature[]} feature\n   */\n  removeFeature(feature) {\n    const vectorSource = this.vectorSource;\n    feature = paramToArray(feature);\n    feature.forEach((item) => {\n      if (item && vectorSource.hasFeature(item)) {\n        vectorSource.removeFeature(item);\n      }\n    });\n  }\n\n  /**\n   * 聚焦 feature\n   * @param {Feature} feature\n   * @return {Feature}\n   */\n  focusFeature(feature) {\n    this.setFeatureStyle(feature);\n    this.addFeature(feature);\n    this.interactions.zoom.toFeatures([feature]);\n    return feature;\n  }\n\n  /**\n   * 查询要素（在当前展示的图层上查询）\n   *\n   * @param {object} [params] 查询参数\n   * @property {number[]} [extent] 范围\n   * @property {string} [where] SQL语句\n   * @property {string[]} [layerIds] 可查询的图层ID\n   * @return {Promise<{data: Array, features: Array}>}\n   */\n  searchFeature(params = {}) {\n    const { layerIds } = params;\n    let filterCallback = (layer) => layer.checked;\n    if (checkValidArray(layerIds)) {\n      this.checkChange(layerIds, true);\n      filterCallback = (layer) => layerIds.includes(layer.id);\n    }\n    let config, configGroup;\n    const promiseArr = this.treeLayers.filter(filterCallback).map((layer) => {\n      config = layer.config;\n      configGroup = layer.configGroup;\n      return this.getLayerInfo({\n        serviceCode: config.serviceCode,\n        layerId: config.serverId,\n        epsgNum: configGroup.wkid,\n        extent: params.extent || configGroup.extent,\n        where: params.where\n      }).then((res) => {\n        if (res && !res.error) {\n          const features = this.resolveFeatureData(res);\n          let properties, BSM;\n          return {\n            id: layer.id,\n            name: layer.name,\n            children: features.map((feature) => {\n              properties = formatObjectSimple(feature.getProperties());\n              BSM = properties.BSM;\n              // 兼容数据格式 - start\n              if (!BSM && BSM !== 0) {\n                warnMessage('找不到该数据 BSM 值，将使用 OBJECTID', properties);\n                BSM = properties.BSM = properties.OBJECTID;\n                feature.set('BSM', BSM);\n              }\n              // 兼容数据格式 - end\n              return {\n                id: BSM,\n                name: BSM,\n                properties\n              };\n            }),\n            features\n          };\n        } else {\n          return Promise.reject(res);\n        }\n      });\n    });\n    return Promise.all(promiseArr).then(\n      /**@type {Array} data */ (data) => {\n        let features = [];\n        data = data.filter((item) => checkValidArray(item.children));\n        if (data.length) {\n          features = data.reduce(\n            (prev, next) => [...prev, ...next.features],\n            []\n          );\n          this.clearFeature();\n          this.addFeature(features);\n          this.interactions.zoom.toFeatures(features);\n        }\n        return { features, data };\n      },\n      (error) => {\n        return Promise.reject(error);\n      }\n    );\n  }\n\n  /**\n   * 选中要素\n   * @param {Feature|Feature[]} feature 要素对象或集合\n   */\n  selectFeature(feature) {\n    this.clearSelectFeature();\n    const features = paramToArray(feature);\n    features.forEach((item) => this.selectedFeatures.push(item));\n  }\n\n  /**\n   * 设置要素样式\n   * @param {Feature|Feature[]} feature\n   * @param {{fillStyle, strokeStyle}} [options]\n   * @property {Object} [fillStyle] 填充样式，参考 ol/style/Style 配置\n   * @property {Object} [strokeStyle] 线条样式，参考 ol/style/Stroke 配置\n   */\n  setFeatureStyle(feature, options = {}) {\n    const features = paramToArray(feature);\n    mergeConfig(\n      {\n        fillStyle: {\n          color: 'rgba(255,255,255,0.7)'\n        },\n        strokeStyle: {\n          color: '#3399CC',\n          width: 3\n        }\n      },\n      options\n    );\n    features.forEach((feature) =>\n      feature.setStyle(\n        new Style({\n          fill: new Fill(options.fillStyle),\n          stroke: new Stroke(options.strokeStyle)\n        })\n      )\n    );\n  }\n\n  // 清理选中要素\n  clearSelectFeature() {\n    this.selectedFeatures.clear();\n  }\n\n  /**\n   * 清理要素\n   */\n  clearFeature() {\n    this.clearSelectFeature();\n    this.vectorSource.clear();\n  }\n\n  /**\n   * 清理地图上的元素\n   * 1. 清理覆盖层\n   * 2. 清理要素\n   */\n  clear() {\n    // remove overlay\n    this.olMap.getOverlays().clear();\n\n    // remove feature\n    this.clearFeature();\n\n    // emit event\n    this.eventHub.dispatch('clear');\n  }\n\n  /**\n   * 获取几何范围\n   * @param {Number[]|Geometry} geometryLike\n   */\n  formatGeometryObject(geometryLike) {\n    let geometry = {};\n    let geometryType = '';\n    if (Array.isArray(geometryLike)) {\n      geometryType = 'esriGeometryEnvelope';\n      geometry = {\n        xmin: geometryLike[0],\n        ymin: geometryLike[1],\n        xmax: geometryLike[2],\n        ymax: geometryLike[3]\n      };\n    } else {\n      const type = geometryLike.getType();\n      geometryType =\n        type === 'Polygon'\n          ? 'esriGeometryPolygon'\n          : type === 'Point'\n          ? 'esriGeometryPoint'\n          : 'esriGeometryPolyline';\n      geometry = this.formatEsriJSON.writeGeometryObject(geometryLike);\n    }\n\n    geometry.spatialReference = {\n      wkid: this.mapConfig.wkid\n    };\n\n    return {\n      geometryType,\n      geometry\n    };\n  }\n\n  /**\n   * 格式化几何图形的大小\n   * @param {Polygon|LineString} geometry\n   * @return {{str: String, num: Number}}\n   */\n  formatGeometrySize(geometry) {\n    const type = geometry.getType();\n    const params = { projection: this.mapConfig.epsg };\n    let str = '',\n      num = 0;\n    switch (type) {\n      case 'Polygon':\n        num = getArea(geometry, params);\n        str = formatAreaToString(num);\n        break;\n      case 'LineString':\n        num = getLength(geometry, params);\n        str = formatLengthToStr(num);\n        break;\n      default:\n    }\n    return { str, num };\n  }\n}\n","import Overlay from 'ol/Overlay.js';\nimport OlDraw from 'ol/interaction/Draw.js';\n\nimport ToggleActive from '../common/toggle-active';\nimport classMixin from '../../utils/class-mixin';\nimport GISEvent from '../common/gis-event';\nimport { errorMessage } from '../../../utils/error-handler';\n\n/**\n * 测量（线/多边形）\n *\n * @extends GISEvent\n * @extends ToggleActive\n *\n * @typedef {{\n *   geometry: Geometry,\n *   length?: number,\n *   area?: number,\n *   extent: number[]\n * }} eventResult\n *\n * @event drawstart 绘制开始事件，返回 eventResult\n * @event drawend 绘制结束事件，返回 eventResult\n */\nexport default class Draw extends classMixin(GISEvent, ToggleActive) {\n  _map;\n  _olMap;\n  _viewport;\n  _vectorSource;\n  _draw;\n  _helpTooltipElement;\n  _helpTooltip;\n  _helpMsg = '点击开始绘制';\n  _continueEndMsg = '再次点击结束绘制';\n  _continuePolygonMsg = '点击继续绘制多边形';\n  _continueLineMsg = '点击继续绘制线条';\n  _supportTypes = ['Polygon', 'LineString', 'Circle', 'Point'];\n  _helpMsgType;\n  _showHelpTooltip;\n  _features = [];\n\n  constructor(map) {\n    super('drawstart,drawend'); // 初始化 drawstart，drawend 监听事件\n\n    this._map = map;\n    this._olMap = map.olMap;\n    this._viewport = map.olMap.getViewport();\n    this._vectorSource = map.vectorSource;\n\n    // `this` lose in event listener\n    this._pointerMoveHandler = this._pointerMoveHandler.bind(this);\n    this._hideHelpTooltipElement = this._hideHelpTooltipElement.bind(this);\n\n    map.eventHub.on('clear', () => this.clear());\n  }\n\n  /**\n   * Activate\n   * @param {String} type LineString/Polygon\n   * @param {Boolean} isFreehand 是否自由绘制\n   */\n  activateHandle(type, isFreehand) {\n    // check type\n    if (!this._supportTypes.includes(type)) {\n      return errorMessage(\n        `${type} 绘制类型不支持，支持的类型有 ${this._supportTypes}`\n      );\n    }\n\n    // add element\n    this._createHelpTooltip();\n\n    // add listener\n    this._olMap.on('pointermove', this._pointerMoveHandler);\n    this._viewport.addEventListener('mouseout', this._hideHelpTooltipElement);\n\n    // add interaction\n    this._addInteraction(type, isFreehand);\n  }\n\n  /**\n   * Deactivate\n   */\n  deactivateHandle() {\n    // remove element\n    this._removeHelpTooltip();\n\n    // remove listener\n    this._olMap.un('pointermove', this._pointerMoveHandler);\n    this._viewport.removeEventListener(\n      'mouseout',\n      this._hideHelpTooltipElement\n    );\n\n    // remove interaction\n    this._removeInteraction();\n  }\n\n  /**\n   * 清理绘制的要素\n   */\n  clear() {\n    this._map.removeFeature(this._features);\n    this._features = [];\n  }\n\n  /**\n   * Hide helpTooltipElement\n   * @private\n   */\n  _hideHelpTooltipElement() {\n    this._helpTooltipElement.classList.add('webgis-hidden');\n  }\n\n  /**\n   * Handle pointer move.\n   * @param {Object} evt ol/MapBrowserEvent\n   * @private\n   */\n  _pointerMoveHandler(evt) {\n    if (evt.dragging) {\n      return;\n    }\n\n    let helpMsg = this._helpMsg;\n    switch (this._helpMsgType) {\n      case 'LineString':\n        helpMsg = this._continueLineMsg;\n        break;\n      case 'Polygon':\n        helpMsg = this._continuePolygonMsg;\n        break;\n      case 'Circle':\n        helpMsg = this._continueEndMsg;\n        break;\n      default:\n    }\n\n    if (this._showHelpTooltip && helpMsg) {\n      this._helpTooltip.setPosition(evt.coordinate);\n      this._helpTooltipElement.innerHTML = helpMsg;\n      this._helpTooltipElement.classList.remove('webgis-hidden');\n    } else {\n      this._helpTooltipElement.classList.add('webgis-hidden');\n    }\n  }\n\n  /**\n   * Add interaction\n   * @param {String} type\n   * @param {Boolean} isFreehand\n   * @private\n   */\n  _addInteraction(type, isFreehand) {\n    const map = this._map;\n\n    this._showHelpTooltip = !isFreehand; // 如果自由绘制则不展示提示\n\n    this._draw = new OlDraw({\n      source: this._vectorSource,\n      type: type,\n      freehand: isFreehand\n    });\n    this._olMap.addInteraction(this._draw);\n\n    this._draw.on('drawstart', (evt) => {\n      map.toggleSelectInteraction(false);\n      this.dispatch('drawstart', this._formatEventData(evt));\n      this._helpMsgType = type;\n    });\n    this._draw.on('drawend', (evt) => {\n      this._features.push(evt.feature);\n      map.toggleSelectInteraction(true);\n      // 防止在还未添加要素就移除的情况\n      setTimeout(() => this.dispatch('drawend', this._formatEventData(evt)), 0);\n      this._helpMsgType = '';\n    });\n  }\n\n  /**\n   * Remove\n   * @private\n   */\n  _removeInteraction() {\n    this._olMap.removeInteraction(this._draw);\n    this._draw = null;\n  }\n\n  /**\n   * Creates a new help tooltip\n   * @private\n   */\n  _createHelpTooltip() {\n    this._helpTooltipElement = document.createElement('div');\n    this._helpTooltipElement.className = 'webgis-measure-tooltip webgis-hidden';\n    this._helpTooltip = new Overlay({\n      element: this._helpTooltipElement,\n      offset: [15, 0],\n      positioning: 'center-left'\n    });\n    this._olMap.addOverlay(this._helpTooltip);\n  }\n\n  /**\n   * Remove helpTooltip\n   * @private\n   */\n  _removeHelpTooltip() {\n    this._helpTooltipElement = null;\n    this._olMap.removeOverlay(this._helpTooltip);\n    this._helpTooltip = null;\n  }\n\n  /**\n   * 格式化监听事件的数据\n   * @return {eventResult}\n   */\n  _formatEventData(evt) {\n    const geometry = evt.feature.getGeometry();\n    const type = geometry.getType();\n    const extent =\n      type === 'Polygon'\n        ? this._map.formatEsriJSON.writeGeometry(geometry)\n        : geometry.getExtent();\n    return {\n      geometry,\n      type,\n      extent\n    };\n  }\n}\n","import OlDragZoom from 'ol/interaction/DragZoom';\nimport { mouseOnly } from 'ol/events/condition';\nimport ToggleActive from '../common/toggle-active';\nimport classMixin from '../../utils/class-mixin';\nimport GISEvent from '../common/gis-event';\n\n/**\n * 拖动缩放\n */\nexport default class DragZoom extends classMixin(GISEvent, ToggleActive) {\n  _map;\n  _olMap;\n  _options = {\n    out: null,\n    active: false,\n    condition: mouseOnly\n  };\n\n  constructor(map) {\n    super('boxstart,boxend');\n\n    this._map = map;\n    this._olMap = map.olMap;\n  }\n\n  /**\n   * 切换状态\n   */\n  toggleActive(state, type) {\n    const out = type !== 'zoom-in';\n    if (state) {\n      this.activate(out);\n    } else {\n      this.deactivate();\n    }\n  }\n\n  // 激活 extends ToggleActive\n  activateHandle(out) {\n    this._options.out = out;\n    this._olMap.addInteraction(\n      (this._dragZoom = new OlDragZoom(this._options))\n    );\n    this._dragZoom.on('boxstart', (e) => this.dispatch('boxstart', e));\n    this._dragZoom.on('boxend', (e) => this.dispatch('boxend', e));\n    this._map.toggleCursorStyle(out ? 'zoom-out' : 'zoom-in');\n  }\n\n  // 关闭 extends ToggleActive\n  deactivateHandle() {\n    this._options.out = null;\n    this._olMap.removeInteraction(this._dragZoom);\n    this._map.toggleCursorStyle();\n  }\n}\n","/**\n * Promise 队列，执行完当前 Promise 才进行下一次\n * @param {Object} context 执行环境\n * @param {Function} promiseFunction\n * @return {Promise<*>}\n */\nexport default function promiseQueue(context, promiseFunction) {\n  context._promiseQueue = context._promiseQueue || Promise.resolve();\n  return (context._promiseQueue = context._promiseQueue.then(() => {\n    return promiseFunction();\n  })).then((res) => {\n    context._promiseQueue = Promise.resolve();\n    return res;\n  });\n}\n","import OlMap from 'ol/Map';\nimport * as olProj from 'ol/proj';\nimport * as olControl from 'ol/control';\nimport * as olInteraction from 'ol/interaction';\nimport OlView from 'ol/View';\nimport camelCase from 'lodash/camelCase';\nimport Select from 'ol/interaction/Select';\nimport VectorSource from 'ol/source/Vector';\nimport VectorLayer from 'ol/layer/Vector';\n\nimport getModule from './modules/index';\nimport LayerTree from './layer-tree';\nimport GISConfig from './gis-config';\n\nimport Zoom from './interactions/zoom';\nimport DragPan from './interactions/drag-pan';\nimport BoxSelection from './interactions/box-selection';\nimport classMixin from '../utils/class-mixin';\nimport GISUtils from './gis-utils';\nimport Draw from './interactions/draw';\nimport DragZoom from './interactions/drag-zoom';\nimport { setAliasMap } from '../config/alias';\nimport { setDefaultLayerConfig, setDefaultVisibleService } from '../config';\nimport { registerEPSG } from '../config/proj4';\nimport GISEvent from './common/gis-event';\nimport { errorMessage } from '../../utils/error-handler';\nimport promiseQueue from '../../utils/promise-queue';\nimport { checkValidArray } from '../../utils/check-array';\n\n// 生成实例的唯一 ID (递增)\nlet mapId = 1;\n\n/**\n * Map\n * @mixes LayerTree,GISUtils\n * @description\n * 用于地图的初始化\n */\nexport default class Map extends classMixin(LayerTree, GISUtils) {\n  id = mapId++;\n  olMap;\n  olView;\n  mapConfig;\n  interactions = {}; // 内置交互功能集\n  controls = {}; // 地图控件集\n  eventHub = new GISEvent('layerChange,checkChange,clear');\n\n  /** @type {Modules} 内置或者按需加载的模块功能集 */\n  modules = {};\n\n  // 全局共用\n  selectInteraction = new Select();\n  vectorSource = new VectorSource();\n  vectorLayer = new VectorLayer({\n    source: this.vectorSource,\n    zIndex: 99999 // 防止矢量图层在基础图层下面\n  });\n  selectedFeatures;\n\n  constructor({ olMap, showControls, controls }) {\n    super(olMap);\n\n    this.olMap = olMap;\n\n    // 全局共用\n    olMap.addInteraction(this.selectInteraction);\n    olMap.addLayer(this.vectorLayer);\n    this.selectedFeatures = this.selectInteraction.getFeatures();\n\n    // 初始化控件\n    this.toggleControls(showControls, controls);\n  }\n\n  init({ serviceCode, showLayers, modules }) {\n    return GISConfig.create(serviceCode)\n      .then((mapConfig) => {\n        this.mapConfig = mapConfig;\n\n        // 1. 创建视图\n        this.initView();\n        // 2. 创建图层\n        this.createLayerTree(mapConfig.groupLayers, showLayers);\n        // 3. 创建内置交互功能集\n        this.interactions = {\n          zoom: new Zoom(this),\n          dragPan: new DragPan(this),\n          boxSelection: new BoxSelection(this),\n          draw: new Draw(this),\n          dragZoom: new DragZoom(this)\n        };\n        // 4. 创建功能模块\n        return this.initModules(modules).then(() => this);\n      })\n      .catch(errorMessage);\n  }\n\n  // 初始化视图\n  initView() {\n    const mapConfig = this.mapConfig;\n\n    // 设置参照系范围\n    const projection = new olProj.Projection({\n      code: mapConfig.epsg,\n      axisOrientation: 'neu'\n    });\n    projection.setExtent(mapConfig.extent);\n\n    this.olMap.setView(\n      (this.olView = new OlView({\n        center: mapConfig.center,\n        extent: mapConfig.extent,\n        zoom: mapConfig.zoom,\n        projection,\n        resolutions: mapConfig.resolutions\n      }))\n    );\n  }\n\n  /**\n   * 初始化功能模块\n   * @param {Array} modules\n   * @return {Promise<*[]>}\n   */\n  initModules(modules) {\n    this.modules = {};\n    return Promise.all(\n      Array.from(modules).map((moduleName) => {\n        return getModule(moduleName).then((module) => {\n          this.modules[camelCase(moduleName)] = new module(this);\n        });\n      })\n    );\n  }\n\n  /**\n   * 创建地图\n   * @description\n   * 这里主要的作用：\n   * 1. 创建 ol/Map 实例\n   * 2. 创建 Map 实例\n   * 3. 执行地图初始化（异步）\n   *\n   * @param {Element|*} target 创建地图的目标 DOM 元素\n   * @param {String|Array} [serviceCode] gis 服务 ID\n   * @param {{land, region, scale, special, year, layer}} [aliasMap] 图层的中文别名对照表\n   * @param {Array|String} [showLayers] 需要展示的图层名称集合\n   * @param {Array<String>|Set<String>} [modules] 所需的功能模块集合\n   * @param {Boolean?} [showControls] 是否展示控件\n   * @param {Array<String>} [controls] 所需的控件\n   * @param {{ land, region, special, layer, year }} [defaultVisibleService] 默认的服务地址对象\n   * @param {Object} [epsgConfig] EPSG 配置，例如：{ 'EPSG:4490': '+proj=longlat +ellps=GRS80 +no_defs' }\n   * @param {{ zoomThreshold }} [defaultLayerConfig] 默认图层配置\n   *\n   * @returns {Promise<Map>}\n   */\n  static create({\n    target,\n    serviceCode = [],\n    aliasMap = {},\n    showLayers = [],\n    modules = [],\n    showControls = true,\n    controls = [],\n    defaultVisibleService = {},\n    epsgConfig = {},\n    defaultLayerConfig = {}\n  }) {\n    if (!target) {\n      return Promise.reject('[target] is null!');\n    }\n\n    // 防止同时执行多次\n    return promiseQueue(target, () => {\n      const viewport = target.querySelectorAll('.ol-viewport');\n      if (checkValidArray(viewport)) {\n        viewport.forEach((item) => item.remove());\n      }\n\n      // 更新图层的中文别名对照表\n      setAliasMap(aliasMap);\n\n      // 设置默认的行政区代码（地图首次展示的图层）\n      setDefaultVisibleService(defaultVisibleService);\n\n      // 注册参考系\n      registerEPSG(epsgConfig);\n\n      // 设置图层配置\n      setDefaultLayerConfig(defaultLayerConfig);\n\n      const olMap = new OlMap({\n        target: target,\n        controls: olControl.defaults({\n          attribution: false,\n          zoom: false\n        }),\n        interactions: olInteraction.defaults(\n          /** @type {DefaultsOptions} */ {\n            dragPan: false\n          }\n        )\n      });\n      const map = new Map({ olMap, showControls, controls });\n      return map.init({ serviceCode, showLayers, modules });\n    });\n  }\n}\n","<template>\n  <div class=\"webgis-map\" ref=\"map\"></div>\n</template>\n\n<script>\nimport GIS from '../../gis';\nimport { webgisProps } from '../../mixins/webgis-props';\nimport { errorMessage } from '../../utils/error-handler';\nimport promiseQueue from '../../utils/promise-queue';\n\n/**\n * 地图组件（仅创建地图）\n */\nexport default {\n  name: 'WebGISMap',\n  mixins: [webgisProps],\n  data() {\n    return {\n      requireModules: [\n        'HistoryRecord',\n        'FeatureSelect',\n        'Measure',\n        'LayerSwipe'\n      ]\n    };\n  },\n  computed: {\n    webgisConfig() {\n      return {\n        ...this.options,\n        target: this.$refs.map,\n        modules: new Set([...this.modules, ...this.requireModules]),\n        showControls: this.showControls,\n        controls: this.controls\n      };\n    }\n  },\n  methods: {\n    initMap() {\n      // 防止同时执行多次\n      this.$_initWebgisPromise = promiseQueue(this, () => {\n        return GIS.create(this.webgisConfig)\n          .then(\n            (webgis) => {\n              this.$webgis = webgis;\n              this.$emit('init', webgis);\n            },\n            (error) => {\n              this.$emit('init', false, error);\n            }\n          )\n          .catch(errorMessage);\n      });\n    }\n  },\n  mounted() {\n    this.initMap();\n  },\n  watch: {\n    'options.showLayers': function(newVal) {\n      this.$_initWebgisPromise.then(() => {\n        const webgis = this.$webgis;\n        webgis.clear();\n        webgis.layerChange(newVal);\n      });\n    },\n    showControls: function() {\n      this.$_initWebgisPromise.then(() => {\n        this.$webgis.toggleControls(this.showControls, this.controls);\n      });\n    }\n  }\n};\n</script>\n\n<style lang=\"scss\" scoped>\n.webgis-map {\n  height: 100%;\n  background: #f2f2f2;\n}\n</style>\n","'use strict';\n\nfunction normalizeComponent(template, style, script, scopeId, isFunctionalTemplate, moduleIdentifier\n/* server only */\n, shadowMode, createInjector, createInjectorSSR, createInjectorShadow) {\n  if (typeof shadowMode !== 'boolean') {\n    createInjectorSSR = createInjector;\n    createInjector = shadowMode;\n    shadowMode = false;\n  } // Vue.extend constructor export interop.\n\n\n  var options = typeof script === 'function' ? script.options : script; // render functions\n\n  if (template && template.render) {\n    options.render = template.render;\n    options.staticRenderFns = template.staticRenderFns;\n    options._compiled = true; // functional template\n\n    if (isFunctionalTemplate) {\n      options.functional = true;\n    }\n  } // scopedId\n\n\n  if (scopeId) {\n    options._scopeId = scopeId;\n  }\n\n  var hook;\n\n  if (moduleIdentifier) {\n    // server build\n    hook = function hook(context) {\n      // 2.3 injection\n      context = context || // cached call\n      this.$vnode && this.$vnode.ssrContext || // stateful\n      this.parent && this.parent.$vnode && this.parent.$vnode.ssrContext; // functional\n      // 2.2 with runInNewContext: true\n\n      if (!context && typeof __VUE_SSR_CONTEXT__ !== 'undefined') {\n        context = __VUE_SSR_CONTEXT__;\n      } // inject component styles\n\n\n      if (style) {\n        style.call(this, createInjectorSSR(context));\n      } // register component module identifier for async chunk inference\n\n\n      if (context && context._registeredComponents) {\n        context._registeredComponents.add(moduleIdentifier);\n      }\n    }; // used by ssr in case component is cached and beforeCreate\n    // never gets called\n\n\n    options._ssrRegister = hook;\n  } else if (style) {\n    hook = shadowMode ? function () {\n      style.call(this, createInjectorShadow(this.$root.$options.shadowRoot));\n    } : function (context) {\n      style.call(this, createInjector(context));\n    };\n  }\n\n  if (hook) {\n    if (options.functional) {\n      // register for functional component in vue file\n      var originalRender = options.render;\n\n      options.render = function renderWithStyleInjection(h, context) {\n        hook.call(context);\n        return originalRender(h, context);\n      };\n    } else {\n      // inject component registration as beforeCreate hook\n      var existing = options.beforeCreate;\n      options.beforeCreate = existing ? [].concat(existing, hook) : [hook];\n    }\n  }\n\n  return script;\n}\n\nmodule.exports = normalizeComponent;\n//# sourceMappingURL=normalize-component.js.map\n","<template>\n  <div @click.stop class=\"webgis-opacity-set\">\n    <el-slider\n      class=\"webgis-opacity-set__slider\"\n      v-model=\"opacity\"\n      @input=\"$emit('change', opacity)\"\n      :min=\"0\"\n      :max=\"100\"\n    ></el-slider>\n  </div>\n</template>\n\n<script>\nexport default {\n  props: {\n    visible: Boolean,\n    defaultValue: {\n      type: Number,\n      default: 100\n    }\n  },\n  data() {\n    return {\n      opacity: this.defaultValue\n    };\n  }\n};\n</script>\n\n<style lang=\"scss\" scoped>\n@import '../../../styles/common-variables.scss';\n\n.webgis-opacity-set {\n  box-shadow: $box-shadow-default;\n  border-radius: $border-radius-base;\n  padding: 0 $spacing-base;\n  background: white;\n}\n</style>\n","/**\n * webgis-init 的公共混入对象（此混入对象仅作为基础，需要扩展）\n * @description\n * 1. 初始化 $webgis 对象\n * 2. 初始化 webgisReady 状态\n * 3. 执行 webgis 初始化完成的钩子（在组件中定义的 afterInitWebgis 方法）\n */\n\nexport default {\n  data() {\n    return {\n      webgisReady: false\n    };\n  },\n  created() {\n    this.$webgis = null; // declare $webgis\n  },\n  methods: {\n    // webgis 初始化完成后，初始化数据\n    _afterInitWebgis(webgis) {\n      this.webgisReady = true;\n      if (webgis) {\n        this.$webgis = webgis;\n        if (this.afterInitWebgis instanceof Function) {\n          this.afterInitWebgis();\n        }\n      }\n    }\n  }\n};\n","/**\n * 私有的事件中心注册，仅用于单个的 webgis 组件上（在分屏时应用于单个内）\n * @description\n * 1. **用于 webgis 内部的事件传递**\n * 2. **`$_eventHub` 用于处理 provide 与 inject 同时使用的情况**\n * 3. **`privateEventHubProvide` 在一个范围内仅使用一次**\n *\n * @example\n * ```\n * import {privateEventHubProvide, privateEventHubInject} from './private-event-hub';\n *\n * export default {\n *   mixins: [privateEventHubProvide, privateEventHubInject], // 加入\n *   methods: {\n *     doSomeThing() {\n *       this.$eventHub.$emit('someEvent', 'test'); // 使用\n *     }\n *   }\n * }\n * ```\n */\nimport Vue from 'vue';\nimport { warnMessage } from '../utils/error-handler';\n\nexport const privateEventHubProvide = {\n  provide() {\n    return {\n      $_eventHub: this.$eventHub\n    };\n  },\n  beforeCreate() {\n    // 禁用重复注册\n    if (this.$eventHub) {\n      return warnMessage('私有的事件中心在一个范围内仅能存在一个!');\n    }\n    this.$eventHub = new Vue();\n  }\n};\n\nexport const privateEventHubInject = {\n  inject: {\n    $_eventHub: {\n      type: Object,\n      default: null\n    }\n  },\n  created() {\n    this.$eventHub = this.$_eventHub || this.$data.$evenHub;\n  }\n};\n","/**\n * 此混入对象作为当前的组件库内使用\n * @description\n * **此处涉及分屏的状态管理，逻辑复杂**\n * 1. webgisProvide 在每一个 webgis 组件中，仅存在一个，所以在分屏中会有很多的实例\n * 2. webgisInject 在每一个 webgis 组件中，仅作为 webgisProvide 的子组件使用，非子组件不能使用\n */\nimport webgisInitCommon from './webgis-init-common';\nimport {\n  privateEventHubInject,\n  privateEventHubProvide\n} from './private-event-hub';\n\nconst eventName = 'privateWebgisReady';\n\nexport const webgisProvide = {\n  mixins: [webgisInitCommon, privateEventHubProvide],\n  methods: {\n    initWebgis(webgis) {\n      this.$emit('init', webgis); // emit parent\n      this.$eventHub.$emit(eventName, webgis); // emit inject\n      this.$eventHub.$webgis = webgis; // hook\n      this._afterInitWebgis(webgis);\n    }\n  }\n};\n\nexport const webgisInject = {\n  mixins: [webgisInitCommon, privateEventHubInject],\n  methods: {\n    _initWebgis(webgis) {\n      // cancel event listener\n      this.$eventHub.$off(eventName, this._initWebgis);\n      this._afterInitWebgis(webgis);\n    }\n  },\n  created() {\n    // if `$webgis` ready, don't need listener\n    const webgis = this.$eventHub.$webgis;\n    if (webgis) {\n      this.$webgis = webgis;\n      this._initWebgis(webgis);\n    } else {\n      this.$eventHub.$on(eventName, this._initWebgis);\n    }\n  }\n};\n","<template>\n  <div class=\"webgis-aside scrollbar-default\">\n    <el-tree\n      ref=\"elTree\"\n      @check=\"onCheckChange\"\n      :default-checked-keys=\"showLayers\"\n      :default-expanded-keys=\"expandedKeys\"\n      :data=\"treeNodes\"\n      show-checkbox\n      node-key=\"id\"\n    >\n      <div\n        slot-scope=\"{ node, data }\"\n        class=\"webgis-aside__tree-item\"\n        :class=\"{ 'is-layer': data.nodeType === 'layer' }\"\n      >\n        <label :title=\"data.name\">{{ data.name }}</label>\n        <el-dropdown\n          @command=\"dropdownSelect($event, data)\"\n          v-if=\"data.nodeType === 'layer'\"\n          size=\"medium\"\n          class=\"webgis-aside__tree-tools\"\n        >\n          <span class=\"webgis-aside__tree-select-toggle\">\n            <i class=\"el-icon-setting\"></i>\n          </span>\n          <el-dropdown-menu slot=\"dropdown\">\n            <el-dropdown-item command=\"zoom\">\n              <i class=\"el-icon-zoom-in\"></i>缩放至\n            </el-dropdown-item>\n            <el-dropdown-item\n              command=\"opacity\"\n              class=\"webgis-aside__tree-select-item\"\n            >\n              <i class=\"el-icon-brush\"></i>透明度\n              <AsideOpacitySet\n                @change=\"opacitySet(data, $event)\"\n                :default-value=\"data.opacity\"\n              ></AsideOpacitySet>\n            </el-dropdown-item>\n            <el-dropdown-item v-if=\"node.previousSibling\" command=\"move-up\">\n              <i class=\"el-icon-top\"></i>上移\n            </el-dropdown-item>\n            <el-dropdown-item v-if=\"node.nextSibling\" command=\"move-down\">\n              <i class=\"el-icon-bottom\"></i>下移\n            </el-dropdown-item>\n          </el-dropdown-menu>\n        </el-dropdown>\n      </div>\n    </el-tree>\n  </div>\n</template>\n\n<script>\nimport AsideOpacitySet from './aside-opacity-set';\nimport { webgisInject } from '../../../mixins/webgis-init';\n\nexport default {\n  mixins: [webgisInject],\n  components: {\n    AsideOpacitySet\n  },\n  data() {\n    return {\n      treeNodes: [],\n      showLayers: [],\n      expandedKeys: []\n    };\n  },\n  methods: {\n    afterInitWebgis() {\n      const webgis = this.$webgis;\n      this.treeNodes = webgis.treeNodes;\n      this.showLayers = webgis.showLayers;\n      this.expandedKeys = [...this.showLayers]; // 仅执行一次\n      webgis.eventHub.on('layerChange', this.updateShowLayers);\n    },\n    onCheckChange(data, { checkedKeys }) {\n      const checked = checkedKeys.includes(data.id);\n      this.$webgis.checkChange(data.id, checked);\n    },\n    dropdownSelect(type, data) {\n      switch (type) {\n        case 'zoom':\n          // declaration in case have to block `{}`\n          {\n            const { center, zoom } = data.configGroup;\n            this.$webgis.interactions.zoom.animate({ center, zoom });\n          }\n          break;\n        case 'opacity':\n          // none\n          break;\n        case 'move-up':\n          this.$webgis.setLayerSort(data.id, 'up');\n          this.treeNodes = [...this.$webgis.treeNodes]; // trigger change\n          break;\n        case 'move-down':\n          this.$webgis.setLayerSort(data.id, 'down');\n          this.treeNodes = [...this.$webgis.treeNodes]; // trigger change\n          break;\n        default:\n      }\n    },\n    opacitySet(data, opacity) {\n      data.opacity = opacity;\n      this.$webgis.setLayerOpacity(data.id, opacity / 100);\n    },\n    updateShowLayers(showLayers) {\n      this.showLayers = showLayers;\n    }\n  },\n  beforeDestroy() {\n    this.$webgis.eventHub.off('layerChange', this.updateShowLayers);\n  }\n};\n</script>\n\n<style lang=\"scss\" scoped>\n@import '../../../styles/common-variables.scss';\n\n.webgis-aside {\n  overflow: hidden auto;\n  width: $aside-width;\n  height: 100%;\n  .el-tree {\n    padding: $spacing-base;\n    min-height: 100%;\n  }\n  .el-tree-node {\n    &__content {\n      height: 36px;\n      &:hover {\n        .webgis-aside__tree-tools {\n          display: block;\n        }\n        .webgis-aside__tree-item.is-layer {\n          padding-right: 28px;\n        }\n      }\n    }\n    &__children {\n      .el-tree-node__content {\n        height: 30px;\n      }\n    }\n  }\n  &__tree-item {\n    width: 100%;\n    line-height: 1;\n    padding-right: $spacing-base;\n    position: relative;\n    overflow: hidden;\n    text-overflow: ellipsis;\n  }\n  &__tree-tools.el-dropdown {\n    display: none;\n    position: absolute;\n    top: 0;\n    right: 10px;\n  }\n  &__tree-select-toggle {\n    &:hover {\n      color: $color-primary;\n    }\n  }\n  /* element append to body */\n  &__tree-select-item {\n    position: relative;\n    &:hover {\n      .webgis-opacity-set {\n        display: block;\n      }\n    }\n    .webgis-opacity-set {\n      display: none;\n      position: absolute;\n      left: 100%;\n      top: 0;\n      width: 130px;\n    }\n  }\n}\n</style>\n","<template>\n  <div class=\"webgis-aside-tools webgis-absolute-layer\">\n    <el-button @click=\"historyRecordChange(-1)\">\n      <SvgIcon name=\"long-arrow-alt-left\" />\n    </el-button>\n    <el-button @click=\"historyRecordChange(1)\">\n      <SvgIcon name=\"long-arrow-alt-right\" />\n    </el-button>\n    <div class=\"spacer\"></div>\n    <el-button\n      :class=\"{ active: dragZoomActive === 'zoom-in' }\"\n      @click=\"toggleDragZoom('zoom-in')\"\n    >\n      <SvgIcon name=\"search-plus\" />\n    </el-button>\n    <el-button\n      :class=\"{ active: dragZoomActive === 'zoom-out' }\"\n      @click=\"toggleDragZoom('zoom-out')\"\n    >\n      <SvgIcon name=\"search-minus\" />\n    </el-button>\n    <el-button @click=\"zoomRevert()\">\n      <SvgIcon name=\"globe-americas\" />\n    </el-button>\n    <div class=\"spacer\"></div>\n    <el-button @click=\"toggleDragPan()\">\n      <SvgIcon :name=\"dragPanActive ? 'arrows-alt' : 'lock'\" />\n    </el-button>\n    <el-button @click=\"toggleAside()\">\n      <SvgIcon name=\"layer-group\" />\n    </el-button>\n  </div>\n</template>\n\n<script>\nimport SvgIcon from '../../../plugins/svg-icon';\nimport { webgisInject } from '../../../mixins/webgis-init';\nimport { privateEventHubInject } from '../../../mixins/private-event-hub';\n\nexport default {\n  name: 'WebGISAsideTools',\n  mixins: [webgisInject, privateEventHubInject],\n  components: {\n    SvgIcon\n  },\n  data() {\n    return {\n      dragPanActive: true,\n      dragZoomActive: '' // ''|'zoom-in'|'zoom-out'\n    };\n  },\n  methods: {\n    toggleDragPan(state = !this.dragPanActive) {\n      this.dragPanActive = state;\n      this.$webgis.interactions.dragPan.toggleActive(state);\n    },\n    toggleAside() {\n      this.$eventHub.$emit('toggleAside');\n    },\n    zoomRevert() {\n      this.$webgis.interactions.zoom.change('revert');\n    },\n    // type = zoom-in/zoom-out\n    toggleDragZoom(type) {\n      this.dragZoomActive =\n        this.dragZoomActive && this.dragZoomActive === type ? '' : type;\n      this.$webgis.interactions.dragZoom.toggleActive(\n        !!this.dragZoomActive,\n        type\n      );\n    },\n    closeDragZoom() {\n      this.toggleDragZoom();\n    },\n    // direction = 1/-1\n    historyRecordChange(direction) {\n      this.$webgis.modules.historyRecord.change(direction);\n    },\n    afterInitWebgis() {\n      // dragZoom 在绘制完毕后关闭\n      const dragZoom = this.$webgis.interactions.dragZoom;\n      dragZoom.on('boxend', this.closeDragZoom);\n    }\n  },\n  beforeDestroy() {\n    this.$webgis.interactions.dragZoom.offAll('boxend', this.closeDragZoom);\n  }\n};\n</script>\n\n<style lang=\"scss\" scoped>\n@import '../../../styles/common-variables';\n\n.webgis-aside-tools {\n  display: flex;\n  flex-direction: column;\n  top: 60px;\n  left: 10px;\n  .el-button {\n    transition: $transition-base;\n    font-size: 20px;\n    margin: 5px 0 0 !important; /* fix element-ui style */\n    padding: 0;\n    width: 35px;\n    height: 35px;\n    border: none;\n    color: gray;\n    box-shadow: $box-shadow-base;\n    &:focus {\n      border: 1px solid $--color-primary-light-7;\n    }\n    &.active,\n    &:active {\n      border: 1px solid $--button-primary-border-color;\n      color: $color-primary;\n    }\n  }\n  .spacer {\n    height: 15px;\n  }\n}\n</style>\n","<template>\n  <ul class=\"webgis-region-list webgis-list-unstyled webgis-scrollbar-default\">\n    <li\n      class=\"webgis-region-list_item\"\n      v-for=\"city in jurisdictionTreeData\"\n      :key=\"city.id\"\n    >\n      <div class=\"webgis-region-list_item-left\">\n        <el-button @click=\"targetToView(city.id)\" type=\"text\"\n          >{{ city.name }}：</el-button\n        >\n      </div>\n      <ul class=\"webgis-region-list_item-right webgis-list-unstyled\">\n        <li\n          class=\"webgis-region-list_item-right-item\"\n          v-for=\"area in city.children\"\n          :key=\"area.id\"\n        >\n          <el-button @click=\"targetToView(area.id)\" type=\"text\">{{\n            area.name\n          }}</el-button>\n        </li>\n      </ul>\n    </li>\n    <li\n      class=\"webgis-region-list_item__empty\"\n      v-if=\"!jurisdictionTreeData.length\"\n    >\n      暂无数据\n    </li>\n  </ul>\n</template>\n\n<script>\nimport { webgisInject } from '../../../mixins/webgis-init';\nimport { webgisPropsInject } from '../../../mixins/webgis-props';\nimport { warnMessage } from '../../../utils/error-handler';\nimport { checkValidArray } from '../../../utils/check-array';\n\nconst regionListFeatureHash = {};\n\nexport default {\n  name: 'WebGISRegionList',\n  mixins: [webgisInject, webgisPropsInject],\n  computed: {\n    jurisdictionTreeData() {\n      return this.webgisConfig.options.jurisdictionTreeData || [];\n    }\n  },\n  methods: {\n    targetToView(id) {\n      const feature = regionListFeatureHash[id];\n      if (feature) {\n        this.$webgis.focusFeature(feature);\n        setTimeout(() => {\n          this.$webgis.removeFeature(feature);\n        }, 1500);\n      } else {\n        warnMessage('未获取到要素');\n      }\n    },\n    afterInitWebgis() {\n      const webgis = this.$webgis;\n      const treeLayers = webgis.treeLayers;\n      if (checkValidArray(treeLayers)) {\n        const layer = treeLayers.slice(-1)[0];\n        const { config, configGroup } = layer;\n        webgis\n          .getLayerInfo({\n            serviceCode: config.serviceCode,\n            layerId: config.serverId,\n            epsgNum: configGroup.wkid,\n            extent: configGroup.extent\n          })\n          .then((res) => {\n            this.$webgis.formatEsriJSON.readFeatures(res).map((item) => {\n              const properties = item.getProperties();\n              const key = properties.XZQDM || properties.DJQDM;\n              if (key) {\n                regionListFeatureHash[key] = item;\n              }\n            });\n            return regionListFeatureHash;\n          });\n      }\n    }\n  }\n};\n</script>\n\n<style lang=\"scss\" scoped>\n@import '../../../styles/common-variables';\n\n.webgis-region-list {\n  width: 300px;\n  max-height: 380px;\n  overflow-y: auto;\n  &_item {\n    display: flex;\n    margin-bottom: $spacing-base;\n    .el-button {\n      padding: 0;\n    }\n    &-left {\n      flex: none;\n      width: 60px;\n      margin-right: $spacing-base;\n      .el-button {\n        font-weight: bold;\n        font-size: $font-size-small;\n        white-space: normal;\n        width: 100%;\n        line-height: 1.3;\n        text-align: left;\n      }\n    }\n    &-right {\n      display: flex;\n      flex-wrap: wrap;\n    }\n    &-right-item {\n      margin: 0 $spacing-base/2 $spacing-base/2 0;\n    }\n    &__empty {\n      text-align: center;\n      padding: $spacing-large;\n      color: $color-text-secondary;\n    }\n  }\n}\n</style>\n","/**\n * 清理地图上的要素与信息框\n * @example\n * ```\n * import controlsClean from './controls-clean';\n *\n * export default {\n *   mixins: [controlsClean], // 加入\n *   methods: {\n *     doSomeThing() {\n *       this.clean(); // 执行清理\n *     }\n *   }\n * }\n * ```\n */\nimport { privateEventHubInject } from './private-event-hub';\nimport { webgisInject } from './webgis-init';\n\nexport default {\n  mixins: [privateEventHubInject, webgisInject],\n  methods: {\n    clear() {\n      this.$eventHub.$emit('clear');\n    }\n  }\n};\n","/**\n * 1. 要素拾取的激活状态切换\n * 2. 监听要素拾取的结果并传递给 modal 进行展示信息（逻辑在 afterInitWebgis 中）\n * @example\n * ```\n * import controlsFeatureSelect from './controls-feature-select';\n *\n * export default {\n *   mixins: [controlsFeatureSelect], // 加入\n *   methods: {\n *     doSomeThing() {\n *       this.featureSelectToggle(true); // 激活要素拾取\n *       this.featureSelectToggle(false); // 关闭要素拾取\n *     }\n *   }\n * }\n * ```\n */\nimport { privateEventHubInject } from './private-event-hub';\nimport { webgisInject } from './webgis-init';\nimport { errorMessage } from '../utils/error-handler';\n\nexport default {\n  mixins: [privateEventHubInject, webgisInject],\n  data() {\n    return {\n      featureSelectActive: false\n    };\n  },\n  methods: {\n    featureSelectToggle(state = !this.featureSelectActive) {\n      this.featureSelectActive = state;\n      this.$webgis.modules.featureSelect.toggleActive(state);\n    },\n    /**\n     * 这里监听要素拾取事件\n     */\n    afterInitWebgis() {\n      const featureSelect = this.$webgis.modules.featureSelect;\n      featureSelect.on('end', (res) => {\n        if (res.state) {\n          const featureData = res.data;\n          if (featureData.length) {\n            this.featureSelectToggle(false);\n            this.$eventHub.$emit('changeModal', 'attribute-info', featureData);\n          } else {\n            this.$message.info('暂无数据');\n            this.$eventHub.$emit('changeModal');\n          }\n        } else {\n          errorMessage(res.message);\n          this.$eventHub.$emit('changeModal');\n        }\n      });\n      featureSelect.on('select', (BSM) =>\n        this.$eventHub.$emit('featureSelectItem', BSM)\n      );\n    }\n  },\n  created() {\n    this.$eventHub.$on('featureSelectToggle', this.featureSelectToggle);\n  },\n  beforeDestroy() {\n    this.$eventHub.$off('featureSelectToggle', this.featureSelectToggle);\n\n    // off listener\n    if (this.$webgis) {\n      const featureSelect = this.$webgis.modules.featureSelect;\n      featureSelect.offAll();\n    }\n  }\n};\n","import Vue from 'vue';\n\nexport default new Vue();\n","/**\n * 分屏状态切换\n * @example\n * ```\n * import splitScreenToggle from './split-screen-toggle';\n *\n * export default {\n *   mixins: [splitScreenToggle], // 加入\n *   methods: {\n *     doSomeThing() {\n *       this.splitScreenToggle(); // 进行切换\n *     }\n *   }\n * }\n * ```\n */\nimport eventHub from '../utils/event-hub';\n\nexport default {\n  methods: {\n    splitScreenToggle() {\n      eventHub.$emit('splitScreenToggle');\n    }\n  }\n};\n","<template>\n  <div\n    class=\"webgis-top-tools webgis-box-shadow-default webgis-absolute-layer flex-center-justify\"\n  >\n    <!-- 辖区 要素拾取 工具 分屏 基础量算 -->\n    <el-popover placement=\"bottom-start\" trigger=\"click\">\n      <RegionList />\n      <el-button\n        slot=\"reference\"\n        class=\"webgis-top-tools__item\"\n        icon=\"el-icon-s-grid\"\n      >\n        辖区\n      </el-button>\n    </el-popover>\n\n    <span class=\"webgis-top-tools__divider\"></span>\n    <el-button\n      @click=\"featureSelectToggle()\"\n      class=\"webgis-top-tools__item\"\n      icon=\"el-icon-place\"\n      :class=\"{ active: featureSelectActive }\"\n    >\n      要素拾取\n    </el-button>\n    <span class=\"webgis-top-tools__divider\"></span>\n    <el-dropdown @command=\"toolsHandle\" trigger=\"click\" size=\"small\">\n      <el-button class=\"webgis-top-tools__item\" icon=\"el-icon-setting\">\n        工具\n      </el-button>\n      <el-dropdown-menu slot=\"dropdown\">\n        <el-dropdown-item command=\"measure\" icon=\"el-icon-place\">\n          测量\n        </el-dropdown-item>\n        <el-dropdown-item command=\"screenshots\" icon=\"el-icon-crop\">\n          截屏\n        </el-dropdown-item>\n        <el-dropdown-item\n          command=\"rolling-screen\"\n          icon=\"el-icon-ice-cream-square\"\n        >\n          卷帘\n        </el-dropdown-item>\n      </el-dropdown-menu>\n    </el-dropdown>\n    <span class=\"webgis-top-tools__divider\"></span>\n    <el-button\n      @click=\"splitScreenToggle()\"\n      class=\"webgis-top-tools__item\"\n      icon=\"el-icon-menu\"\n    >\n      分屏\n    </el-button>\n    <span class=\"webgis-top-tools__divider\"></span>\n    <el-button\n      @click=\"\n        clear();\n        $webgis.clear();\n      \"\n      class=\"webgis-top-tools__item\"\n      icon=\"el-icon-delete\"\n    >\n      清理\n    </el-button>\n  </div>\n</template>\n\n<script>\nimport RegionList from './region-list';\nimport controlsClean from '../../../mixins/controls-clean';\nimport controlsFeatureSelect from '../../../mixins/controls-feature-select';\nimport splitScreenToggle from '../../../mixins/split-screen-toggle';\nimport { privateEventHubInject } from '../../../mixins/private-event-hub';\nimport { webgisInject } from '../../../mixins/webgis-init';\n\nexport default {\n  name: 'WebGISTopTools',\n  mixins: [\n    webgisInject,\n    controlsClean,\n    controlsFeatureSelect,\n    splitScreenToggle,\n    privateEventHubInject\n  ],\n  components: {\n    RegionList\n  },\n  methods: {\n    toolsHandle(command) {\n      switch (command) {\n        case 'measure':\n          this.$eventHub.$emit('changeModal', 'measure-select');\n          break;\n        case 'screenshots':\n          this.$webgis.exportImage();\n          break;\n        case 'rolling-screen':\n          this.$eventHub.$emit('changeModal', 'layer-swipe');\n          break;\n        default:\n      }\n    }\n  }\n};\n</script>\n\n<style lang=\"scss\" scoped>\n@import '../../../styles/common-variables';\n\n.webgis-top-tools {\n  display: flex;\n  align-items: center;\n  top: 10px;\n  right: 10px;\n  background: white;\n  border-radius: 4px;\n  height: 32px;\n  &__item {\n    font-size: $font-size-small;\n    padding: 8px;\n    border: none;\n    background-color: transparent;\n    color: inherit;\n    &:hover,\n    &:active,\n    &.active {\n      color: $color-primary;\n    }\n  }\n  &__divider {\n    height: 1em;\n    border-left: 1px dashed #ddd;\n  }\n}\n</style>\n","<template>\n  <ul\n    :style=\"{ height }\"\n    class=\"webgis-combined-search-list webgis-list-unstyled webgis-scrollbar-default\"\n  >\n    <li\n      v-for=\"item in visibleData\"\n      :key=\"item.value\"\n      :class=\"{ active: value === item.value }\"\n      @click=\"value !== item.value && $emit('change', item.value)\"\n    >\n      {{ item.label }}\n    </li>\n    <li class=\"is-empty\" v-if=\"!data.length\">（无数据）</li>\n  </ul>\n</template>\n\n<script>\nexport default {\n  name: 'WebGISCombinedSearchList',\n  model: {\n    prop: 'value',\n    event: 'change'\n  },\n  props: {\n    data: {\n      type: Array,\n      default() {\n        return [];\n      }\n    },\n    keyword: String,\n    height: {\n      type: String,\n      default: '60px'\n    },\n    value: [String, Number]\n  },\n  computed: {\n    visibleData() {\n      const keyword = this.keyword;\n      if (keyword) {\n        return this.data.filter((item) => item.label.includes(keyword));\n      } else {\n        return this.data;\n      }\n    }\n  }\n};\n</script>\n\n<style lang=\"scss\" scoped>\n@import '../../../../styles/common-variables';\n\n.webgis-combined-search-list {\n  border: $border-base;\n  border-radius: $border-radius-base;\n  padding: 4px;\n  overflow-y: auto;\n  > li {\n    user-select: none;\n    height: 16px;\n    line-height: 16px;\n    padding: 0 4px;\n    border-radius: inherit;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n    &:hover {\n      background-color: rgba(0, 0, 0, 0.05);\n    }\n    &.active {\n      background-color: rgba(0, 0, 0, 0.1);\n    }\n    &.is-empty {\n      color: $color-text-secondary;\n      &:hover {\n        background-color: inherit;\n      }\n    }\n  }\n}\n</style>\n","<template>\n  <div class=\"webgis-combined-search-keyboard\">\n    <template v-for=\"(item, index) in keyboardData\">\n      <span class=\"keyboard-group-wrap\" v-if=\"Array.isArray(item)\" :key=\"index\">\n        <el-button\n          v-for=\"subItem in item\"\n          size=\"mini\"\n          :key=\"subItem\"\n          @click=\"$emit('input', subItem)\"\n          >{{ subItem }}</el-button\n        >\n      </span>\n      <el-button\n        v-else\n        size=\"mini\"\n        :key=\"index\"\n        @click=\"$emit('input', item)\"\n        >{{ item }}</el-button\n      >\n    </template>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: 'WebgisCombinedSearchKeyboard',\n  data() {\n    return {\n      keyboardData: [\n        '=',\n        '<>',\n        'Like',\n        '>',\n        '>=',\n        'And',\n        '<',\n        '<=',\n        'Or',\n        ['?', '*'],\n        '()',\n        'Not',\n        'Is'\n      ]\n    };\n  }\n};\n</script>\n\n<style lang=\"scss\" scoped>\n@import '../../../../styles/common-variables';\n\n.webgis-combined-search-keyboard {\n  margin-right: $spacing-base * 1.5;\n  width: 40%;\n  flex: none;\n  display: flex;\n  justify-content: space-between;\n  flex-wrap: wrap;\n  $keyboardBtnWidth: 28%;\n  $keyboardHeight: 20px;\n  .el-button {\n    width: $keyboardBtnWidth;\n    height: $keyboardHeight;\n    padding: 0;\n    margin: 0 0 $spacing-base 0;\n    &.extra-mini {\n      width: 13%;\n    }\n  }\n  .keyboard-group-wrap {\n    width: $keyboardBtnWidth;\n    height: $keyboardHeight;\n    display: flex;\n    justify-content: space-between;\n    .el-button {\n      width: 45%;\n      height: 100%;\n    }\n  }\n}\n</style>\n","<template>\n  <div class=\"webgis-combined-search\" v-loading=\"loading\">\n    <div class=\"webgis-combined-search__layer webgis-combined-search__block\">\n      <label>图层：</label>\n      <ElSelectTree\n        v-model=\"layer\"\n        placeholder=\"请选择图层\"\n        :popover-min-width=\"174\"\n        :props=\"treeNodesProps\"\n        :data=\"treeNodes\"\n        @change=\"layerChange\"\n      />\n    </div>\n    <div class=\"webgis-combined-search__field webgis-combined-search__block\">\n      <label>字段：</label>\n      <CombinedSearchList\n        v-model=\"field\"\n        :data=\"fieldData\"\n        @change=\"fieldChange\"\n      />\n    </div>\n    <div class=\"webgis-combined-search__value webgis-combined-search__block\">\n      <CombinedSearchKeyboard @input=\"updateSQLWhere\" />\n      <div class=\"webgis-combined-search__value-list-wrap\">\n        <CombinedSearchList\n          v-model=\"value\"\n          height=\"104px\"\n          :keyword=\"valueKeyword\"\n          :data=\"valueData\"\n          @change=\"valueChange\"\n        />\n        <div class=\"webgis-combined-search__value-filter\">\n          <label>查找：</label>\n          <el-input\n            clearable\n            size=\"mini\"\n            v-model=\"valueKeyword\"\n            placeholder=\"关键字\"\n          ></el-input>\n        </div>\n      </div>\n    </div>\n    <div class=\"webgis-combined-search__where webgis-combined-search__block\">\n      <label>SELECT * FROM {{ selectedLayer.letter || '[LAYER]' }} WHERE</label>\n      <el-input\n        v-model=\"SQLWhere\"\n        resize=\"none\"\n        size=\"mini\"\n        type=\"textarea\"\n      ></el-input>\n    </div>\n    <div class=\"webgis-combined-search__btn webgis-combined-search__block\">\n      <el-button @click=\"reset()\" size=\"mini\" :disabled=\"!SQLWhere\"\n        >重置</el-button\n      >\n      <el-button @click=\"checkSQLWhere()\" size=\"mini\" :disabled=\"!checkParams\"\n        >校验</el-button\n      >\n      <el-button\n        @click=\"enter()\"\n        type=\"primary\"\n        :disabled=\"!checkParams\"\n        size=\"mini\"\n        >确认</el-button\n      >\n      <el-button @click=\"close()\" size=\"mini\">关闭</el-button>\n    </div>\n  </div>\n</template>\n\n<script>\nimport ElSelectTree from 'el-select-tree';\n\nimport { checkValidArray } from '../../../../utils/check-array';\nimport CombinedSearchList from './list';\nimport CombinedSearchKeyboard from './keyboard';\nimport { webgisInject } from '../../../../mixins/webgis-init';\n\nexport default {\n  name: 'WebGISCombinedSearch',\n  mixins: [webgisInject],\n  components: {\n    ElSelectTree,\n    CombinedSearchList,\n    CombinedSearchKeyboard\n  },\n  data() {\n    return {\n      loading: false,\n      layer: '',\n      field: '',\n      value: '',\n      valueKeyword: '',\n      SQLWhere: '',\n      treeNodes: [],\n      treeNodesProps: {\n        value: 'id',\n        label: 'name',\n        children: 'children'\n      },\n      fieldData: [],\n      valueData: []\n    };\n  },\n  computed: {\n    selectedLayer() {\n      return (\n        this.$webgis.treeLayers.find((item) => item.id === this.layer) || {}\n      );\n    },\n    checkParams() {\n      return this.layer && this.SQLWhere;\n    }\n  },\n  methods: {\n    afterInitWebgis() {\n      this.treeNodes = this.$webgis.treeNodes;\n    },\n    layerChange(layer) {\n      this.field = '';\n      this.value = '';\n      this.valueData = [];\n      this.loading = true;\n      this.$webgis\n        .getLayerField(layer)\n        .then((res) => (this.fieldData = res))\n        .finally(() => (this.loading = false));\n    },\n    fieldChange(field) {\n      this.updateSQLWhere(field);\n      this.value = '';\n      this.loading = true;\n      this.$webgis\n        .getLayerFieldValue(this.layer, field)\n        .then((res) => (this.valueData = res))\n        .finally(() => (this.loading = false));\n    },\n    valueChange(value) {\n      this.updateSQLWhere(value);\n    },\n    updateSQLWhere(text) {\n      this.SQLWhere += (this.SQLWhere ? ' ' : '') + text;\n    },\n    reset() {\n      this.layer = '';\n      this.field = '';\n      this.fieldData = [];\n      this.value = '';\n      this.valueData = [];\n      this.valueKeyword = '';\n      this.SQLWhere = '';\n    },\n    checkSQLWhere() {\n      this.loading = true;\n      this.$webgis\n        .getLayerInfo(\n          this.$webgis.getLayerInfoParams(this.layer, {\n            where: this.SQLWhere\n          })\n        )\n        .then(\n          () => this.$message.success('校验成功！'),\n          () => this.$message.error('校验失败！')\n        )\n        .finally(() => (this.loading = false));\n    },\n    enter() {\n      this.loading = true;\n      return this.$webgis\n        .searchFeature({\n          where: this.SQLWhere,\n          layerIds: [this.layer]\n        })\n        .then(\n          ({ features, data }) => {\n            if (checkValidArray(features) && checkValidArray(data)) {\n              this.$webgis.modules.featureSelect.updateFeatures(features);\n              this.$eventHub.$emit('changeModal', 'attribute-info', data);\n            } else {\n              this.$message.info('暂无数据');\n              this.$eventHub.$emit('changeModal');\n            }\n          },\n          () => this.$message.error('获取数据失败！')\n        )\n        .finally(() => (this.loading = false));\n    },\n    close() {\n      this.$emit('close');\n    }\n  }\n};\n</script>\n\n<style lang=\"scss\" scoped>\n@import '../../../../styles/common-variables';\n\n.webgis-combined-search {\n  font-size: $font-size-extra-small;\n  &__block {\n    margin-bottom: $spacing-base;\n    &:last-of-type {\n      margin-bottom: 0;\n    }\n  }\n  &__layer {\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n  }\n  &__field {\n    .webgis-combined-search-list {\n      margin-top: $spacing-base;\n    }\n  }\n  &__value {\n    display: flex;\n  }\n\n  &__value-list-wrap {\n    flex: 1;\n    overflow: hidden;\n  }\n  &__value-filter {\n    margin-top: $spacing-base/1.5;\n    display: flex;\n    align-items: center;\n    .el-input {\n      flex: 1;\n    }\n  }\n  &__where {\n    text-align: left;\n    .el-textarea {\n      margin-top: $spacing-base/4;\n    }\n  }\n  &__btn {\n    margin-bottom: 0;\n    text-align: right;\n    .el-button {\n      padding: 6px 10px;\n      text-align: center;\n    }\n  }\n}\n</style>\n","<template>\n  <div class=\"webgis-top-search webgis-absolute-layer\">\n    <div class=\"webgis-top-search__left webgis-box-shadow-default\">\n      <el-input\n        :disabled=\"loading\"\n        size=\"small\"\n        v-model=\"keyword\"\n        clearable\n        placeholder=\"请输入关键字\"\n        @keyup.enter.native=\"search\"\n      ></el-input>\n      <el-button\n        :disabled=\"loading\"\n        @click=\"search\"\n        size=\"small\"\n        type=\"primary\"\n        :icon=\"searchIcon\"\n      ></el-button>\n    </div>\n    <el-popover\n      v-model=\"combinedSearchVisible\"\n      placement=\"bottom-end\"\n      width=\"270\"\n    >\n      <CombinedSearch @close=\"combinedSearchVisible = false\" />\n      <el-button\n        slot=\"reference\"\n        class=\"webgis-box-shadow-default\"\n        size=\"small\"\n      >\n        组合查询\n      </el-button>\n    </el-popover>\n  </div>\n</template>\n\n<script>\nimport { webgisInject } from '../../../mixins/webgis-init';\nimport { webgisPropsInject } from '../../../mixins/webgis-props';\nimport { checkValidArray } from '../../../utils/check-array';\nimport CombinedSearch from './combined-search/index';\n\nexport default {\n  name: 'WebGISTopSearch',\n  mixins: [webgisInject, webgisPropsInject],\n  components: {\n    CombinedSearch\n  },\n  data() {\n    return {\n      loading: false,\n      keyword: '',\n      combinedSearchVisible: false\n    };\n  },\n  computed: {\n    keywordSQL() {\n      const fields = this.searchRange.fields || [];\n      return fields\n        .map((item) => `${item} LIKE '%${this.keyword}%'`)\n        .join(' OR ');\n    },\n    searchRange() {\n      return this.webgisConfig.options.searchRange || {};\n    },\n    searchIcon() {\n      return `el-icon-${this.loading ? 'loading' : 'search'}`;\n    }\n  },\n  methods: {\n    search() {\n      this.loading = true;\n      this.$webgis\n        .searchFeature({\n          where: this.keywordSQL,\n          layerIds: this.searchRange.layers || []\n        })\n        .then(({ features, data }) => {\n          if (checkValidArray(features) && checkValidArray(data)) {\n            this.$webgis.modules.featureSelect.updateFeatures(features);\n            this.$eventHub.$emit('changeModal', 'attribute-info', data);\n          } else {\n            this.$message.info('暂无数据');\n            this.$eventHub.$emit('changeModal');\n          }\n        })\n        .finally(() => (this.loading = false));\n    }\n  }\n};\n</script>\n\n<style lang=\"scss\">\n.webgis-top-search input {\n  border-radius: 0;\n  border: 0;\n}\n</style>\n\n<style lang=\"scss\" scoped>\n@import '../../../styles/common-variables';\n\n.webgis-top-search {\n  display: flex;\n  top: 10px;\n  left: 10px;\n  &__left {\n    margin-right: $spacing-medium;\n  }\n  .el-input {\n    width: 180px;\n  }\n  .el-button {\n    border-radius: 0;\n    border: 0;\n    height: 32px;\n    vertical-align: top;\n  }\n}\n</style>\n","<template>\n  <div class=\"webgis-controls\">\n    <!-- 搜索 -->\n    <TopSearch />\n\n    <!-- 下拉工具 -->\n    <TopTools />\n\n    <!-- 操作类工具  -->\n    <AsideTools />\n  </div>\n</template>\n\n<script>\nimport AsideTools from './aside-tools';\nimport TopTools from './top-tools';\nimport TopSearch from './top-search';\nimport { webgisInject } from '../../../mixins/webgis-init';\n\nexport default {\n  name: 'WebGISControls',\n  mixins: [webgisInject],\n  components: {\n    AsideTools,\n    TopTools,\n    TopSearch\n  }\n};\n</script>\n\n<style lang=\"scss\" scoped>\n@import '../../../styles/common-variables';\n</style>\n","<template>\n  <div\n    class=\"webgis-modals-container webgis-box-shadow-default webgis-absolute-layer\"\n  >\n    <div class=\"webgis-modals-header\">\n      <span class=\"webgis-modals-header__title\">{{ title }}</span>\n      <el-button\n        @click=\"clear\"\n        class=\"webgis-modals-header__close\"\n        type=\"text\"\n        icon=\"el-icon-close\"\n      ></el-button>\n    </div>\n    <slot></slot>\n  </div>\n</template>\n\n<script>\nimport controlsClean from '../../../mixins/controls-clean';\n\nexport default {\n  name: 'WebGISModalsContainer',\n  mixins: [controlsClean],\n  props: {\n    title: {\n      type: String,\n      default: '标题'\n    }\n  }\n};\n</script>\n\n<style lang=\"scss\" scoped>\n@import '../../../styles/common-variables';\n\n.webgis-modals-container {\n  $width: 50%;\n  $max-width: 500px;\n  $height: 80%;\n  $max-height: 600px;\n  width: $width;\n  height: $height;\n  max-width: $max-width + 2px; // border 1px，width 需要 + 2\n  max-height: $max-height + 2px; // border 1px，width 需要 + 2\n  border: $border-base;\n  background-color: white;\n  right: 10px;\n  top: 60px;\n  font-size: $font-size-small;\n  white-space: nowrap;\n  display: flex;\n  flex-direction: column;\n  overflow: hidden;\n}\n.webgis-modals-header {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 5px $spacing-base;\n  border-bottom: $border-base;\n  &__title {\n    padding-left: 5px;\n    line-height: 1;\n    border-left: 3px solid $color-primary;\n  }\n  &__close.el-button {\n    font-size: $font-size-large;\n    padding: 0;\n  }\n}\n</style>\n","<template>\n  <ModalsContainer title=\"属性信息\" class=\"webgis-attribute-info\">\n    <div class=\"webgis-attribute-info__filter\">\n      <label>筛选条件</label>\n      <el-select\n        class=\"webgis-attribute-info__select\"\n        :value=\"filter\"\n        size=\"mini\"\n        placeholder=\"请选择\"\n      >\n        <el-option\n          v-for=\"item in filterData\"\n          :key=\"item.value\"\n          :label=\"item.label\"\n          :value=\"item.value\"\n        >\n        </el-option>\n      </el-select>\n    </div>\n    <div class=\"webgis-attribute-info__body\" v-if=\"selectedNode.id\">\n      <el-row class=\"webgis-attribute-info__content\">\n        <el-col class=\"webgis-attribute-info__tree\" :span=\"6\">\n          <el-tree\n            ref=\"tree\"\n            :data=\"data\"\n            :props=\"defaultProps\"\n            :current-node-key=\"selectedNode.id\"\n            node-key=\"id\"\n            default-expand-all\n            highlight-current\n            @node-click=\"selectItem\"\n          >\n            <template slot-scope=\"{ node, data }\">\n              <span class=\"webgis-attribute-info__tree-node\">\n                {{ data.name }}\n              </span>\n            </template>\n          </el-tree>\n        </el-col>\n        <el-col class=\"webgis-attribute-info__list\" :span=\"18\">\n          <ul v-if=\"selectedNode\">\n            <li\n              v-for=\"(value, key) in selectedNode.properties\"\n              :key=\"key\"\n              class=\"webgis-attribute-info__list-item\"\n            >\n              <label :title=\"key\" class=\"webgis-attribute-info__list-label\">\n                {{ key }}\n              </label>\n              <span class=\"webgis-attribute-info__list-text\">\n                {{ value }}\n              </span>\n            </li>\n          </ul>\n        </el-col>\n      </el-row>\n      <div class=\"webgis-attribute-info__footer\">\n        图元总数：\n        <span class=\"webgis-attribute-info__total-number\">\n          {{ selectedTotal }}\n        </span>\n      </div>\n    </div>\n  </ModalsContainer>\n</template>\n\n<script>\nimport ModalsContainer from '../components/modals-container';\nimport { webgisInject } from '../../../mixins/webgis-init';\nimport { privateEventHubInject } from '../../../mixins/private-event-hub';\nimport { checkValidArray } from '../../../utils/check-array';\n\nexport default {\n  name: 'WebGISModalsAttributeInfo',\n  mixins: [webgisInject, privateEventHubInject],\n  components: {\n    ModalsContainer\n  },\n  props: {\n    data: Array\n  },\n  data() {\n    return {\n      filter: 'all',\n      filterData: [\n        {\n          value: 'all',\n          label: '全部'\n        }\n      ],\n      defaultProps: {\n        children: 'children'\n      },\n      selectedNode: {}\n    };\n  },\n  computed: {\n    selectedTotal() {\n      let count = 0;\n      this.data.forEach((item) => {\n        item.children.forEach(() => {\n          count++;\n        });\n      });\n      return count;\n    }\n  },\n  methods: {\n    selectItem(data) {\n      if (data && data.properties) {\n        this.selectedNode = data;\n        this.$webgis.modules.featureSelect.selectFeature(data.properties.BSM);\n        this.$nextTick(() => this.$refs.tree.setCurrentKey(data.id));\n      }\n    },\n    selectFirst() {\n      if (checkValidArray(this.data)) {\n        this.selectItem(this.data[0].children[0]);\n      }\n    },\n    featureSelectItem(BSM) {\n      this.data.forEach((item) =>\n        this.selectItem(\n          item.children.find((item) => item.properties.BSM === BSM)\n        )\n      );\n    }\n  },\n  watch: {\n    data() {\n      this.selectFirst();\n    }\n  },\n  activated() {\n    this.selectFirst();\n  },\n  deactivated() {\n    const featureSelect = this.$webgis.modules.featureSelect;\n    featureSelect.deactivate();\n    this.$webgis.clearFeature();\n  },\n  created() {\n    this.$eventHub.$on('featureSelectItem', this.featureSelectItem);\n  },\n  beforeDestroy() {\n    this.$eventHub.$off('featureSelectItem', this.featureSelectItem);\n  }\n};\n</script>\n\n<style lang=\"scss\" scoped>\n@import '../../../styles/common-variables';\n\n.webgis-attribute-info {\n  $width: 50%;\n  $max-width: 400px;\n  $height: 80%;\n  $max-height: 600px;\n  $divider-background: #eee;\n  $footer-height: 33px;\n  width: $width;\n  height: $height;\n  max-width: $max-width + 2px; // border 1px，width 需要 + 2\n  max-height: $max-height + 2px; // border 1px，width 需要 + 2\n  &__filter {\n    padding: 5px 15px;\n    background-color: $divider-background;\n    border-bottom: $border-base;\n    display: flex;\n    align-items: center;\n  }\n  &__select {\n    margin-left: $spacing-base;\n  }\n  &__body {\n    flex: 1;\n    display: flex;\n    flex-direction: column;\n    overflow: auto;\n    padding-top: $footer-height;\n  }\n  &__content {\n    flex: 1;\n    height: 100%;\n    margin-top: -$footer-height;\n  }\n  &__content,\n  &__footer {\n    width: $max-width;\n  }\n  &__tree,\n  &__list {\n    height: 100%;\n    overflow-y: auto;\n  }\n  &__list {\n    line-height: 30px;\n  }\n  &__list-item {\n    border-bottom: $border-base;\n    display: flex;\n  }\n  &__list-label,\n  &__list-text {\n    padding: 0 10px;\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n  }\n  &__list-label {\n    width: 40%;\n    font-weight: bold;\n    color: rgb(67, 132, 212);\n    background: rgb(239, 245, 252);\n    border-right: $border-base;\n  }\n  &__list-text {\n    width: 60%;\n  }\n  &__tree {\n    border-right: $border-base;\n  }\n  &__tree-node {\n    font-size: $font-size-small;\n    overflow: hidden;\n    text-overflow: ellipsis;\n  }\n  &__footer {\n    padding: 0 $spacing-base;\n    height: $footer-height;\n    display: flex;\n    align-items: center;\n    background-color: $divider-background;\n    border-top: $border-base;\n    overflow: hidden;\n    text-overflow: ellipsis;\n  }\n  &__total-number {\n    color: green;\n    font-weight: bold;\n    font-size: medium;\n  }\n}\n</style>\n","<template>\n  <ModalsContainer :title=\"title\" class=\"modal-radio-toggle\">\n    <div class=\"modal-radio-toggle__body\">\n      <div class=\"modal-radio-toggle__form-group\">\n        <h4 v-if=\"subTitle\" class=\"modal-radio-toggle__label\">\n          {{ subTitle }}\n        </h4>\n        <el-radio-group\n          v-model=\"privateValue\"\n          @change=\"$emit('change', $event)\"\n        >\n          <el-radio\n            v-for=\"item in options\"\n            :key=\"item.label\"\n            :label=\"item.label\"\n          >\n            {{ item.name }}\n          </el-radio>\n        </el-radio-group>\n      </div>\n    </div>\n  </ModalsContainer>\n</template>\n\n<script>\nimport ModalsContainer from '../components/modals-container';\n\nexport default {\n  name: 'WebGISModalsRadioToggle',\n  components: {\n    ModalsContainer\n  },\n  model: {\n    props: 'value',\n    event: 'change'\n  },\n  props: {\n    title: String,\n    subTitle: String,\n    value: [String, Number],\n    options: Array // example: [{ name, label }]\n  },\n  data() {\n    return {\n      privateValue: this.value\n    };\n  },\n  watch: {\n    value() {\n      this.privateValue = this.value;\n    }\n  }\n};\n</script>\n\n<style lang=\"scss\">\n@import '../../../styles/common-variables';\n\n.modal-radio-toggle {\n  .el-radio__label {\n    font-size: $font-size-small;\n  }\n}\n</style>\n\n<style lang=\"scss\" scoped>\n@import '../../../styles/common-variables';\n\n.modal-radio-toggle {\n  width: auto;\n  height: auto;\n  font-size: $font-size-small;\n  &__body {\n    padding: 0 $spacing-base;\n  }\n  &__form-group {\n    display: flex;\n    align-items: center;\n    margin: $spacing-base 0;\n    .el-radio {\n      line-height: 18px;\n    }\n  }\n  &__label {\n    color: gray;\n    margin-right: $spacing-base;\n  }\n  &__text {\n  }\n}\n</style>\n","<template>\n  <ModalsRadioToggle\n    title=\"测量\"\n    sub-title=\"方式：\"\n    :options=\"types\"\n    v-model=\"type\"\n    @change=\"typeChange\"\n    class=\"modal-measure\"\n  >\n  </ModalsRadioToggle>\n</template>\n\n<script>\nimport ModalsRadioToggle from '../components/modals-radio-toggle';\nimport { webgisInject } from '../../../mixins/webgis-init';\n\nexport default {\n  name: 'WebGISModalsMeasureSelect',\n  mixins: [webgisInject],\n  components: {\n    ModalsRadioToggle\n  },\n  data() {\n    return {\n      types: [\n        {\n          label: 'LineString',\n          name: '线条'\n        },\n        {\n          label: 'Polygon',\n          name: '面积'\n        }\n      ],\n      type: 'LineString'\n    };\n  },\n  methods: {\n    typeChange() {\n      this.$webgis.modules.measure.toggleActive(true, this.type);\n    }\n  },\n  activated() {\n    this.$webgis.modules.measure.activate(this.type);\n  },\n  deactivated() {\n    this.$webgis.modules.measure.deactivate();\n  }\n};\n</script>\n","<template>\n  <ModalsRadioToggle\n    title=\"卷帘\"\n    sub-title=\"方式：\"\n    :options=\"types\"\n    v-model=\"type\"\n    @change=\"typeChange\"\n    class=\"modal-measure\"\n  >\n  </ModalsRadioToggle>\n</template>\n\n<script>\nimport ModalsRadioToggle from '../components/modals-radio-toggle';\nimport { webgisInject } from '../../../mixins/webgis-init';\nimport { privateEventHubInject } from '../../../mixins/private-event-hub';\n\nexport default {\n  name: 'WebGISModalsMeasureSelect',\n  mixins: [webgisInject, privateEventHubInject],\n  components: {\n    ModalsRadioToggle\n  },\n  data() {\n    return {\n      types: [\n        {\n          label: 'vertical',\n          name: '横线'\n        },\n        {\n          label: 'horizontal',\n          name: '纵向'\n        }\n      ],\n      type: 'vertical'\n    };\n  },\n  methods: {\n    typeChange() {\n      this.$webgis.modules.layerSwipe.changeType(this.type);\n      this.$eventHub.$emit('rollingScreenToggleActive', true, this.type);\n    }\n  },\n  activated() {\n    this.$webgis.modules.layerSwipe.activate(this.type);\n    this.$eventHub.$emit('rollingScreenToggleActive', true, this.type);\n  },\n  deactivated() {\n    this.$webgis.modules.layerSwipe.deactivate();\n    this.$eventHub.$emit('rollingScreenToggleActive', false);\n  }\n};\n</script>\n","<template>\n  <transition name=\"webgis-transition-fade\">\n    <keep-alive>\n      <component :data=\"data\" :is=\"modal\" />\n    </keep-alive>\n  </transition>\n</template>\n\n<script>\nimport AttributeInfo from './attribute-info';\nimport MeasureSelect from './measure-select';\nimport LayerSwipe from './layer-swipe';\nimport { privateEventHubInject } from '../../mixins/private-event-hub';\n\n// 可用的 modal 列表\nconst modals = {\n  'attribute-info': AttributeInfo,\n  'measure-select': MeasureSelect,\n  'layer-swipe': LayerSwipe\n};\n\nexport default {\n  name: 'WebGISModals',\n  mixins: [privateEventHubInject],\n  components: {\n    ...modals\n  },\n  data() {\n    return {\n      data: null,\n      modal: ''\n    };\n  },\n  methods: {\n    changeModal(modal, data) {\n      this.data = data;\n      this.modal = modal;\n    }\n  },\n  created() {\n    this.$eventHub.$on(['changeModal', 'clear'], this.changeModal);\n  },\n  beforeDestroy() {\n    this.$eventHub.$off(['changeModal', 'clear'], this.changeModal);\n  }\n};\n</script>\n","<template>\n  <div\n    class=\"webgis-rolling-screen\"\n    :class=\"{ 'webgis-rolling-screen_horizontal': type === 'horizontal' }\"\n  >\n    <div\n      :style=\"lineStyle\"\n      class=\"webgis-rolling-screen__line webgis-absolute-layer\"\n    ></div>\n    <!-- vertical：与地图的裁剪布局相反，所以取相反值 -->\n    <el-slider\n      class=\"webgis-rolling-screen__slider webgis-absolute-layer\"\n      v-model=\"privateValue\"\n      @input=\"$emit('input', privateValue)\"\n      :vertical=\"type === 'horizontal'\"\n      :show-tooltip=\"false\"\n    >\n    </el-slider>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: 'WebGISRollingScreen',\n  props: {\n    type: String, // vertical/horizontal\n    value: Number\n  },\n  data() {\n    return {\n      privateValue: this.value\n    };\n  },\n  computed: {\n    lineStyle() {\n      const value = this.privateValue + '%';\n      return this.type === 'vertical' ? { left: value } : { bottom: value };\n    }\n  },\n  watch: {\n    value() {\n      this.privateValue = this.value;\n    }\n  }\n};\n</script>\n\n<style lang=\"scss\">\n// 覆盖 element-ui 样式\n.webgis-rolling-screen {\n  &__slider {\n    .el-slider__runway,\n    .el-slider__bar {\n      margin: 0;\n      height: 0;\n      background: none;\n    }\n  }\n}\n</style>\n\n<style lang=\"scss\" scoped>\n@import '../../../styles/common-variables';\n\n.webgis-rolling-screen {\n  &__line {\n    height: 100%;\n    width: 1px;\n    background: $color-primary;\n    z-index: 0;\n    left: 0;\n  }\n  &__slider {\n    position: absolute !important;\n    width: 100%;\n    top: 50%;\n    left: 0;\n    transform: translate(0, -50%);\n    z-index: 0;\n  }\n  &.webgis-rolling-screen_horizontal {\n    .webgis-rolling-screen__line {\n      height: 1px;\n      width: 100%;\n    }\n    .webgis-rolling-screen__slider {\n      width: auto;\n      height: 100%;\n      top: 0;\n      left: 50%;\n      transform: translate(-50%, 0);\n    }\n  }\n}\n</style>\n","<template>\n  <div class=\"webgis-container\" v-loading=\"!webgisReady\">\n    <!-- map -->\n    <Map\n      :modules=\"webgisConfig.modules\"\n      :options=\"webgisConfig.options\"\n      :show-controls=\"webgisConfig.showControls\"\n      :controls=\"webgisConfig.controls\"\n      @init=\"initWebgis\"\n    />\n\n    <!-- slot -->\n    <div v-if=\"$slots.aside\" class=\"webgis-slot\">\n      <slot name=\"aside\"></slot>\n    </div>\n\n    <!-- aside -->\n    <div class=\"webgis-aside-wrapper\">\n      <transition name=\"webgis-transition-slide\">\n        <Aside v-if=\"webgisConfig.showAside\" />\n      </transition>\n    </div>\n\n    <!-- main -->\n    <div class=\"webgis-main\">\n      <!-- controls -->\n      <transition name=\"webgis-transition-fade\">\n        <keep-alive>\n          <Controls v-if=\"webgisConfig.showControls && $webgis\" />\n        </keep-alive>\n      </transition>\n    </div>\n\n    <!-- rolling-screen -->\n    <RollingScreen\n      @input=\"rollingScreenChange\"\n      :type=\"rollingScreen.type\"\n      :value=\"rollingScreen.value\"\n      v-if=\"rollingScreen.active\"\n    />\n\n    <!-- modals -->\n    <Modals />\n  </div>\n</template>\n\n<script>\nimport Map from '../map';\nimport Aside from './aside';\nimport Controls from './controls';\nimport Modals from '../modals';\nimport RollingScreen from './rolling-screen';\nimport { webgisProvide } from '../../mixins/webgis-init';\nimport { webgisPropsInject } from '../../mixins/webgis-props';\nimport { privateEventHubProvide } from '../../mixins/private-event-hub';\n\n/**\n * 默认的地图组件（单屏）\n * **privateEventHubProvide 用于子组件之间事件共享，不要去掉**\n */\nexport default {\n  name: 'WebGIS',\n  mixins: [webgisProvide, webgisPropsInject, privateEventHubProvide],\n  components: {\n    Map,\n    Aside,\n    Controls,\n    Modals,\n    RollingScreen\n  },\n  data() {\n    return {\n      showAside: false,\n      rollingScreen: {\n        active: false,\n        type: 'vertical', // vertical/horizontal\n        value: 50\n      }\n    };\n  },\n  methods: {\n    toggleAside(state = !this.webgisConfig.showAside) {\n      this.webgisConfig.showAside = state;\n    },\n    rollingScreenToggleActive(\n      state = !this.rollingScreen.active,\n      type = 'vertical'\n    ) {\n      this.rollingScreen.active = state;\n      this.rollingScreen.type = type;\n      if (state) {\n        this.rollingScreenChange();\n      }\n    },\n    afterInitWebgis() {\n      this.$eventHub.$on(\n        'rollingScreenToggleActive',\n        this.rollingScreenToggleActive\n      );\n      this.$eventHub.$on('clear', () => this.rollingScreenToggleActive(false));\n    },\n    rollingScreenChange(value = this.rollingScreen.value) {\n      this.rollingScreen.value = value;\n      this.$webgis.modules.layerSwipe.changeValue(value);\n    }\n  },\n  activated() {\n    this.$webgis && this.$webgis.updateSize();\n  },\n  mounted() {\n    this.$eventHub.$on('toggleAside', this.toggleAside);\n  },\n  beforeDestroy() {\n    this.$eventHub.$off('toggleAside', this.toggleAside);\n    this.$eventHub.$off(\n      'rollingScreenToggleActive',\n      this.rollingScreenToggleActive\n    );\n  }\n};\n</script>\n\n<style lang=\"scss\" scoped>\n@import '../../styles/common-variables';\n\n.webgis-container {\n  position: relative;\n  overflow: hidden;\n  height: 100%;\n  display: flex;\n}\n\n// 底层\n.webgis-map {\n  position: absolute;\n  width: 100%;\n  height: 100%;\n}\n\n// 覆盖层\n.webgis-slot,\n.webgis-aside {\n  position: relative;\n  flex: none;\n}\n\n// 覆盖层\n.webgis-main {\n  position: relative;\n  height: 0;\n  flex: 1;\n}\n</style>\n","/**\n * 分屏的方案\n * @description\n * key: 分屏的个数\n * value: {\n *   height: 对应每行高度\n *   spans: 对应每屏的 span 值（el-row，el-col布局）\n * }\n */\nexport default {\n  1: {\n    height: '100%',\n    spans: [24]\n  },\n  2: {\n    height: '100%',\n    spans: [12, 12]\n  },\n  3: {\n    height: '50%',\n    spans: [12, 12, 24]\n  },\n  4: {\n    height: '50%',\n    spans: [12, 12, 12, 12]\n  },\n  5: {\n    height: '50%',\n    spans: [8, 8, 8, 12, 12]\n  },\n  6: {\n    height: '50%',\n    spans: [8, 8, 8, 8, 8, 8]\n  }\n};\n","<template>\n  <div class=\"webgis-screen-common-header\">\n    <span class=\"webgis-screen-common-header__title\">\n      {{ title }}\n    </span>\n    <slot></slot>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: 'WebGISSplitScreenCommonHeader',\n  props: {\n    title: String\n  }\n};\n</script>\n\n<style lang=\"scss\" scoped>\n@import '../../../styles/common-variables';\n\n.webgis-screen-common-header {\n  padding: 0 10px;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  background-color: $color-blue;\n  &__title {\n    color: white;\n    font-size: $font-size-small;\n    flex: 1;\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n  }\n  .el-button {\n    color: white;\n    font-size: $font-size-medium;\n    margin-left: 6px;\n    &:hover {\n      color: $color-primary;\n    }\n  }\n}\n</style>\n","<template>\n  <CommonHeader :title=\"title\" class=\"webgis-split-screen-header\">\n    <div\n      v-if=\"webgisReady && $webgis\"\n      class=\"webgis-split-screen-header__btn-group\"\n    >\n      <el-button type=\"text\" icon=\"el-icon-search\"></el-button>\n      <el-button\n        @click=\"$webgis.interactions.zoom.change('zoom-in')\"\n        type=\"text\"\n        icon=\"el-icon-zoom-in\"\n      ></el-button>\n      <el-button\n        @click=\"$webgis.interactions.zoom.change('zoom-out')\"\n        type=\"text\"\n        icon=\"el-icon-zoom-out\"\n      ></el-button>\n      <el-button\n        @click=\"$webgis.interactions.zoom.change('revert')\"\n        type=\"text\"\n        icon=\"el-icon-refresh-right\"\n      ></el-button>\n      <el-button\n        @click=\"featureSelectToggle()\"\n        type=\"text\"\n        icon=\"el-icon-thumb\"\n      ></el-button>\n      <el-button @click=\"clear()\" type=\"text\" icon=\"el-icon-delete\"></el-button>\n    </div>\n  </CommonHeader>\n</template>\n\n<script>\nimport controlsClean from '../../../mixins/controls-clean';\nimport controlsFeatureSelect from '../../../mixins/controls-feature-select';\nimport CommonHeader from '../components/common-header';\n\nexport default {\n  name: 'WebGISSplitScreenHeader',\n  mixins: [controlsClean, controlsFeatureSelect],\n  props: {\n    title: String\n  },\n  components: {\n    CommonHeader\n  }\n};\n</script>\n\n<style lang=\"scss\" scoped>\n@import '../../../styles/common-variables';\n\n.webgis-split-screen-header {\n  height: 43px;\n}\n</style>\n","<template>\n  <div\n    class=\"webgis-screen-list-item webgis-box-shadow-base\"\n    v-loading=\"!webgisReady\"\n  >\n    <ScreenHeader\n      :title=\"data.layer.name || '未选择图层'\"\n      class=\"webgis-screen-list-item__header\"\n    />\n    <Map\n      :modules=\"webgisConfig.modules\"\n      :options=\"currentOptions\"\n      :show-controls=\"false\"\n      :controls=\"[]\"\n      @init=\"initWebgis\"\n    />\n    <Modals class=\"webgis-screen-list-item__attribute-info\" />\n  </div>\n</template>\n\n<script>\nimport ScreenHeader from '../screen-header';\nimport { webgisProvide } from '../../../mixins/webgis-init';\nimport Map from '../../map';\nimport Modals from '../../modals';\nimport { privateEventHubProvide } from '../../../mixins/private-event-hub';\nimport { webgisPropsInject } from '../../../mixins/webgis-props';\n\nexport default {\n  name: 'WebGISSplitScreenListItem',\n  mixins: [webgisProvide, privateEventHubProvide, webgisPropsInject],\n  components: {\n    Map,\n    ScreenHeader,\n    Modals\n  },\n  props: {\n    data: Object\n  },\n  computed: {\n    currentOptions() {\n      const layer = this.data.layer;\n      return {\n        ...this.webgisConfig.options,\n        showLayers: layer.config && layer.config.name\n      };\n    }\n  }\n};\n</script>\n\n<style lang=\"scss\" scoped>\n@import '../../../styles/common-variables';\n\n.webgis-screen-list-item {\n  position: relative;\n  overflow: hidden;\n  $header-height: 42px;\n  height: 100%;\n  padding-top: $header-height;\n  &__header {\n    margin-top: -$header-height;\n  }\n  &__webgis {\n    border: $border-base;\n  }\n  &__attribute-info {\n    top: $header-height + $spacing-base;\n  }\n}\n</style>\n","<template>\n  <div class=\"webgis-screen-list\">\n    <el-row\n      v-for=\"(data, index1) in splitScreenData\"\n      :key=\"index1\"\n      :gutter=\"10\"\n      :style=\"{ height: currentScreenPlan.height }\"\n      class=\"webgis-screen-list__row\"\n    >\n      <el-col\n        class=\"webgis-screen-list__col\"\n        :span=\"item.span\"\n        :key=\"item.id\"\n        v-for=\"item in data\"\n      >\n        <ScreenListItem @init=\"webgisInit(item.id, $event)\" :data=\"item\" />\n      </el-col>\n    </el-row>\n  </div>\n</template>\n\n<script>\nimport chunk from 'lodash/chunk';\n\nimport screenPlan from '../screen-plan';\nimport ScreenListItem from './list-item';\n\nexport default {\n  name: 'WebGISSplitScreenList',\n  components: {\n    ScreenListItem\n  },\n  props: {\n    screenData: Array\n  },\n  data: function() {\n    return {\n      webgisList: {}\n    };\n  },\n  computed: {\n    splitScreenData() {\n      const spans = this.currentScreenPlan.spans;\n      if (spans) {\n        const data = this.screenActivedData;\n        data.forEach((item, index) => {\n          item.span = spans[index];\n        });\n        return chunk(data, data.length >= 5 ? 3 : 2);\n      } else {\n        return [];\n      }\n    },\n    screenActivedData() {\n      return this.screenData.filter((item) => item.show);\n    },\n    currentScreenPlan() {\n      return screenPlan[this.screenActivedData.length] || {};\n    }\n  },\n  methods: {\n    /**\n     * webgis 初始化\n     * @description\n     * 在分屏列表全部加载完毕时，向上级触发 `webgisReady` 事件。\n     */\n    webgisInit(id, webgis) {\n      if (webgis) {\n        this.webgisList[id] = webgis;\n        const allReadyState = !this.screenActivedData.find(\n          (item) => !this.webgisList[item.id]\n        );\n        if (allReadyState) {\n          this.$emit('webgisReady', this.webgisList);\n        }\n        // 绑定移动缩放事件，同步所有的分屏\n        if (!webgis._bindMoveend) {\n          webgis._bindMoveend = webgis.olMap.on('moveend', () => {\n            webgis.interactions.zoom.syncMapsMove(\n              Object.values(this.webgisList).filter(\n                (item) => item.id !== webgis.id\n              )\n            );\n          });\n        }\n      }\n    },\n    updateSize() {\n      this.$nextTick(function() {\n        this.screenActivedData.forEach((data) => {\n          const webgis = this.webgisList[data.id];\n          webgis && webgis.updateSize();\n        });\n      });\n    }\n  },\n  watch: {\n    // 监听激活的分屏列表，更新 webgisList 与 updateSize\n    screenActivedData(newVal) {\n      const webgisList = this.webgisList;\n      // 释放内存\n      Object.keys(webgisList).forEach((key) => {\n        if (!newVal.find((item) => item.id === +key)) {\n          delete webgisList[key];\n        }\n      });\n      this.updateSize();\n    }\n  }\n};\n</script>\n\n<style lang=\"scss\" scoped>\n@import '../../../styles/common-variables';\n\n.webgis-screen-list {\n  height: 100%;\n  &__row {\n    padding-bottom: $spacing-base;\n  }\n  &__col {\n    height: 100%;\n  }\n}\n</style>\n","<template>\n  <div class=\"webgis-screen-setting webgis-box-shadow-base\">\n    <CommonHeader title=\"分屏展示\">\n      <el-button\n        @click=\"splitScreenToggle()\"\n        class=\"webgis-screen-setting__close\"\n        type=\"text\"\n        icon=\"el-icon-close\"\n      ></el-button>\n    </CommonHeader>\n    <div class=\"webgis-screen-setting__body\">\n      <h3 class=\"webgis-screen-setting__title\">设置屏数</h3>\n      <div class=\"webgis-screen-setting__number\">\n        <span class=\"webgis-screen-setting__label\">\n          屏数选择\n        </span>\n        <el-select\n          class=\"webgis-screen-setting__select\"\n          @change=\"$emit('changeScreenLen', number)\"\n          v-model=\"number\"\n          :value=\"number\"\n          size=\"mini\"\n          placeholder=\"请选择\"\n        >\n          <el-option\n            v-for=\"item in numberData\"\n            :key=\"item\"\n            :label=\"item\"\n            :value=\"item\"\n          >\n          </el-option>\n        </el-select>\n      </div>\n      <div class=\"webgis-screen-setting__view\">\n        <span class=\"webgis-screen-setting__label\">\n          分屏视图\n        </span>\n        <ul class=\"webgis-screen-setting__view-list webgis-list-unstyled\">\n          <li\n            class=\"webgis-screen-setting__view-list-item\"\n            v-for=\"(item, index) in screenData\"\n            :key=\"index\"\n          >\n            <el-button\n              @click=\"$emit('changeScreenActive', index)\"\n              size=\"mini\"\n              :type=\"item.show ? 'primary' : ''\"\n            >\n              {{ index + 1 }}\n            </el-button>\n          </li>\n        </ul>\n      </div>\n      <h3 class=\"webgis-screen-setting__title\">选择图层</h3>\n      <ul class=\"webgis-screen-setting__layer webgis-list-unstyled\">\n        <li\n          class=\"webgis-screen-setting__layer-item\"\n          v-for=\"(data, index) in screenData\"\n          :key=\"index\"\n        >\n          <span class=\"webgis-screen-setting__layer-label\">\n            第{{ index + 1 }}屏\n          </span>\n          <el-select-tree\n            class=\"webgis-screen-setting__layer-select\"\n            size=\"mini\"\n            placeholder=\"请选择\"\n            width=\"177px\"\n            :value=\"data.layer.id\"\n            :data=\"layerTree\"\n            :props=\"{ value: 'id', label: 'name', children: 'children' }\"\n            @change=\"$emit('changeScreenLayer', index, $event)\"\n          >\n          </el-select-tree>\n        </li>\n      </ul>\n      <div class=\"webgis-screen-setting__footer\">\n        <el-button size=\"mini\" type=\"primary\">分屏展示</el-button>\n        <el-button @click=\"splitScreenToggle()\" size=\"mini\">取消</el-button>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport ElSelectTree from 'el-select-tree';\n\nimport CommonHeader from '../components/common-header';\nimport splitScreenToggle from '../../../mixins/split-screen-toggle';\n\nexport default {\n  name: 'WebGISSplitScreenSetting',\n  mixins: [splitScreenToggle],\n  components: { CommonHeader, ElSelectTree },\n  props: {\n    screenData: Array,\n    layerTree: Array\n  },\n  data() {\n    return {\n      number: this.screenData.length,\n      numberData: 6\n    };\n  }\n};\n</script>\n\n<style lang=\"scss\" scoped>\n@import '../../../styles/common-variables';\n\n.webgis-screen-setting {\n  $label-width: 65px;\n  $label-height: 28px;\n  font-size: $font-size-small;\n  &__body {\n    border: $border-base;\n    flex: 1;\n    padding: $spacing-base;\n  }\n  &__title {\n    margin-bottom: $spacing-base;\n  }\n  &__label {\n    display: inline-block;\n    width: $label-width;\n  }\n  &__number {\n    margin-bottom: $spacing-medium;\n    display: flex;\n    align-items: center;\n  }\n  &__select {\n    flex: 1;\n  }\n  &__view {\n    margin-bottom: $spacing-base;\n    display: flex;\n  }\n  $btn-size: 35px;\n  &__view-list {\n    display: flex;\n    flex-wrap: wrap;\n    width: 3 * ($btn-size + $spacing-base);\n  }\n  &__view-list-item {\n    margin-bottom: $spacing-base;\n    margin-right: $spacing-base;\n    .el-button {\n      width: $btn-size;\n      height: $btn-size;\n      padding: 0;\n    }\n  }\n  &__layer {\n    margin-bottom: $spacing-large;\n  }\n  &__layer-item {\n    margin-bottom: 5px;\n    display: flex;\n    justify-content: space-between;\n  }\n  &__layer-label {\n    background-color: $color-blue;\n    color: white;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    width: $label-width;\n    margin-right: 5px;\n    border-radius: $border-radius-base;\n  }\n  &__footer {\n    text-align: center;\n    margin-bottom: $spacing-medium;\n  }\n}\n</style>\n","<template>\n  <div class=\"webgis-split-screen\">\n    <ScreenList\n      ref=\"screenList\"\n      @webgisReady=\"webgisReady\"\n      :screen-data=\"screenData\"\n      class=\"webgis-split-screen__content\"\n    />\n    <ScreenSetting\n      :screen-data=\"screenData\"\n      :layer-tree=\"layerTree\"\n      @changeScreenLayer=\"changeScreenLayer\"\n      @changeScreenLen=\"changeScreenLen\"\n      @changeScreenActive=\"changeScreenActive\"\n      class=\"webgis-split-screen__setting\"\n    />\n  </div>\n</template>\n\n<script>\nimport ScreenList from './screen-list';\nimport ScreenSetting from './screen-setting';\n\n/**\n * 分屏组件\n */\nexport default {\n  name: 'WebGISSplitScreen',\n  components: {\n    ScreenList,\n    ScreenSetting\n  },\n  data() {\n    return {\n      screenData: [\n        {\n          id: 0,\n          show: true,\n          layer: {}\n        }\n      ],\n      layerData: [],\n      layerTree: []\n    };\n  },\n  methods: {\n    // 修改分屏的数量\n    changeScreenLen(number) {\n      const data = this.screenData;\n      while (number < data.length) {\n        this.screenData.pop();\n      }\n\n      while (number > data.length) {\n        data.push({\n          id: data.length,\n          show: true,\n          layer: {}\n        });\n      }\n    },\n    // 切换分屏的激活状态\n    changeScreenActive(index) {\n      this.screenData[index].show = !this.screenData[index].show;\n    },\n    // 修改分屏的专题\n    changeScreenLayer(index, id) {\n      this.screenData[index].layer = this.layerData.find(\n        (item) => item.id === id\n      );\n    },\n    // webgis ready 事件\n    webgisReady(webgisList) {\n      // 取第一个图层数据即可\n      if (!this.layerData.length) {\n        const webgis = webgisList[this.screenData[0].id];\n        this.layerTree = webgis.treeNodes;\n        this.layerData = webgis.treeLayers;\n      }\n\n      // 向上级发送分屏加载完毕\n      this.$emit(\n        'init-split-screen',\n        this.screenData.map((item) => ({\n          ...item,\n          webgis: webgisList[item.id]\n        }))\n      );\n    }\n  },\n  activated() {\n    this.$refs.screenList.updateSize();\n  }\n};\n</script>\n\n<style lang=\"scss\" scoped>\n@import '../../styles/common-variables';\n\n.webgis-split-screen {\n  display: flex;\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  padding: $spacing-base $spacing-base 0;\n  align-items: flex-start;\n  &__content {\n    flex: 1;\n  }\n  &__setting {\n    margin-left: $spacing-base;\n    margin-bottom: $spacing-base;\n    width: 260px;\n  }\n}\n</style>\n","<template>\n  <transition v-if=\"show\" name=\"webgis-transition-fade\" mode=\"out-in\">\n    <keep-alive>\n      <component\n        @init=\"$emit('init', $event)\"\n        @init-split-screen=\"$emit('init-split-screen', $event)\"\n        :is=\"component\"\n      >\n        <template v-if=\"$slots.aside\" #aside>\n          <slot name=\"aside\"></slot>\n        </template>\n      </component>\n    </keep-alive>\n  </transition>\n</template>\n\n<script>\nimport { webgisPropsProvide } from '../mixins/webgis-props';\nimport WebGIS from './webgis/index';\nimport SplitScreen from './split-screen';\nimport eventHub from '../utils/event-hub';\n\n/**\n * 中心组件（负责控制单屏/分屏的切换）\n */\nexport default {\n  name: 'WebGISMain',\n  mixins: [webgisPropsProvide],\n  components: {\n    WebGIS,\n    SplitScreen\n  },\n  data: function() {\n    return {\n      show: true,\n      splitScreenState: this.splitScreen\n    };\n  },\n  computed: {\n    component() {\n      return this.splitScreenState ? SplitScreen : WebGIS;\n    }\n  },\n  methods: {\n    splitScreenToggle(state = !this.splitScreenState) {\n      this.splitScreenState = state;\n      this.$emit('splitScreenToggle', state);\n    }\n  },\n  watch: {\n    splitScreen(newVal) {\n      this.splitScreenState = newVal;\n    },\n    'options.serviceCode'() {\n      // 修改服务 ID 强制重新加载地图\n      this.show = false;\n      this.$nextTick(() => (this.show = true));\n    }\n  },\n  created() {\n    eventHub.$on('splitScreenToggle', this.splitScreenToggle);\n  },\n  beforeDestroy() {\n    eventHub.$off('splitScreenToggle', this.splitScreenToggle);\n  }\n};\n</script>\n","<template>\n  <div class=\"webgis-diff-analysis\">\n    <div\n      class=\"webgis-diff-analysis__block webgis-diff-analysis__block_left\"\n      v-show=\"showResult\"\n    >\n      <div v-show=\"showResult\" class=\"webgis-diff-analysis__item\">\n        <h4 class=\"webgis-diff-analysis__name webgis-box-shadow-base\">\n          分析结果\n        </h4>\n        <WebGISMap\n          @init=\"initWebgis\"\n          :options=\"{ showLayers: webgisGroupPrivate.item1.id }\"\n          :show-controls=\"false\"\n          :modules=\"['DiffAnalysis']\"\n        />\n      </div>\n    </div>\n    <div\n      class=\"webgis-diff-analysis__block webgis-diff-analysis__block_right\"\n      :class=\"{ 'flex-column': showResult }\"\n    >\n      <div\n        v-for=\"(item, key) in webgisGroupPrivate\"\n        :key=\"key\"\n        class=\"webgis-diff-analysis__item\"\n      >\n        <h4 class=\"webgis-diff-analysis__name webgis-box-shadow-base\">\n          {{ item.name }}\n        </h4>\n        <WebGISMap\n          @init=\"webgisGroupInit(key, $event)\"\n          :options=\"{ showLayers: item.id }\"\n          :show-controls=\"false\"\n        />\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport WebGISMap from '../../src/components/map/index';\nimport { errorMessage } from '../../src/utils/error-handler';\n\n/**\n * 差异分析组件\n *\n * @prop {{id, name}[]} webgisGroup 待分析的地图列表，example: [{ id: \"X620102DC2019GDLTB\", name: \"城关区2019地类图斑\" }]\n *\n * @event webgisGroupInit(index, webgis) webgis 列表有地图完成了初始化\n * @event webgisResultInit(webgis) 展示结果的地图完成了初始化\n *\n * @method doAnalysis() 开始分析，返回 Promise 分析结果状态\n * @method updateFeature(index, features) 更新地图的 feature\n */\nexport default {\n  components: {\n    WebGISMap\n  },\n  props: {\n    /**\n     * webgis 待分析的地图列表\n     * @example: [{ id: \"X620102DC2019GDLTB\", name: \"城关区2019地类图斑\" }]\n     * @property {string} id 图层的 id\n     * @property {string} name 地图的名称\n     */\n    webgisGroup: {\n      type: Object,\n      default() {\n        return {};\n      }\n    }\n  },\n  data() {\n    return {\n      showResult: false,\n      // webgis 实例集合\n      webgis: {\n        item1: null,\n        item2: null\n      },\n      webgisResult: null\n    };\n  },\n  computed: {\n    // 收集所有的 webgis\n    allWebgis() {\n      const webgis = this.webgis;\n      return [webgis.item1, webgis.item2, this.webgisResult].filter(\n        (item) => item\n      );\n    },\n\n    // 有效的 webgisGroup\n    webgisGroupPrivate() {\n      const webgisGroup = this.webgisGroup;\n      const result = {};\n      let value;\n      for (const key in webgisGroup) {\n        if (webgisGroup.hasOwnProperty(key)) {\n          value = webgisGroup[key];\n          if (value) {\n            result[key] = value;\n          }\n        }\n      }\n      return result;\n    }\n  },\n  methods: {\n    // 开始分析，返回 Promise 分析结果状态\n    doAnalysis() {\n      const item1 = this.webgisGroup.item1;\n      const item2 = this.webgisGroup.item2;\n      if (item1.id && item2.id) {\n        const params = {\n          inputServiceCode: item1.id,\n          overlayServiceCode: item2.id\n        };\n        if (item1.field && item1.fieldValue) {\n          params.inputFilter = `${item1.field} = '${item1.fieldValue}'`;\n        }\n        if (item2.field && item2.fieldValue) {\n          params.overlayFilter = `${item2.field} = '${item2.fieldValue}'`;\n        }\n\n        return this.webgisResult.modules.diffAnalysis\n          .doAnalysis(params)\n          .then((res) => {\n            this.showResult = true;\n            this.updateSize();\n            return res;\n          });\n      } else {\n        const error = '对比分析：参数不全';\n        errorMessage(error);\n        return Promise.reject(error);\n      }\n    },\n\n    /**\n     * 更新地图的 feature\n     * @param {String} name webgis 名称 item1/2\n     * @param {FeatureLike[]} features example:{ features: [], attributes: [] }\n     */\n    updateFeature(name, features) {\n      const webgis = this.webgis[name];\n      webgis.renderFeatureData(features);\n    },\n\n    // 分析结果的 webgis 初始化\n    initWebgis(webgis) {\n      this.webgisResult = webgis;\n      this.$emit('webgisResultInit', webgis);\n      this.bindMoveend(webgis);\n      this.updateSize();\n      webgis.setLayerOpacity(this.webgisGroup.item1.id, 0);\n    },\n\n    // 其他选择图层的 webgis 初始化\n    webgisGroupInit(key, webgis) {\n      this.webgis[key] = webgis;\n      this.$emit('webgisGroupInit', key, webgis);\n      this.bindMoveend(webgis);\n      this.updateSize();\n    },\n\n    // 更新每一个屏的地图\n    updateSize() {\n      this.$nextTick(() => {\n        // 重置视图\n        this.webgis.item1 && this.webgis.item1.interactions.zoom.resetView();\n\n        // resize\n        this.allWebgis.forEach((item) => item.olMap.updateSize());\n      });\n    },\n\n    // 绑定移动缩放事件，同步所有的分屏\n    bindMoveend(webgis) {\n      if (!webgis._bindMoveend) {\n        webgis._bindMoveend = true;\n        webgis.olMap.on('moveend', () => {\n          webgis.interactions.zoom.syncMapsMove(\n            this.allWebgis.filter((item) => webgis.id !== item.id)\n          );\n        });\n      }\n    },\n\n    // 与 webgisGroup 同步，多余删除\n    syncWebgisList() {\n      const webgis = this.webgis;\n\n      if (!this.webgisGroup.item1) webgis.item1 = null;\n      if (!this.webgisGroup.item2) webgis.item2 = null;\n\n      if (this.webgisGroup.length !== 2) {\n        this.showResult = false;\n      }\n    }\n  },\n  watch: {\n    webgisGroup() {\n      this.updateSize();\n      this.syncWebgisList();\n    },\n    'webgisGroup.item1'() {\n      // 重置视图\n      this.webgis.item1.interactions.zoom.resetView();\n    }\n  }\n};\n</script>\n\n<style lang=\"scss\" scoped>\n@import '../../src/styles/common-variables';\n\n.webgis-diff-analysis {\n  height: 100%;\n  display: flex;\n  &__block {\n    height: 100%;\n    flex: 1;\n    &_left {\n      border-right: $border-base;\n      .webgis-diff-analysis__item {\n        height: 100%;\n      }\n    }\n    &_right {\n      display: flex;\n      &.flex-column {\n        flex-direction: column;\n        > .webgis-diff-analysis__item {\n          height: 50%;\n          &:first-of-type {\n            border-bottom: $border-base;\n          }\n          &:nth-child(2) {\n            border-left: 0;\n          }\n        }\n      }\n      > .webgis-diff-analysis__item {\n        flex: 1;\n        &:nth-child(2) {\n          border-left: $border-base;\n        }\n      }\n    }\n  }\n  &__item {\n    position: relative;\n  }\n  &__name {\n    font-size: $font-size-small;\n    position: absolute;\n    top: $spacing-base;\n    right: $spacing-base;\n    padding: 6px 8px;\n    background: white;\n    z-index: 1;\n  }\n}\n</style>\n","// 主组件\nimport DiffAnalysis from './main';\n\n// Vue.use()\nDiffAnalysis.install = (Vue) => {\n  Vue.component('WebGISDiffAnalysis', DiffAnalysis);\n};\n\n// Vue.component()\nexport default DiffAnalysis;\n","import Vue from 'vue';\n\n// 主组件\nimport WebGIS from './components';\n\n// 其他组件\nimport WebGISDiffAnalysis from '../packages/diff-analysis';\n\n// styles\nimport './styles/public.scss';\n\n// mixins\nimport webgisInitCommon from './mixins/webgis-init-common';\n\n// 对外事件中心 - 全局的（存在于应用中共享）\nconst eventHub = new Vue();\nconst eventName = 'publicWebgisReady';\n\n// webgis 初始化注册用的 mixin 对象\nexport const webgisProvidePublic = {\n  mixins: [webgisInitCommon],\n  methods: {\n    initWebgis(webgis) {\n      eventHub.$emit(eventName, webgis); // emit inject\n      eventHub.$webgis = webgis; // hook\n      this._afterInitWebgis(webgis);\n    }\n  }\n};\n\n// webgis 初始化注入用的 mixin 对象\nexport const webgisInjectPublic = {\n  mixins: [webgisInitCommon],\n  methods: {\n    _initWebgis(webgis) {\n      // cancel event listener\n      eventHub.$off(eventName, this._initWebgis);\n      this._afterInitWebgis(webgis);\n    }\n  },\n  created() {\n    // if `$webgis` ready, don't need listener\n    const webgis = eventHub.$webgis;\n    if (webgis) {\n      this.$webgis = webgis;\n      this._initWebgis(webgis);\n    } else {\n      eventHub.$on(eventName, this._initWebgis);\n    }\n  }\n};\n\n// 对外事件中心 - 私有的（存在与 webgis 当前的组件范围内）\nexport {\n  webgisProvide as webgisProvidePrivate,\n  webgisInject as webgisInjectPrivate\n} from './mixins/webgis-init';\n\n// 更新服务地址配置接口\nexport { updateServerAPI } from './gis/config/server';\n\n// Vue.use()\nWebGIS.install = (Vue) => {\n  Vue.component('WebGIS', WebGIS);\n  Vue.use(WebGISDiffAnalysis);\n};\n\nexport { WebGISDiffAnalysis };\n\n// Vue.component()\nexport default WebGIS;\n"],"names":["modules","BufferAnalysis","HistoryRecord","FeatureSelect","ImageLayer","Measure","LayerSwipe","DiffAnalysis","IntersectAnalysis","getModule","name","hasOwnProperty","then","module","default","msg","Promise","reject","props","type","Array","validator","val","isNotFound","i","length","warnMessage","showControls","Boolean","showAside","options","Object","controls","String","splitScreen","webgisProps","webgisPropsProvide","provide","$_webgisPropsProvide","computed","webgisConfig","webgisPropsInject","inject","data","created","$watch","newVal","defaultEpsg","registerEPSG","epsgConfig","epsg","proj4","defs","entries","register","styleInject","css","ref","insertAt","document","head","getElementsByTagName","style","createElement","firstChild","insertBefore","appendChild","styleSheet","cssText","createTextNode","mergeConfig","source","config","item","sourceItem","key","defaultVisibleService","land","region","special","year","scale","layer","defaultLayerConfig","zoomThreshold","setDefaultLayerConfig","setDefaultVisibleService","LayerTree","olMap","_projection","getView","getProjection","_layerManagement","LayerManagement","on","_updateOlLayer","nodeId","checked","showLayers","needUpdate","index","paramToArray","treeCheck","treeNodes","filter","treeLayersIds","includes","forEach","id","indexOf","splice","push","layerChange","eventHub","dispatch","_updateNodeChecked","_updateLayersVisible","groupLayers","_createNode","treeMerge","curr","next","letter","treeEach","node","arr","parent","_updateTreeData","nodeMaxIndex","_treeNodesFlat","zIndex","lastNode","treeLayers","slice","layerId","opacity","layers","getOlLayer","setOpacity","direction","find","parentChildren","children","currIndex","nextIndex","_updateLayersZIndex","map","olLayer","configGroup","alias","parentId","nodeLayer","caption","nodeType","Symbol","landLetter","specialLetter","regionLetter","yearLetter","reload","layerType","olView","getZoom","_layerType","layerManagement","layerConfig","layerConfigGroup","removeLayer","addLayer","serverId","serverType","serverIdWMS","serviceCode","extent","resolutions","tileInfo","projection","visible","treeToFlatArray","setVisible","checkedIds","setZIndex","getServiceList","request","url","SERVER_CONFIG","arcgisServiceList","method","q","arcgisUsername","f","num","analysisToken","getServiceConfig","code","baseURL","arcgisQuery","getServiceDetail","epsgNum","geometry","geometryType","where","outFields","returnGeometry","groupByFieldsForStatistics","outStatistics","spatialRel","inSR","outSR","aliasMap","X","B","G","M","S","TDLYXZ","TDGY","JCDL","JSYDXM","PZWJSTD","TDXZ","XZQ","XJXZQ","CJDCQ","DLTB","YJJBNTTB","CZCDYD","YDBP","setAliasMap","parseCheckReg","parseRules","replace","GISConfig","all","res","results","reduce","checkValidArray","services","test","title","getMultiService","errorMessage","restRes","result","layerLength","_formatConfig","current","words","keys","parseResult","serviceCodeLayer","response","_parseAlias","_formatLayers","fullExtent","olExtent","initialExtent","xmin","ymin","xmax","ymax","center","wkid","spatialReference","lods","lod","resolution","zoom","viewZoom","wfs","wms","wmts","layerNameKey","label","permission","gisConfig","promise","getMapConfig","sortServiceList","defaultItem","serviceList","defaultLetterConfig","compareKeys","letterItem","defaultLetterItem","findIndex","compareConfig","itemAlias","score","sort","a","b","animateDuration","Zoom","_defaultZoom","mapConfig","_defaultCenter","_mapView","_map","animate","maps","getCenter","interactions","padding","extents","focusExtents","duration","features","getGeometry","getExtent","prev","fit","constrainResolution","nearest","maxZoom","DragPan","OlDragPan","_olMap","toggleActive","addInteraction","_dragPan","removeInteraction","ToggleActive","saveCanvas","canvas","filename","navigator","msSaveBlob","msToBlob","toBlob","blob","saveAs","e","mousePosition","OlMousePosition","undefinedHTML","coordinateFormat","coordinate","text","olFormat","scaleLine","OlScaleLine","getControls","controlNames","allowedTypes","formatObjectSimple","obj","formatLengthToStr","output","Math","round","formatAreaToString","area","GISUtils","EsriJSON","_mapCursorStyle","getTarget","_updateSizeTimeId","cancelAnimationFrame","setTimeout","animationCallback","updateSize","requestAnimationFrame","once","event","context","renderSync","_defaultCursor","cursor","state","controlsName","addControl","removeControl","_selectInteractionState","selectInteraction","setActive","param","newParam","formatGeometryObject","JSON","stringify","elseParams","nodeConfig","nodeConfigGroup","getLayerInfo","getLayerInfoParams","fields","value","field","Set","fieldValue","attributes","trim","add","from","featureData","formatEsriJSON","readFeatures","resolveFeatureData","addFeature","feature","vectorSource","hasFeature","removeFeature","setFeatureStyle","toFeatures","params","layerIds","filterCallback","checkChange","promiseArr","error","properties","BSM","getProperties","OBJECTID","set","clearFeature","clearSelectFeature","selectedFeatures","fillStyle","color","strokeStyle","width","setStyle","Style","fill","Fill","stroke","Stroke","clear","getOverlays","geometryLike","isArray","getType","writeGeometryObject","str","getArea","getLength","Draw","_viewport","getViewport","_vectorSource","_pointerMoveHandler","bind","_hideHelpTooltipElement","isFreehand","_supportTypes","_createHelpTooltip","addEventListener","_addInteraction","_removeHelpTooltip","un","removeEventListener","_removeInteraction","_features","_helpTooltipElement","classList","evt","dragging","helpMsg","_helpMsg","_helpMsgType","_continueLineMsg","_continuePolygonMsg","_continueEndMsg","_showHelpTooltip","_helpTooltip","setPosition","innerHTML","remove","_draw","OlDraw","freehand","toggleSelectInteraction","_formatEventData","className","Overlay","element","offset","positioning","addOverlay","removeOverlay","writeGeometry","classMixin","GISEvent","DragZoom","out","active","condition","mouseOnly","activate","deactivate","_options","_dragZoom","OlDragZoom","toggleCursorStyle","promiseQueue","promiseFunction","_promiseQueue","resolve","mapId","Map","Select","VectorSource","VectorLayer","vectorLayer","getFeatures","toggleControls","create","initView","createLayerTree","dragPan","boxSelection","BoxSelection","draw","dragZoom","initModules","catch","olProj","axisOrientation","setExtent","setView","OlView","moduleName","camelCase","target","viewport","querySelectorAll","OlMap","olControl","attribution","olInteraction","init","normalizeComponent","template","script","scopeId","isFunctionalTemplate","moduleIdentifier","shadowMode","createInjector","createInjectorSSR","createInjectorShadow","render","staticRenderFns","_compiled","functional","_scopeId","hook","$vnode","ssrContext","__VUE_SSR_CONTEXT__","call","_registeredComponents","_ssrRegister","$root","$options","shadowRoot","originalRender","renderWithStyleInjection","h","existing","beforeCreate","concat","webgisReady","$webgis","methods","_afterInitWebgis","webgis","afterInitWebgis","Function","privateEventHubProvide","$_eventHub","$eventHub","Vue","privateEventHubInject","$data","$evenHub","eventName","webgisProvide","mixins","webgisInitCommon","initWebgis","$emit","webgisInject","_initWebgis","$off","$on","featureSelectActive","featureSelectToggle","featureSelect","$message","info","message","beforeDestroy","offAll","splitScreenToggle","height","spans","install","component","webgisProvidePublic","webgisInjectPublic","WebGIS","use","WebGISDiffAnalysis"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkBO,IAAMA,OAAO,GAAG;EACrBC,cAAc,EAAE;WAAM,uCAAN;GADK;EAErBC,aAAa,EAAE;WAAM,sCAAN;GAFM;EAGrBC,aAAa,EAAE;WAAM,sCAAN;GAHM;EAIrBC,UAAU,EAAE;WAAM,mCAAN;GAJS;EAKrBC,OAAO,EAAE;WAAM,+BAAN;GALY;EAMrBC,UAAU,EAAE;WAAM,mCAAN;GANS;EAOrBC,YAAY,EAAE;WAAM,qCAAN;GAPO;EAQrBC,iBAAiB,EAAE;WAAM,0CAAN;;CARd;AAgBP,AAAe,SAASC,SAAT,CAAmBC,IAAnB,EAAyB;MAClCV,OAAO,CAACW,cAAR,CAAuBD,IAAvB,CAAJ,EAAkC;WACzBV,OAAO,CAACU,IAAD,CAAP,GAAgBE,IAAhB,CAAqB,UAACC,MAAD;aAAYA,MAAM,CAACC,OAAnB;KAArB,CAAP;GADF,MAEO;QACCC,GAAG,aAAML,IAAN,oFAAT;WACOM,OAAO,CAACC,MAAR,CAAeF,GAAf,CAAP;;;;AC9BJ,IAAMG,KAAK,GAAG;EAEZlB,OAAO,EAAE;IACPmB,IAAI,EAAEC,KADC;IAEPN,OAFO,sBAEG;aACD,EAAP;KAHK;IAKPO,SALO,qBAKGC,GALH,EAKQ;UACTC,UAAU,GAAG,KAAjB;UACIV,MAAJ;;WACK,IAAIW,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGF,GAAG,CAACG,MAAxB,EAAgCD,CAAC,EAAjC,EAAqC;QACnCX,MAAM,GAAGS,GAAG,CAACE,CAAD,CAAZ;;YACI,CAACxB,OAAO,CAACW,cAAR,CAAuBE,MAAvB,CAAL,EAAqC;UACnCU,UAAU,GAAG,IAAb;;;;;UAIAA,UAAJ,EAAgB;QACdG,WAAW,kBAAWb,MAAX,oBAAX;eACO,KAAP;OAFF,MAGO;eACE,IAAP;;;GArBM;EA0BZc,YAAY,EAAE;IACZR,IAAI,EAAES,OADM;IAEZd,OAAO,EAAE;GA5BC;EA+BZe,SAAS,EAAED,OA/BC;EAiCZE,OAAO,EAAE;IACPX,IAAI,EAAEY,MADC;IAEPjB,OAFO,sBAEG;aACD,EAAP;;GApCQ;EAwCZkB,QAAQ,EAAE;IACRb,IAAI,EAAEC,KAAK,IAAIa,MADP;IAERnB,OAFQ,sBAEE;aACD,CAAC,eAAD,EAAkB,WAAlB,CAAP;;GA3CQ;EA+CZoB,WAAW,EAAEN;CA/Cf;AAkDA,AAAO,IAAMO,WAAW,GAAG;EACzBjB,KAAK,EAALA;CADK;AAKP,AAAO,IAAMkB,kBAAkB,GAAG;EAChClB,KAAK,EAALA,KADgC;EAEhCmB,OAFgC,qBAEtB;WACD;MACLC,oBAAoB,EAAE;KADxB;GAH8B;EAOhCC,QAAQ,EAAE;IACRC,YADQ,0BACO;aACN;QACLxC,OAAO,EAAE,KAAKA,OADT;QAEL2B,YAAY,EAAE,KAAKA,YAFd;QAGLE,SAAS,EAAE,KAAKA,SAHX;QAILC,OAAO,EAAE,KAAKA,OAJT;QAKLE,QAAQ,EAAE,KAAKA;OALjB;;;CATC;AAqBP,AAAO,IAAMS,iBAAiB,GAAG;EAC/BC,MAAM,EAAE,CAAC,sBAAD,CADuB;EAE/BC,IAF+B,kBAExB;WACE;MACLH,YAAY,EAAE;KADhB;GAH6B;EAO/BI,OAP+B,qBAOrB;;;SACHJ,YAAL,GAAoB,KAAKF,oBAAL,CAA0BE,YAA9C;SACKF,oBAAL,CAA0BO,MAA1B,CAAiC,cAAjC,EAAiD,UAACC,MAAD,EAAY;MAC3D,KAAI,CAACN,YAAL,GAAoBM,MAApB;KADF;;CATG;;AC3EP,IAAMC,WAAW,GAAG;eACL,qCADK;eAEL;CAFf;AAMA,AAAO,SAASC,YAAT,CAAsBC,UAAtB,EAAkC;MAEjCC,IAAI,qBAAQH,WAAR,EAAwBE,UAAxB,CAAV;;EAGAE,KAAK,CAACC,IAAN,CAAWrB,MAAM,CAACsB,OAAP,CAAeH,IAAf,CAAX;EAGAI,QAAQ,CAACH,KAAD,CAAR;;;ACxBF,SAASI,WAAT,CAAqBC,GAArB,EAA0BC,GAA1B,EAA+B;MACxBA,GAAG,KAAK,KAAK,CAAlB,EAAsBA,GAAG,GAAG,EAAN;MAClBC,QAAQ,GAAGD,GAAG,CAACC,QAAnB;;MAEI,CAACF,GAAD,IAAQ,OAAOG,QAAP,KAAoB,WAAhC,EAA6C;;;;MAEzCC,IAAI,GAAGD,QAAQ,CAACC,IAAT,IAAiBD,QAAQ,CAACE,oBAAT,CAA8B,MAA9B,EAAsC,CAAtC,CAA5B;MACIC,KAAK,GAAGH,QAAQ,CAACI,aAAT,CAAuB,OAAvB,CAAZ;EACAD,KAAK,CAAC3C,IAAN,GAAa,UAAb;;MAEIuC,QAAQ,KAAK,KAAjB,EAAwB;QAClBE,IAAI,CAACI,UAAT,EAAqB;MACnBJ,IAAI,CAACK,YAAL,CAAkBH,KAAlB,EAAyBF,IAAI,CAACI,UAA9B;KADF,MAEO;MACLJ,IAAI,CAACM,WAAL,CAAiBJ,KAAjB;;GAJJ,MAMO;IACLF,IAAI,CAACM,WAAL,CAAiBJ,KAAjB;;;MAGEA,KAAK,CAACK,UAAV,EAAsB;IACpBL,KAAK,CAACK,UAAN,CAAiBC,OAAjB,GAA2BZ,GAA3B;GADF,MAEO;IACLM,KAAK,CAACI,WAAN,CAAkBP,QAAQ,CAACU,cAAT,CAAwBb,GAAxB,CAAlB;;;;;;;AClBG,SAASc,WAAT,CAAqBC,MAArB,EAA6BC,MAA7B,EAAqC;MACtCA,MAAM,YAAYzC,MAAtB,EAA8B;QACxB0C,IAAJ,EAAUC,UAAV;;SACK,IAAIC,GAAT,IAAgBH,MAAhB,EAAwB;UAClBA,MAAM,CAAC7D,cAAP,CAAsBgE,GAAtB,CAAJ,EAAgC;QAC9BF,IAAI,GAAGD,MAAM,CAACG,GAAD,CAAb;QACAD,UAAU,GAAGH,MAAM,CAACI,GAAD,CAAnB;;YACIF,IAAI,IAAIA,IAAI,KAAK,CAArB,EAAwB;cAClBA,IAAI,YAAY1C,MAApB,EAA4B;gBACtB,CAAC2C,UAAL,EAAiB;cACfH,MAAM,CAACI,GAAD,CAAN,GAAcF,IAAd;aADF,MAEO;cACLH,WAAW,CAACI,UAAD,EAAaD,IAAb,CAAX;;WAJJ,MAMO;YACLF,MAAM,CAACI,GAAD,CAAN,GAAcF,IAAd;;;;;;;;ACjBL,IAAMG,qBAAqB,GAAG;EACnCC,IAAI,EAAE,EAD6B;EAEnCC,MAAM,EAAE,EAF2B;EAGnCC,OAAO,EAAE,EAH0B;EAInCC,IAAI,EAAE,EAJ6B;EAKnCC,KAAK,EAAE,EAL4B;EAMnCC,KAAK,EAAE;CANF;AAUP,AAAO,IAAMC,kBAAkB,GAAG;EAGhCC,aAAa,EAAE;CAHV;AAOP,AAAO,SAASC,qBAAT,CAA+Bb,MAA/B,EAAuC;EAC5CF,WAAW,CAACa,kBAAD,EAAqBX,MAArB,CAAX;;AAIF,AAAO,SAASc,wBAAT,CAAkCd,MAAlC,EAA0C;EAC/CF,WAAW,CAACM,qBAAD,EAAwBJ,MAAxB,CAAX;;;ICXmBe;;;qBAePC,KAAZ,EAAmB;;;;;wCAdN,EAcM;;uCAbP,EAaO;;wCAZN,EAYM;;2CAXH,EAWG;;4CAVF,EAUE;;;;;;;;SACZC,WAAL,GAAmBD,KAAK,CAACE,OAAN,GAAgBC,aAAhB,EAAnB;SACKC,gBAAL,GAAwB,IAAIC,eAAJ,CAAoBL,KAApB,CAAxB;IACAA,KAAK,CAACM,EAAN,CAAS,SAAT,EAAoB;aAAM,KAAI,CAACC,cAAL,EAAN;KAApB;;;;;gCAQUC,QAAQC,SAAS;;;UACrBC,UAAU,GAAG,KAAKA,UAAxB;UACIC,UAAU,GAAG,KAAjB;UACIC,KAAJ;MAGAJ,MAAM,GAAGK,YAAY,CAACL,MAAD,CAArB;MACAA,MAAM,GAAGM,SAAS,CAAC,KAAKC,SAAN,EAAiBP,MAAjB,CAAT,CAAkCQ,MAAlC,CAAyC,UAAC/B,IAAD;eAChD,MAAI,CAACgC,aAAL,CAAmBC,QAAnB,CAA4BjC,IAA5B,CADgD;OAAzC,CAAT;MAIAuB,MAAM,CAACW,OAAP,CAAe,UAACC,EAAD,EAAQ;QACrBR,KAAK,GAAGF,UAAU,CAACW,OAAX,CAAmBD,EAAnB,CAAR;;YAEIR,KAAK,KAAK,CAAC,CAAf,EAAkB;cACZ,CAACH,OAAL,EAAc;YACZC,UAAU,CAACY,MAAX,CAAkBV,KAAlB,EAAyB,CAAzB;YACAD,UAAU,GAAG,IAAb;;SAHJ,MAKO,IAAIF,OAAJ,EAAa;UAClBC,UAAU,CAACa,IAAX,CAAgBH,EAAhB;UACAT,UAAU,GAAG,IAAb;;OAVJ;;UAcIA,UAAJ,EAAgB;aACTa,WAAL;aACKC,QAAL,CAAcC,QAAd,CAAuB,aAAvB,EAAsClB,MAAtC,EAA8CC,OAA9C;;;;;gCAQQC,YAAY;UAClBA,UAAJ,EAAgB;aACTA,UAAL,GAAkBG,YAAY,CAACH,UAAD,CAA9B;;;WAEGiB,kBAAL;;WACKC,oBAAL;;WACKH,QAAL,CAAcC,QAAd,CAAuB,aAAvB,EAAsC,KAAKhB,UAA3C;;;;sCAQiD;;;UAAnCmB,WAAmC,uEAArB,EAAqB;UAAjBnB,UAAiB,uEAAJ,EAAI;UAC3CK,SAAS,GAAG,EAAlB;MAGAc,WAAW,CAACV,OAAZ,CAAoB,UAAClC,IAAD;eAAU8B,SAAS,CAACQ,IAAV,CAAe,MAAI,CAACO,WAAL,CAAiB7C,IAAjB,CAAf,CAAV;OAApB;WAGK8B,SAAL,GAAiBgB,SAAS,CACxBhB,SADwB,EAExB,UAACiB,IAAD,EAAOC,IAAP;eAAgBD,IAAI,CAACE,MAAL,IAAeF,IAAI,CAACE,MAAL,KAAgBD,IAAI,CAACC,MAApD;OAFwB,CAA1B;MAMAC,QAAQ,CACN,KAAKpB,SADC,EAEN,UAACqB,IAAD,EAAOxB,KAAP,EAAcyB,GAAd,EAAmBC,MAAnB;eAA+BF,IAAI,CAACE,MAAL,GAAcA,MAA7C;OAFM,CAAR;;WAMKC,eAAL;;UAGMC,YAAY,GAAG,KAAKC,cAAL,CAAoBxG,MAApB,GAA6B,CAAlD;;WACKwG,cAAL,CAAoBtB,OAApB,CACE,UAAClC,IAAD,EAAO2B,KAAP;eAAkB3B,IAAI,CAACyD,MAAL,GAAcF,YAAY,GAAG5B,KAA/C;OADF;;WAKKL,cAAL,CAAoB,IAApB;;MAIAG,UAAU,GAAGG,YAAY,CAACH,UAAD,CAAzB;;UACI,CAACA,UAAU,CAACzE,MAAhB,EAAwB;YAChB0G,QAAQ,GAAG,KAAKC,UAAL,CAAgBC,KAAhB,CAAsB,CAAC,CAAvB,EAA0B,CAA1B,CAAjB;QACAnC,UAAU,CAACa,IAAX,CAAgBoB,QAAQ,CAACvB,EAAzB;;;WAEGI,WAAL,CAAiBd,UAAjB;;;;oCAQcoC,SAASC,SAAS;UAC1BC,MAAM,GAAG,KAAKC,UAAL,CAAgBH,OAAhB,CAAf;MACAE,MAAM,CAAC7B,OAAP,CAAe,UAAClC,IAAD;eAAUA,IAAI,CAACiE,UAAL,CAAgBH,OAAhB,CAAV;OAAf;;;;iCAQWD,SAASnH,MAAM;UACpBwH,SAAS,GAAGxH,IAAI,KAAK,MAAT,GAAkB,CAAlB,GAAsB,CAAC,CAAzC;;UACMyG,IAAI,GAAG,KAAKK,cAAL,CAAoBW,IAApB,CAAyB,UAACnE,IAAD;eAAUA,IAAI,CAACmC,EAAL,KAAY0B,OAAtB;OAAzB,CAAb;;UACMO,cAAc,GAAGjB,IAAI,CAACE,MAAL,CAAYgB,QAAnC;UACMC,SAAS,GAAGF,cAAc,CAAChC,OAAf,CAAuBe,IAAvB,CAAlB;UACMoB,SAAS,GAAGD,SAAS,GAAGJ,SAA9B;UACMlB,IAAI,GAAGoB,cAAc,CAACG,SAAD,CAA3B;;UAEIvB,IAAJ,EAAU;YACFD,IAAI,GAAGqB,cAAc,CAACE,SAAD,CAA3B;mBAG6B,CAACtB,IAAI,CAACS,MAAN,EAAcV,IAAI,CAACU,MAAnB,CAJrB;QAIPV,IAAI,CAACU,MAJE;QAIMT,IAAI,CAACS,MAJX;QAKRW,cAAc,CAAC/B,MAAf,CACEiC,SADF,EAEE,CAFF,EAGEF,cAAc,CAAC/B,MAAf,CAAsBkC,SAAtB,EAAiC,CAAjC,EAAoC,CAApC,CAHF;;aAOKC,mBAAL,CAAyB,CAACzB,IAAD,EAAOC,IAAP,CAAzB;;aAEKM,eAAL;;;;;+BASOO,SAAS;MAClBA,OAAO,GAAGjC,YAAY,CAACiC,OAAD,CAAtB;aACO,KAAKF,UAAL,CACJ5B,MADI,CACG,UAAC/B,IAAD;eAAU6D,OAAO,CAAC5B,QAAR,CAAiBjC,IAAI,CAACmC,EAAtB,CAAV;OADH,EAEJsC,GAFI,CAEA,UAACzE,IAAD;eAAUA,IAAI,CAAC0E,OAAf;OAFA,CAAP;;;;yCASmB;aACZ,KAAKf,UAAL,CAAgBQ,IAAhB,CAAqB,UAACnE,IAAD;eAAUA,IAAI,CAACwB,OAAf;OAArB,CAAP;;;;gCAOUmD,aAAa;UAEjBC,KAAK,GAAGD,WAAW,CAACC,KAA1B;UACMb,MAAM,GAAGY,WAAW,CAACZ,MAA3B;UAGMc,QAAQ,GAAGF,WAAW,CAACxC,EAA7B;UAGM2C,SAAS,GAAGf,MAAM,CAACU,GAAP,CAAW,UAAChE,KAAD,EAAW;eAC/B;UACL0B,EAAE,EAAE1B,KAAK,CAAC0B,EADL;UAELc,MAAM,EAAExC,KAAK,CAACwC,MAFT;UAGLhH,IAAI,EAAEwE,KAAK,CAACsE,OAHP;UAILhF,MAAM,EAAEU,KAJH;UAKLkE,WAAW,EAAXA,WALK;UAMLK,QAAQ,EAAE;SANZ;OADgB,CAAlB;aAWO;QAEL7C,EAAE,EAAE8C,MAAM,EAFL;QAGLhC,MAAM,EAAE2B,KAAK,CAACM,UAHT;QAILjJ,IAAI,EAAE2I,KAAK,CAACxE,IAJP;QAKLL,MAAM,EAAE4E,WALH;QAMLK,QAAQ,EAAE,IANL;QAOLX,QAAQ,EAAE,CACR;UAEElC,EAAE,EAAE8C,MAAM,EAFZ;UAGEhC,MAAM,EAAE2B,KAAK,CAACO,aAHhB;UAIElJ,IAAI,EAAE2I,KAAK,CAACtE,OAJd;UAKEP,MAAM,EAAE4E,WALV;UAMEK,QAAQ,EAAE,IANZ;UAOEX,QAAQ,EAAE,CACR;YAEElC,EAAE,EAAE8C,MAAM,EAFZ;YAGEhC,MAAM,EAAE2B,KAAK,CAACQ,YAHhB;YAIEnJ,IAAI,EAAE2I,KAAK,CAACvE,MAJd;YAKEN,MAAM,EAAE4E,WALV;YAMEK,QAAQ,EAAE,KANZ;YAOEX,QAAQ,EAAE,CACR;cAEElC,EAAE,EAAE0C,QAFN;cAGE5B,MAAM,EAAE2B,KAAK,CAACS,UAHhB;cAIEpJ,IAAI,EAAE2I,KAAK,CAACrE,IAJd;cAKER,MAAM,EAAE4E,WALV;cAMEK,QAAQ,EAAE,IANZ;cAOEX,QAAQ,EAAES;aARJ;WARJ;SARJ;OAPZ;;;;qCA8C6B;UAAhBQ,MAAgB,uEAAP,KAAO;UAEvB3E,aAAa,GAAGD,kBAAkB,CAACC,aAAzC;UACM4E,SAAS,GACb,CAAC5E,aAAD,IAAkB,KAAK6E,MAAL,CAAYC,OAAZ,MAAyB9E,aAA3C,GAA2D,KAA3D,GAAmE,MADrE;;UAEI,CAAC2E,MAAD,IAAWC,SAAS,KAAK,KAAKG,UAAlC,EAA8C;;;;WAGzCA,UAAL,GAAkBH,SAAlB;UAEMI,eAAe,GAAG,KAAKxE,gBAA7B;UACIyE,WAAJ,EAAiBC,gBAAjB,EAAmCnB,OAAnC;WACKf,UAAL,CAAgBzB,OAAhB,CAAwB,UAAClC,IAAD,EAAU;QAChC4F,WAAW,GAAG5F,IAAI,CAACD,MAAnB;QACA8F,gBAAgB,GAAG7F,IAAI,CAAC2E,WAAxB;QACAD,OAAO,GAAG1E,IAAI,CAAC0E,OAAf;;YAGIA,OAAJ,EAAa;UACXiB,eAAe,CAACG,WAAhB,CAA4BpB,OAA5B;;;QAIF1E,IAAI,CAAC0E,OAAL,GAAeiB,eAAe,CAACI,QAAhB,CAEbH,WAAW,CAAClJ,IAAZ,KAAqB,WAArB,GAAmC6I,SAAnC,GAA+C,OAFlC,EAGb;UACES,QAAQ,EAAEJ,WAAW,CAACI,QADxB;UAEEC,UAAU,EAAEL,WAAW,CAAClJ,IAF1B;UAGEwJ,WAAW,EAAEN,WAAW,CAACM,WAH3B;UAIEC,WAAW,EAAEP,WAAW,CAACO,WAJ3B;UAKEC,MAAM,EAAEP,gBAAgB,CAACO,MAL3B;UAME3C,MAAM,EAAEzD,IAAI,CAACyD,MANf;UAOE4C,WAAW,EAAER,gBAAgB,CAACQ,WAPhC;UAQEC,QAAQ,EAAET,gBAAgB,CAACS,QAR7B;UASEC,UAAU,EAAEV,gBAAgB,CAACpH,IAT/B;UAUE+H,OAAO,EAAExG,IAAI,CAACwB;SAbH,CAAf;OAXF;;;;sCAkCgB;WAEXgC,cAAL,GAAsBiD,eAAe,CAAC,KAAK3E,SAAN,CAArC;WACK6B,UAAL,GAAkB,KAAKH,cAAL,CAAoBzB,MAApB,CAChB,UAAC/B,IAAD;eAAUA,IAAI,CAACgF,QAAL,KAAkB,OAA5B;OADgB,CAAlB;WAGKhD,aAAL,GAAqB,KAAK2B,UAAL,CAAgBc,GAAhB,CAAoB,UAACzE,IAAD;eAAUA,IAAI,CAACmC,EAAf;OAApB,CAArB;;;;2CAOqB;WAChBwB,UAAL,CAAgBzB,OAAhB,CAAwB,UAAClC,IAAD,EAAU;QAChCA,IAAI,CAAC0E,OAAL,CAAagC,UAAb,CAAwB1G,IAAI,CAACwB,OAA7B;OADF;;;;yCASmB;UACbmF,UAAU,GAAG9E,SAAS,CAAC,KAAKC,SAAN,EAAiB,KAAKL,UAAtB,CAA5B;WACKkC,UAAL,CAAgBzB,OAAhB,CAAwB,UAACiB,IAAD,EAAU;QAChCA,IAAI,CAAC3B,OAAL,GAAemF,UAAU,CAAC1E,QAAX,CAAoBkB,IAAI,CAAChB,EAAzB,CAAf;OADF;;;;wCAUkBgB,MAAM;MACxBA,IAAI,CAACjB,OAAL,CAAa,UAAClC,IAAD,EAAU;QACrBA,IAAI,CAAC0E,OAAL,CAAakC,SAAb,CAAuB5G,IAAI,CAACyD,MAA5B;OADF;;;;;;;AChVG,SAASoD,cAAT,GAA8C;MAAtBnK,IAAsB,uEAAf,aAAe;SAC5CoK,OAAO,CAAC;IACbC,GAAG,EAAEC,aAAa,CAACC,iBADN;IAEbC,MAAM,EAAE,MAFK;IAGbhJ,IAAI,EAAE;MACJiJ,CAAC,kBACCH,aAAa,CAACI,cADf,8CAEkC1K,IAFlC,qQADG;MAOJ2K,CAAC,EAAE,MAPC;MAQJC,GAAG,EAAE;KAXM;IAabC,aAAa,EAAE;GAbH,CAAd;;AAqBF,AAAO,SAASC,gBAAT,CAA0BC,IAA1B,EAA6D;MAA7B/K,IAA6B,uEAAtB,WAAsB;MAATyF,EAAS,uEAAJ,EAAI;SAC3D2E,OAAO,CAAC;IACbY,OAAO,EAAEV,aAAa,CAACW,WADV;IAEbZ,GAAG,kCAA2BU,IAA3B,cAAmC/K,IAAnC,cAA2CyF,EAA3C,CAFU;IAGb+E,MAAM,EAAE,MAHK;IAIbhJ,IAAI,EAAE;MACJmJ,CAAC,EAAE;;GALO,CAAd;;AAyBF,AAAO,SAASO,gBAAT,OAWJ;MAVDzB,WAUC,QAVDA,WAUC;MATDtC,OASC,QATDA,OASC;MARDgE,OAQC,QARDA,OAQC;MAPDC,QAOC,QAPDA,QAOC;MANDC,YAMC,QANDA,YAMC;wBALDC,KAKC;MALDA,KAKC,2BALO,KAKP;4BAJDC,SAIC;MAJDA,SAIC,+BAJW,GAIX;iCAHDC,cAGC;MAHDA,cAGC,oCAHgB,IAGhB;mCAFDC,0BAEC;MAFDA,0BAEC,sCAF4B,EAE5B;MADDC,aACC,QADDA,aACC;SACMtB,OAAO,CAAC;IACbY,OAAO,EAAEV,aAAa,CAACW,WADV;IAEbZ,GAAG,kCAA2BZ,WAA3B,wBAAoDtC,OAApD,WAFU;IAGbqD,MAAM,EAAE,MAHK;IAIbhJ,IAAI,EAAE;MACJmJ,CAAC,EAAE,MADC;MAEJa,cAAc,EAAdA,cAFI;MAGJG,UAAU,EAAE,0BAHR;MAIJP,QAAQ,EAARA,QAJI;MAKJC,YAAY,EAAZA,YALI;MAMJE,SAAS,EAATA,SANI;MAOJK,IAAI,EAAET,OAPF;MAQJU,KAAK,EAAEV,OARH;MASJM,0BAA0B,EAA1BA,0BATI;MAUJC,aAAa,EAAbA,aAVI;MAWJJ,KAAK,EAALA;;GAfU,CAAd;;;ACjEK,IAAMQ,QAAQ,GAAG;EACtBpI,IAAI,EAAE;IACJqI,CAAC,EAAE,IADC;IAEJC,CAAC,EAAE,MAFC;IAGJC,CAAC,EAAE,IAHC;IAIJC,CAAC,EAAE,IAJC;IAKJC,CAAC,EAAE;GANiB;EAQtBxI,MAAM,EAAE;cACI,KADJ;cAEI,KAFJ;cAGI,KAHJ;cAII,KAJJ;cAKI,KALJ;cAMI,KANJ;cAOI,KAPJ;cAQI,KARJ;cASI;GAjBU;EAmBtBG,KAAK,EAAE;IACLmI,CAAC,EAAE;GApBiB;EAsBtBrI,OAAO,EAAE;IACPwI,MAAM,EAAE,QADD;IAEPC,IAAI,EAAE,MAFC;IAGPC,IAAI,EAAE,MAHC;IAIPC,MAAM,EAAE;GA1BY;EA4BtB1I,IAAI,EAAE,EA5BgB;EAgCtBE,KAAK,EAAE;IACLyI,OAAO,EAAE,SADJ;IAELC,IAAI,EAAE,QAFD;IAGLC,GAAG,EAAE,KAHA;IAILC,KAAK,EAAE,OAJF;IAKLC,KAAK,EAAE,OALF;IAMLC,IAAI,EAAE,MAND;IAOLC,QAAQ,EAAE,UAPL;IAQLC,MAAM,EAAE,QARH;IASLV,IAAI,EAAE,MATD;IAULW,IAAI,EAAE;;CA1CH;AA+CP,AAAO,SAASC,WAAT,CAAqB5J,MAArB,EAA6B;EAClCF,WAAW,CAAC2I,QAAD,EAAWzI,MAAX,CAAX;;;AC5BF,IAAM6J,aAAa,GAAG,uCAAtB;AACA,IAAMC,UAAU,GAAG;EAEjBzJ,IAAI,EAAE,cAACqH,IAAD;WAAUA,IAAI,CAAC7D,KAAL,CAAW,CAAX,EAAc,CAAd,CAAV;GAFW;EAIjBtD,OAAO,EAAE,iBAACmH,IAAD;WACPA,IAAI,CAACqC,OAAL,CAAa,aAAb,EAA4B,EAA5B,EAAgCA,OAAhC,CAAwC,eAAxC,EAAyD,EAAzD,CADO;GAJQ;EAOjBzJ,MAAM,EAAE,gBAACoH,IAAD;WAAUA,IAAI,CAAC7D,KAAL,CAAW,CAAX,EAAc,CAAd,CAAV;GAPS;EASjBrD,IAAI,EAAE,cAACkH,IAAD;WAAUA,IAAI,CAACqC,OAAL,CAAa,mBAAb,EAAkC,EAAlC,EAAsCA,OAAtC,CAA8C,UAA9C,EAA0D,EAA1D,CAAV;GATW;EAajBrJ,KAAK,EAAE,eAACgH,IAAD;WAAUA,IAAI,CAACqC,OAAL,CAAa,OAAb,EAAsB,EAAtB,EAA0BlG,KAA1B,CAAgC,CAAhC,CAAV;;CAbT;;IAsBqBmG;;;uBACL;;;;;;mCA0FC;;;aACNxN,OAAO,CAACyN,GAAR,CAAY,CACjBnD,cAAc,CAAC,eAAD,CADG,EAEjBA,cAAc,EAFG,CAAZ,EAGJ1K,IAHI,CAGC,UAAC8N,GAAD,EAAS;YACTC,OAAO,GAAGD,GAAG,CAACE,MAAJ,CACd,UAACpH,IAAD,EAAOC,IAAP;8CAAoBD,IAApB,sBAA6BC,IAAI,CAACkH,OAAlC;SADc,EAEd,EAFc,CAAhB;;YAIIE,eAAe,CAACF,OAAD,CAAnB,EAA8B;cACtBG,QAAQ,GAAGH,OAAO,CACrBnI,MADc,CACP,UAAC/B,IAAD;mBAAU4J,aAAa,CAACU,IAAd,CAAmBtK,IAAI,CAACuK,KAAxB,CAAV;WADO,EAEd9F,GAFc,CAEV,UAACzE,IAAD;mBAAW;cACdmC,EAAE,EAAEnC,IAAI,CAACuK,KADK;cAEd7N,IAAI,EAAEsD,IAAI,CAACtD,IAAL,KAAc,aAAd,GAA8B,WAA9B,GAA4C;aAF/C;WAFU,CAAjB;;cAMI2N,QAAQ,CAACrN,MAAb,EAAqB;mBACZ,KAAI,CAACwN,eAAL,CAAqBH,QAArB,CAAP;WADF,MAEO;YACLI,YAAY,CAAC,cAAD,CAAZ;mBACOlO,OAAO,CAACC,MAAR,CAAeyN,GAAf,CAAP;;SAXJ,MAaO;UACLQ,YAAY,oDAAZ;iBACOlO,OAAO,CAACC,MAAR,CAAeyN,GAAf,CAAP;;OAvBG,CAAP;;;;oCAiCcI,UAAU;;;aACjB9N,OAAO,CAACyN,GAAR,CACLK,QAAQ,CAAC5F,GAAT,CAAa,UAACzE,IAAD,EAAU;YACjB,OAAOA,IAAP,KAAgB,QAApB,EAA8B;UAC5BA,IAAI,GAAG;YAAEmC,EAAE,EAAEnC,IAAN;YAAYtD,IAAI,EAAE;WAAzB;;;oBAEmBsD,IAJA;YAIbmC,EAJa,SAIbA,EAJa;YAITzF,IAJS,SAITA,IAJS;eAMd8K,gBAAgB,CAACrF,EAAD,EAAKzF,IAAL,CAAhB,CAA2BP,IAA3B,CAAgC,UAACuO,OAAD,EAAa;cAC5CC,MAAM,GAAG,EAAf;;cACID,OAAJ,EAAa;gBAEP,CAACA,OAAO,CAAC3G,MAAT,IAAmBrH,IAAI,KAAK,aAAhC,EAA+C;cAC7CgO,OAAO,CAAC3G,MAAR,GAAiB,CAAC;gBAAE5B,EAAE,EAAE,EAAN;gBAAUlG,IAAI,EAAEkG;eAAjB,CAAjB;;;gBAEEuI,OAAO,CAAC3G,MAAR,YAA0BpH,KAA9B,EAAqC;cACnC+N,OAAO,CAAC3G,MAAR,CAAe7B,OAAf,CAAuB,UAACzB,KAAD,EAAQkB,KAAR,EAAeyB,GAAf,EAAuB;gBAC5C3C,KAAK,CAACmK,WAAN,GAAoBxH,GAAG,CAACpG,MAAxB;gBACA2N,MAAM,CAACrI,IAAP,CACE,MAAI,CAACuI,aAAL,CAAmB1I,EAAnB,EAAuB1B,KAAK,CAACxE,IAA7B,oBACKyO,OADL;kBAEEhO,IAAI,EAAJA,IAFF;kBAGEqH,MAAM,EAAE,CAACtD,KAAD;mBAJZ;eAFF;;;;iBAYGkK,MAAP;SApBK,CAAP;OANF,CADK,EA8BLxO,IA9BK,CA8BA,UAAC8N,GAAD,EAAS;eACPA,GAAG,CACPlI,MADI,CACG,UAAC/B,IAAD;iBAAUA,IAAI,YAAYrD,KAA1B;SADH,EAEJwN,MAFI,CAEG,UAACW,OAAD,EAAU9H,IAAV;8CAAuB8H,OAAvB,sBAAmC9H,IAAnC;SAFH,EAE6C,EAF7C,EAGJjB,MAHI,CAGG,UAAC/B,IAAD,EAAU;cACZA,IAAI,IAAIoK,eAAe,CAACpK,IAAI,CAACqG,WAAN,CAA3B,EAA+C;mBACtC,IAAP;WADF,MAEO;YACLpJ,WAAW,WAAI+C,IAAI,CAACmG,WAAT,+BAAX;;SAPC,CAAP;OA/BK,CAAP;;;;gCAiDUA,aAAa;UACjB4E,KAAK,GAAGzN,MAAM,CAAC0N,IAAP,CAAYnB,UAAZ,CAAd;UACMc,MAAM,GAAG,EAAf;MACAI,KAAK,CAAC7I,OAAN,CAAc,UAAClC,IAAD,EAAU;YAChBiL,WAAW,GAAGpB,UAAU,CAAC7J,IAAD,CAAV,CAAiBmG,WAAjB,CAApB;QACAwE,MAAM,CAAC3K,IAAI,GAAG,QAAR,CAAN,GAA0BiL,WAA1B;QACAN,MAAM,CAAC3K,IAAD,CAAN,GAAewI,QAAQ,CAACxI,IAAD,CAAR,CAAeiL,WAAf,KAA+BA,WAA9C;OAHF;aAKON,MAAP;;;;kCAiBYxE,aAAa+E,kBAAkBC,UAAU;UAC/CvG,KAAK,GAAG,KAAKwG,WAAL,CAAiBF,gBAAjB,CAAd;;UACMnH,MAAM,GAAG,KAAKsH,aAAL,CACblF,WADa,EAEbgF,QAAQ,CAACpH,MAFI,EAGboH,QAAQ,CAACzO,IAHI,CAAf;;UAKM4O,UAAU,GAAGC,MAAQ,CAACJ,QAAQ,CAACG,UAAV,EAAsBH,QAAQ,CAACK,aAA/B,CAA3B;UACMpF,MAAM,GAAG,CACbkF,UAAU,CAACG,IADE,EAEbH,UAAU,CAACI,IAFE,EAGbJ,UAAU,CAACK,IAHE,EAIbL,UAAU,CAACM,IAJE,CAAf;UAMMC,MAAM,GAAG,CAAC,CAACzF,MAAM,CAAC,CAAD,CAAN,GAAYA,MAAM,CAAC,CAAD,CAAnB,IAA0B,CAA3B,EAA8B,CAACA,MAAM,CAAC,CAAD,CAAN,GAAYA,MAAM,CAAC,CAAD,CAAnB,IAA0B,CAAxD,CAAf;UACM0F,IAAI,GAAGR,UAAU,CAACS,gBAAX,CAA4BD,IAAzC;UACMxF,QAAQ,GAAG6E,QAAQ,CAAC7E,QAA1B;UACMD,WAAW,GAAG,EAApB;MAEAC,QAAQ,IACNA,QAAQ,CAAC0F,IADX,IAEE1F,QAAQ,CAAC0F,IAAT,CAAc9J,OAAd,CAAsB,UAAC+J,GAAD,EAAS;QAC7B5F,WAAW,CAAC/D,IAAZ,CAAiB2J,GAAG,CAACC,UAArB;OADF,CAFF;aAMO;QACL/J,EAAE,EAAE8C,MAAM,EADL;QAELmB,MAAM,EAANA,MAFK;QAGL+F,IAAI,EAAE,CAHD;QAIL1N,IAAI,EAAE,UAAUqN,IAJX;QAKLA,IAAI,EAAJA,IALK;QAMLD,MAAM,EAANA,MANK;QAOLxF,WAAW,EAAXA,WAPK;QAQLF,WAAW,EAAXA,WARK;QASLG,QAAQ,EAARA,QATK;QAUL1B,KAAK,EAALA,KAVK;QAWLwH,QAAQ,EAAE;UACRC,GAAG,EAAE,CAAC,CAAC,CAAF,EAAK,CAAC,CAAN,CADG;UAERC,GAAG,EAAE,CAAC,CAAD,EAAIhG,QAAQ,IAAIA,QAAQ,CAAC0F,IAAT,CAAchP,MAA9B,CAFG;UAGRuP,IAAI,EAAE,CAAC,CAAC,CAAF,EAAK,CAAC,CAAN;SAdH;QAgBLxI,MAAM,EAANA;OAhBF;;;;kCA2BYoC,aAAapC,QAAQrH,MAAM;aAChCqH,MAAM,CAACU,GAAP,CAAW,UAAChE,KAAD,EAAW;YACrB+L,YAAY,GAAG3C,UAAU,CAACpJ,KAAX,CAAiBA,KAAK,CAACxE,IAAvB,CAArB;eACO;UACL8I,OAAO,EAAEyD,QAAQ,CAAC/H,KAAT,CAAe+L,YAAf,KAAgCA,YADpC;UAELrG,WAAW,EAAXA,WAFK;UAGLzJ,IAAI,EAAJA,IAHK;UAILyF,EAAE,EAAE1B,KAAK,CAACxE,IAJL;UAKL+J,QAAQ,EAAEvF,KAAK,CAAC0B,EALX;UAML+D,WAAW,EAAEzF,KAAK,CAACmK,WAAN,GAAoB,CAApB,GAAwBnK,KAAK,CAAC0B,EANtC;UAOLlG,IAAI,EAAEwE,KAAK,CAACxE,IAPP;UAQLgH,MAAM,EAAE4G,UAAU,CAACpJ,KAAX,CAAiBA,KAAK,CAACxE,IAAvB,CARH;UASLwQ,KAAK,EAAE,KATF;UAULC,UAAU,EAAE;SAVd;OAFK,CAAP;;;;6BArPqC;UAAzBvG,WAAyB,uEAAX,SAAW;;UAEjC,CAACA,WAAD,IAAgB,CAACA,WAAW,CAACnJ,MAAjC,EAAyC;QACvCmJ,WAAW,GAAG,SAAd;;;UAGIwG,SAAS,GAAG,IAAI5C,SAAJ,EAAlB;UAGI6C,OAAJ;;UACIzG,WAAW,KAAK,SAApB,EAA+B;QAC7ByG,OAAO,GAAGD,SAAS,CAACE,YAAV,EAAV;OADF,MAEO;YACCxC,QAAQ,GAAGzI,YAAY,CAACuE,WAAD,CAA7B;QACAyG,OAAO,GAAGD,SAAS,CAACnC,eAAV,CAA0BH,QAA1B,CAAV;;;aAGKuC,OAAO,CAACzQ,IAAR,CAAa,UAAC8N,GAAD,EAAS;YACvBA,GAAG,CAACjN,MAAR,EAAgB;UAEd+M,SAAS,CAAC+C,eAAV,CAA0B7C,GAA1B;cAGM8C,WAAW,GAAG9C,GAAG,CAACA,GAAG,CAACjN,MAAJ,GAAa,CAAd,CAAvB;iBACO;YACLmP,IAAI,EAAEY,WAAW,CAACZ,IADb;YAELL,IAAI,EAAEiB,WAAW,CAACjB,IAFb;YAGLrN,IAAI,EAAEsO,WAAW,CAACtO,IAHb;YAIL2H,MAAM,EAAE2G,WAAW,CAAC3G,MAJf;YAKLyF,MAAM,EAAEkB,WAAW,CAAClB,MALf;YAMLxF,WAAW,EAAE0G,WAAW,CAAC1G,WANpB;YAOLzD,WAAW,EAAEqH;WAPf;SANF,MAeO;iBACE1N,OAAO,CAACC,MAAR,CAAe,aAAf,CAAP;;OAjBG,CAAP;;;;oCAgCqBwQ,aAAa;UAC5BC,mBAAmB,GAAG,EAA5B;UACIC,WAAW,GAAG5P,MAAM,CAAC0N,IAAP,CAAY7K,qBAAZ,CAAlB;MAGA+M,WAAW,CAAChL,OAAZ,CAAoB,UAAChC,GAAD,EAAS;QAC3B+M,mBAAmB,CAAC/M,GAAG,GAAG,QAAP,CAAnB,GAAsC0B,YAAY,CAChDzB,qBAAqB,CAACD,GAAD,CAD2B,CAAlD;OADF;MAKAgN,WAAW,GAAGA,WAAW,CAACzI,GAAZ,CAAgB,UAACzE,IAAD;eAAUA,IAAI,GAAG,QAAjB;OAAhB,CAAd;UAGImN,UAAJ,EAAgBC,iBAAhB,EAAmCC,SAAnC;;UACMC,aAAa,GAAG,SAAhBA,aAAgB,CAACtN,IAAD,EAAU;YACxBuN,SAAS,GAAGvN,IAAI,CAAC4E,KAAvB;YACI4I,KAAK,GAAG,CAAZ;QACAN,WAAW,CAAChL,OAAZ,CAAoB,UAAChC,GAAD,EAAS;UAC3BiN,UAAU,GAAGI,SAAS,CAACrN,GAAD,CAAtB;UACAkN,iBAAiB,GAAGH,mBAAmB,CAAC/M,GAAD,CAAvC;UACAmN,SAAS,GAAGD,iBAAiB,CAAChL,OAAlB,CAA0B+K,UAA1B,CAAZ;UACAK,KAAK,IAAIH,SAAS,KAAK,CAAC,CAAf,GAAmB,CAAnB,GAAuBA,SAAS,GAAG,CAA5C;SAJF;eAMOG,KAAP;OATF;;MAWAR,WAAW,CAACS,IAAZ,CAAiB,UAACC,CAAD,EAAIC,CAAJ,EAAU;eAClBL,aAAa,CAACI,CAAD,CAAb,GAAmBJ,aAAa,CAACK,CAAD,CAAvC;OADF;;;;;;;AC3HG,IAAMC,eAAe,GAAG,GAAxB;;ICDcC;;;gBASPpJ,GAAZ,EAAiB;;;;;;;;;;;SACVqJ,YAAL,GAAoBrJ,GAAG,CAACsJ,SAAJ,CAAc5B,IAAlC;SACK6B,cAAL,GAAsBvJ,GAAG,CAACsJ,SAAJ,CAAclC,MAApC;SACKoC,QAAL,GAAgBxJ,GAAG,CAACe,MAApB;SACK0I,IAAL,GAAYzJ,GAAZ;;;;;2BAUK/H,MAAM;UACPmP,MAAJ;;UACIM,IAAI,GAAG,KAAK8B,QAAL,CAAcxI,OAAd,EAAX;;UACI,OAAO/I,IAAP,KAAgB,QAApB,EAA8B;gBACpBA,IAAR;eACO,SAAL;YACEyP,IAAI;;;eAED,UAAL;YACEA,IAAI;;;eAED,QAAL;YACEA,IAAI,GAAG,KAAK2B,YAAZ;YACAjC,MAAM,GAAG,KAAKmC,cAAd;;;;;OAVN,MAcO;QACL7B,IAAI,GAAGzP,IAAP;;;WAEGyR,OAAL,CAAa;QAAEhC,IAAI,EAAJA,IAAF;QAAQN,MAAM,EAANA;OAArB;;;;iCAOWuC,MAAM;iBACM,CAAC,KAAKH,QAAL,CAAcI,SAAd,EAAD,EAA4B,KAAKJ,QAAL,CAAcxI,OAAd,EAA5B,CADN;UACVoG,MADU;UACFM,IADE;MAEjBiC,IAAI,CAAClM,OAAL,CAAa,UAACuC,GAAD,EAAS;QACpBA,GAAG,CAAC6J,YAAJ,CAAiBnC,IAAjB,CAAsBgC,OAAtB,CAA8B;UAAEtC,MAAM,EAANA,MAAF;UAAUM,IAAI,EAAJA;SAAxC;OADF;;;;8BAQQoC,SAAS;UACX5K,UAAU,GAAG,KAAKuK,IAAL,CAAUvK,UAA7B;UACM6K,OAAO,GAAG7K,UAAU,CACvB5B,MADa,CACN,UAAC/B,IAAD;eAAUA,IAAI,CAACwB,OAAf;OADM,EAEbiD,GAFa,CAET,UAACzE,IAAD;eAAUA,IAAI,CAAC2E,WAAL,CAAiByB,MAA3B;OAFS,CAAhB;WAGKqI,YAAL,CAAkBD,OAAlB,EAA2BD,OAA3B;;;;mCAWC;+BAFD1C,MAEC;UAFDA,MAEC,6BAFQ,KAAKoC,QAAL,CAAcI,SAAd,EAER;6BADDlC,IACC;UADDA,IACC,2BADM,KAAK8B,QAAL,CAAcxI,OAAd,EACN;;WACIwI,QAAL,CAAcE,OAAd,CAAsB;QAAEtC,MAAM,EAANA,MAAF;QAAUM,IAAI,EAAJA,IAAV;QAAgBuC,QAAQ,EAAEd;OAAhD;;;;iCAQiC;UAAxBe,QAAwB,uEAAb,EAAa;UAATJ,OAAS;UAC3BC,OAAO,GAAGG,QAAQ,CAAClK,GAAT,CAAa,UAACzE,IAAD;eAAUA,IAAI,CAAC4O,WAAL,GAAmBC,SAAnB,EAAV;OAAb,CAAhB;WACKJ,YAAL,CAAkBD,OAAlB,EAA2BD,OAA3B;;;;iCAQWC,SAAiC;UAAxBD,OAAwB,uEAAd,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,CAAc;UACtCnI,MAAM,GAAGoI,OAAO,CAACrE,MAAR,CAAe,UAAC2E,IAAD,EAAO/L,IAAP,EAAgB;eACrC+L,IAAI,GAAGvD,MAAQ,CAACuD,IAAD,EAAO/L,IAAP,CAAX,GAA0BA,IAArC;OADa,EAEZ,IAFY,CAAf;;WAGKkL,QAAL,CAAcc,GAAd,CAAkB3I,MAAlB,EAA0B;QACxB4I,mBAAmB,EAAE,IADG;QAExBC,OAAO,EAAE,IAFe;QAGxBP,QAAQ,EAAEd,eAHc;QAIxBsB,OAAO,EAAE,CAJe;QAKxBX,OAAO,EAAPA;OALF;;;;;;;ICnGiBY;;;;;yBAOI;;;QAATpO,KAAS,QAATA,KAAS;;;;;;;;+DALZ,IAAIqO,SAAJ,EAKY;;UAGhBC,MAAL,GAActO,KAAd;;UACKuO,YAAL;;;;;;;qCAIe;WACVD,MAAL,CAAYE,cAAZ,CAA2B,KAAKC,QAAhC;;;;uCAIiB;WACZH,MAAL,CAAYI,iBAAZ,CAA8B,KAAKD,QAAnC;;;;;EArBiCE;;ACItB,SAASC,UAAT,CAAoBC,MAApB,EAA4B;MACnCC,QAAQ,GAAG,SAAjB;;MACI;QACEC,SAAS,CAACC,UAAd,EAA0B;MACxBD,SAAS,CAACC,UAAV,CAAqBH,MAAM,CAACI,QAAP,EAArB,EAAwCH,QAAxC;KADF,MAEO;MACLD,MAAM,CAACK,MAAP,CAAc,UAACC,IAAD;eAAUC,MAAM,CAACD,IAAD,EAAOL,QAAP,CAAhB;OAAd;;GAJJ,CAME,OAAOO,CAAP,EAAU;IACV3F,YAAY,CAAC2F,CAAD,EAAI,KAAJ,CAAZ;;;;ACTJ,IAAM7S,QAAQ,GAAG;EACf8S,aAAa,EAAE;WACb,IAAIC,eAAJ,CAAoB;MAClBC,aAAa,EAAE,EADG;MAElBC,gBAFkB,4BAEDC,UAFC,EAEW;YACrBC,IAAI,GAAGC,MAAQ,CAACF,UAAD,EAAa,qBAAb,EAAoC,CAApC,CAArB;4BACaC,IAAb;;KAJJ,CADa;GADA;EASfE,SAAS,EAAE;WAAM,IAAIC,WAAJ,EAAN;;CATb;AAYA,AAAO,SAASC,WAAT,CAAqBC,YAArB,EAAmC;MAClCpG,MAAM,GAAG,EAAf;EACAoG,YAAY,GAAGnP,YAAY,CAACmP,YAAD,CAA3B;EACAA,YAAY,CAAC7O,OAAb,CAAqB,UAACjG,IAAD,EAAU;QACzBsB,QAAQ,CAACrB,cAAT,CAAwBD,IAAxB,CAAJ,EAAmC;MACjC0O,MAAM,CAACrI,IAAP,CAAY/E,QAAQ,CAACtB,IAAD,CAAR,EAAZ;KADF,MAEO;MACLwO,YAAY,kEAAcxO,IAAd,EAAZ;;GAJJ;SAOO0O,MAAP;;;AC7BF,IAAMqG,YAAY,GAAG,CAAC,SAAD,EAAY,QAAZ,EAAsB,QAAtB,CAArB;AAKA,AAAO,SAASC,kBAAT,CAA4BC,GAA5B,EAAiC;MAChCvG,MAAM,GAAG,EAAf;MACI3K,IAAJ;;OACK,IAAIE,GAAT,IAAgBgR,GAAhB,EAAqB;QACfA,GAAG,CAAChV,cAAJ,CAAmBgE,GAAnB,CAAJ,EAA6B;MAC3BF,IAAI,GAAGkR,GAAG,CAAChR,GAAD,CAAV;;UACI8Q,YAAY,CAAC/O,QAAb,SAA6BjC,IAA7B,EAAJ,EAAwC;QACtC2K,MAAM,CAACzK,GAAD,CAAN,GAAcF,IAAd;;;;;SAIC2K,MAAP;;;ACbK,SAASwG,iBAAT,CAA2BnU,MAA3B,EAAmC;MACpCoU,MAAJ;;MACIpU,MAAM,GAAG,GAAb,EAAkB;IAChBoU,MAAM,GAAGC,IAAI,CAACC,KAAL,CAAYtU,MAAM,GAAG,IAAV,GAAkB,GAA7B,IAAoC,GAApC,GAA0C,GAA1C,GAAgD,IAAzD;GADF,MAEO;IACLoU,MAAM,GAAGC,IAAI,CAACC,KAAL,CAAWtU,MAAM,GAAG,GAApB,IAA2B,GAA3B,GAAiC,GAAjC,GAAuC,GAAhD;;;SAEKoU,MAAP;;AAMF,AAAO,SAASG,kBAAT,CAA4BC,IAA5B,EAAkC;MACnCJ,MAAJ;;MACII,IAAI,GAAG,KAAX,EAAkB;IAChBJ,MAAM,GAAGC,IAAI,CAACC,KAAL,CAAYE,IAAI,GAAG,OAAR,GAAmB,GAA9B,IAAqC,GAArC,GAA2C,GAA3C,GAAiD,IAA1D;GADF,MAEO;IACLJ,MAAM,GAAGC,IAAI,CAACC,KAAL,CAAWE,IAAI,GAAG,GAAlB,IAAyB,GAAzB,GAA+B,GAA/B,GAAqC,GAA9C;;;SAEKJ,MAAP;;;IC8BmBK;;;oBAUP1Q,KAAZ,EAAmB;;;4CARF,IAAI2Q,QAAJ,EAQE;;;;4CAJF,SAIE;;+CAHC,CAGD;;qDAFO,IAEP;;SACZC,eAAL,GAAuB5Q,KAAK,CAAC6Q,SAAN,GAAkBvS,KAAzC;;;;;iCAQuB;;;UAAdqP,QAAc,uEAAH,CAAG;UACjB3N,KAAK,GAAG,KAAKA,KAAnB;UACI,KAAK8Q,iBAAT,EAA4BC,oBAAoB,CAAC,KAAKD,iBAAN,CAApB;WACvBA,iBAAL,GAAyBE,UAAU,CAAC,YAAM;QACxC,KAAI,CAACF,iBAAL,GAAyB,CAAzB;OADiC,EAEhCnD,QAFgC,CAAnC;;UAGMsD,iBAAiB,GAAG,SAApBA,iBAAoB,GAAM;YAC1B,KAAI,CAACH,iBAAT,EAA4B;UAC1B9Q,KAAK,CAACkR,UAAN;UACAC,qBAAqB,CAACF,iBAAD,CAArB;;OAHJ;;MAMAE,qBAAqB,CAACF,iBAAD,CAArB;;;;kCAMY;WACPjR,KAAL,CAAWoR,IAAX,CAAgB,gBAAhB,EAAkC,UAACC,KAAD;eAChCzC,UAAU,CAACyC,KAAK,CAACC,OAAN,CAAczC,MAAf,CADsB;OAAlC;WAGK7O,KAAL,CAAWuR,UAAX;;;;wCAQ4C;UAA5B5V,IAA4B,uEAArB,KAAK6V,cAAgB;WACvCA,cAAL,GAAsB,KAAKZ,eAAL,CAAqBa,MAA3C;WACKb,eAAL,CAAqBa,MAArB,GAA8B9V,IAA9B;;;;mCAQa+V,OAAOC,cAAc;;;UAC9BD,KAAJ,EAAW;YACHlV,QAAQ,GAAGuT,WAAW,CAAC4B,YAAD,CAA5B;QACAnV,QAAQ,CAAC2E,OAAT,CAAiB,UAAClC,IAAD,EAAO2B,KAAP,EAAiB;UAChC,MAAI,CAACZ,KAAL,CAAW4R,UAAX,CAAsB3S,IAAtB;;UACA,MAAI,CAACzC,QAAL,CAAcmV,YAAY,CAAC/Q,KAAD,CAA1B,IAAqC3B,IAArC;SAFF;OAFF,MAMO;YACD,CAAC0S,YAAD,IAAiB,CAACA,YAAY,CAAC1V,MAAnC,EAA2C;UACzC0V,YAAY,GAAGpV,MAAM,CAAC0N,IAAP,CAAY,KAAKzN,QAAjB,CAAf;;;QAEFmV,YAAY,CAACxQ,OAAb,CAAqB,UAAClC,IAAD,EAAU;cACzB,MAAI,CAACzC,QAAL,CAAcrB,cAAd,CAA6B8D,IAA7B,CAAJ,EAAwC;YACtC,MAAI,CAACe,KAAL,CAAW6R,aAAX,CAAyB,MAAI,CAACrV,QAAL,CAAcyC,IAAd,CAAzB;;mBACO,MAAI,CAACzC,QAAL,CAAcyC,IAAd,CAAP;;SAHJ;;;;;8CAa2D;UAAvCyS,KAAuC,uEAA/B,CAAC,KAAKI,uBAAyB;WACxDA,uBAAL,GAA+BJ,KAA/B;WACKK,iBAAL,CAAuBC,SAAvB,CAAiCN,KAAjC;;;;iCAQWO,OAAO;UAEZC,QAAQ,qBAAQD,KAAR,CAAd;;kCACmC,KAAKE,oBAAL,CACjCD,QAAQ,CAAC7M,MADwB,CAHjB;UAGV0B,QAHU,yBAGVA,QAHU;UAGAC,YAHA,yBAGAA,YAHA;;MAOlBkL,QAAQ,CAACnL,QAAT,GAAoBqL,IAAI,CAACC,SAAL,CAAetL,QAAf,CAApB;MACAmL,QAAQ,CAAClL,YAAT,GAAwBA,YAAxB;aACOkL,QAAQ,CAAC7M,MAAhB;aAEOwB,gBAAgB,CAACqL,QAAD,CAAvB;;;;uCASiBpP,SAA0B;UAAjBwP,UAAiB,uEAAJ,EAAI;UACrClQ,IAAI,GAAG,KAAKQ,UAAL,CAAgBQ,IAAhB,CAAqB,UAACnE,IAAD;eAAUA,IAAI,CAACmC,EAAL,KAAY0B,OAAtB;OAArB,CAAb;;UACIV,IAAJ,EAAU;YACFmQ,UAAU,GAAGnQ,IAAI,CAACpD,MAAxB;YACMwT,eAAe,GAAGpQ,IAAI,CAACwB,WAA7B;;UAEEwB,WAAW,EAAEmN,UAAU,CAACnN,WAD1B;UAEEtC,OAAO,EAAEyP,UAAU,CAACtN,QAFtB;UAGE6B,OAAO,EAAE0L,eAAe,CAACzH,IAH3B;UAIE1F,MAAM,EAAEmN,eAAe,CAACnN;WACrBiN,UALL;OAHF,MAUO;QACLpW,WAAW,gDAAW4G,OAAX,EAAX;eACO,IAAP;;;;;kCASUA,SAAS;aACd,KAAK2P,YAAL,CACL,KAAKC,kBAAL,CAAwB5P,OAAxB,EAAiC;QAAEqE,cAAc,EAAE;OAAnD,CADK,EAEL/L,IAFK,CAEA,UAAC8N,GAAD,EAAS;eACPA,GAAG,CAACyJ,MAAJ,CACJjP,GADI,CACA,UAACzE,IAAD,EAAU;iBACN;YACL2T,KAAK,EAAE3T,IAAI,CAAC/D,IADP;YAELwQ,KAAK,EAAEzM,IAAI,CAAC4E;WAFd;SAFG,EAOJ7C,MAPI,CAOG,UAACkI,GAAD;iBAASA,GAAG,CAAC0J,KAAb;SAPH,CAAP;OAHK,CAAP;;;;uCAoBiB9P,SAAS+P,OAAO;aAC1B,KAAKJ,YAAL,CACL,KAAKC,kBAAL,CAAwB5P,OAAxB,EAAiC;QAC/BoE,SAAS,EAAE2L,KADoB;QAE/B1L,cAAc,EAAE;OAFlB,CADK,EAKL/L,IALK,CAKA,UAAC8N,GAAD,EAAS;YACRU,MAAM,GAAG,IAAIkJ,GAAJ,EAAf;YACMlF,QAAQ,GAAG1E,GAAG,CAAC0E,QAArB;YACImF,UAAJ;QACAnF,QAAQ,CAACzM,OAAT,CACwC,UAAClC,IAAD,EAAU;UAC9C8T,UAAU,GAAGtW,MAAM,CAACwC,IAAI,CAAC+T,UAAL,CAAgBH,KAAhB,CAAD,CAAN,CAA+BI,IAA/B,EAAb;UACAF,UAAU,IAAInJ,MAAM,CAACsJ,GAAP,CAAWH,UAAX,CAAd;SAHJ;eAMOnX,KAAK,CAACuX,IAAN,CAAWvJ,MAAX,EAAmBlG,GAAnB,CAAuB,UAACzE,IAAD;iBAAW;YAAE2T,KAAK,EAAE3T,IAAT;YAAeyM,KAAK,EAAEzM;WAAjC;SAAvB,CAAP;OAfK,CAAP;;;;uCAwBiBmU,aAAa;aACK,KAAKC,cAAL,CAAoBC,YAApB,CACjCF,WADiC,CAAnC;;;;sCAUgBA,aAAa;UACvBxF,QAAQ,GAAG,KAAK2F,kBAAL,CAAwBH,WAAxB,CAAjB;WACKI,UAAL,CAAgB5F,QAAhB;aAEOA,QAAP;;;;+BAOS6F,SAAS;UACZC,YAAY,GAAG,KAAKA,YAA1B;MACAD,OAAO,GAAG5S,YAAY,CAAC4S,OAAD,CAAtB;MACAA,OAAO,CAACtS,OAAR,CAAgB,UAAClC,IAAD,EAAU;YACpBA,IAAI,IAAI,CAACyU,YAAY,CAACC,UAAb,CAAwB1U,IAAxB,CAAb,EAA4C;UAC1CyU,YAAY,CAACF,UAAb,CAAwBvU,IAAxB;;OAFJ;;;;kCAWYwU,SAAS;UACfC,YAAY,GAAG,KAAKA,YAA1B;MACAD,OAAO,GAAG5S,YAAY,CAAC4S,OAAD,CAAtB;MACAA,OAAO,CAACtS,OAAR,CAAgB,UAAClC,IAAD,EAAU;YACpBA,IAAI,IAAIyU,YAAY,CAACC,UAAb,CAAwB1U,IAAxB,CAAZ,EAA2C;UACzCyU,YAAY,CAACE,aAAb,CAA2B3U,IAA3B;;OAFJ;;;;iCAYWwU,SAAS;WACfI,eAAL,CAAqBJ,OAArB;WACKD,UAAL,CAAgBC,OAAhB;WACKlG,YAAL,CAAkBnC,IAAlB,CAAuB0I,UAAvB,CAAkC,CAACL,OAAD,CAAlC;aACOA,OAAP;;;;oCAYyB;;;UAAbM,MAAa,uEAAJ,EAAI;UACjBC,QADiB,GACJD,MADI,CACjBC,QADiB;;UAErBC,cAAc,GAAG,wBAACvU,KAAD;eAAWA,KAAK,CAACe,OAAjB;OAArB;;UACI4I,eAAe,CAAC2K,QAAD,CAAnB,EAA+B;aACxBE,WAAL,CAAiBF,QAAjB,EAA2B,IAA3B;;QACAC,cAAc,GAAG,wBAACvU,KAAD;iBAAWsU,QAAQ,CAAC9S,QAAT,CAAkBxB,KAAK,CAAC0B,EAAxB,CAAX;SAAjB;;;UAEEpC,MAAJ,EAAY4E,WAAZ;UACMuQ,UAAU,GAAG,KAAKvR,UAAL,CAAgB5B,MAAhB,CAAuBiT,cAAvB,EAAuCvQ,GAAvC,CAA2C,UAAChE,KAAD,EAAW;QACvEV,MAAM,GAAGU,KAAK,CAACV,MAAf;QACA4E,WAAW,GAAGlE,KAAK,CAACkE,WAApB;eACO,MAAI,CAAC6O,YAAL,CAAkB;UACvBrN,WAAW,EAAEpG,MAAM,CAACoG,WADG;UAEvBtC,OAAO,EAAE9D,MAAM,CAACiG,QAFO;UAGvB6B,OAAO,EAAElD,WAAW,CAACmH,IAHE;UAIvB1F,MAAM,EAAE0O,MAAM,CAAC1O,MAAP,IAAiBzB,WAAW,CAACyB,MAJd;UAKvB4B,KAAK,EAAE8M,MAAM,CAAC9M;SALT,EAMJ7L,IANI,CAMC,UAAC8N,GAAD,EAAS;cACXA,GAAG,IAAI,CAACA,GAAG,CAACkL,KAAhB,EAAuB;gBACfxG,QAAQ,GAAG,MAAI,CAAC2F,kBAAL,CAAwBrK,GAAxB,CAAjB;;gBACImL,UAAJ,EAAgBC,GAAhB;mBACO;cACLlT,EAAE,EAAE1B,KAAK,CAAC0B,EADL;cAELlG,IAAI,EAAEwE,KAAK,CAACxE,IAFP;cAGLoI,QAAQ,EAAEsK,QAAQ,CAAClK,GAAT,CAAa,UAAC+P,OAAD,EAAa;gBAClCY,UAAU,GAAGnE,kBAAkB,CAACuD,OAAO,CAACc,aAAR,EAAD,CAA/B;gBACAD,GAAG,GAAGD,UAAU,CAACC,GAAjB;;oBAEI,CAACA,GAAD,IAAQA,GAAG,KAAK,CAApB,EAAuB;kBACrBpY,WAAW,CAAC,2BAAD,EAA8BmY,UAA9B,CAAX;kBACAC,GAAG,GAAGD,UAAU,CAACC,GAAX,GAAiBD,UAAU,CAACG,QAAlC;kBACAf,OAAO,CAACgB,GAAR,CAAY,KAAZ,EAAmBH,GAAnB;;;uBAGK;kBACLlT,EAAE,EAAEkT,GADC;kBAELpZ,IAAI,EAAEoZ,GAFD;kBAGLD,UAAU,EAAVA;iBAHF;eAVQ,CAHL;cAmBLzG,QAAQ,EAARA;aAnBF;WAHF,MAwBO;mBACEpS,OAAO,CAACC,MAAR,CAAeyN,GAAf,CAAP;;SAhCG,CAAP;OAHiB,CAAnB;aAuCO1N,OAAO,CAACyN,GAAR,CAAYkL,UAAZ,EAAwB/Y,IAAxB,CACoB,UAAC+B,IAAD,EAAU;YAC7ByQ,QAAQ,GAAG,EAAf;QACAzQ,IAAI,GAAGA,IAAI,CAAC6D,MAAL,CAAY,UAAC/B,IAAD;iBAAUoK,eAAe,CAACpK,IAAI,CAACqE,QAAN,CAAzB;SAAZ,CAAP;;YACInG,IAAI,CAAClB,MAAT,EAAiB;UACf2R,QAAQ,GAAGzQ,IAAI,CAACiM,MAAL,CACT,UAAC2E,IAAD,EAAO9L,IAAP;gDAAoB8L,IAApB,sBAA6B9L,IAAI,CAAC2L,QAAlC;WADS,EAET,EAFS,CAAX;;UAIA,MAAI,CAAC8G,YAAL;;UACA,MAAI,CAAClB,UAAL,CAAgB5F,QAAhB;;UACA,MAAI,CAACL,YAAL,CAAkBnC,IAAlB,CAAuB0I,UAAvB,CAAkClG,QAAlC;;;eAEK;UAAEA,QAAQ,EAARA,QAAF;UAAYzQ,IAAI,EAAJA;SAAnB;OAbG,EAeL,UAACiX,KAAD,EAAW;eACF5Y,OAAO,CAACC,MAAR,CAAe2Y,KAAf,CAAP;OAhBG,CAAP;;;;kCAyBYX,SAAS;;;WAChBkB,kBAAL;UACM/G,QAAQ,GAAG/M,YAAY,CAAC4S,OAAD,CAA7B;MACA7F,QAAQ,CAACzM,OAAT,CAAiB,UAAClC,IAAD;eAAU,MAAI,CAAC2V,gBAAL,CAAsBrT,IAAtB,CAA2BtC,IAA3B,CAAV;OAAjB;;;;oCAUcwU,SAAuB;UAAdnX,OAAc,uEAAJ,EAAI;UAC/BsR,QAAQ,GAAG/M,YAAY,CAAC4S,OAAD,CAA7B;MACA3U,WAAW,CACT;QACE+V,SAAS,EAAE;UACTC,KAAK,EAAE;SAFX;QAIEC,WAAW,EAAE;UACXD,KAAK,EAAE,SADI;UAEXE,KAAK,EAAE;;OAPF,EAUT1Y,OAVS,CAAX;MAYAsR,QAAQ,CAACzM,OAAT,CAAiB,UAACsS,OAAD;eACfA,OAAO,CAACwB,QAAR,CACE,IAAIC,KAAJ,CAAU;UACRC,IAAI,EAAE,IAAIC,IAAJ,CAAS9Y,OAAO,CAACuY,SAAjB,CADE;UAERQ,MAAM,EAAE,IAAIC,MAAJ,CAAWhZ,OAAO,CAACyY,WAAnB;SAFV,CADF,CADe;OAAjB;;;;yCAWmB;WACdH,gBAAL,CAAsBW,KAAtB;;;;mCAMa;WACRZ,kBAAL;WACKjB,YAAL,CAAkB6B,KAAlB;;;;4BAQM;WAEDvV,KAAL,CAAWwV,WAAX,GAAyBD,KAAzB;WAGKb,YAAL;WAGKjT,QAAL,CAAcC,QAAd,CAAuB,OAAvB;;;;yCAOmB+T,cAAc;UAC7B1O,QAAQ,GAAG,EAAf;UACIC,YAAY,GAAG,EAAnB;;UACIpL,KAAK,CAAC8Z,OAAN,CAAcD,YAAd,CAAJ,EAAiC;QAC/BzO,YAAY,GAAG,sBAAf;QACAD,QAAQ,GAAG;UACT2D,IAAI,EAAE+K,YAAY,CAAC,CAAD,CADT;UAET9K,IAAI,EAAE8K,YAAY,CAAC,CAAD,CAFT;UAGT7K,IAAI,EAAE6K,YAAY,CAAC,CAAD,CAHT;UAIT5K,IAAI,EAAE4K,YAAY,CAAC,CAAD;SAJpB;OAFF,MAQO;YACC9Z,IAAI,GAAG8Z,YAAY,CAACE,OAAb,EAAb;QACA3O,YAAY,GACVrL,IAAI,KAAK,SAAT,GACI,qBADJ,GAEIA,IAAI,KAAK,OAAT,GACA,mBADA,GAEA,sBALN;QAMAoL,QAAQ,GAAG,KAAKsM,cAAL,CAAoBuC,mBAApB,CAAwCH,YAAxC,CAAX;;;MAGF1O,QAAQ,CAACiE,gBAAT,GAA4B;QAC1BD,IAAI,EAAE,KAAKiC,SAAL,CAAejC;OADvB;aAIO;QACL/D,YAAY,EAAZA,YADK;QAELD,QAAQ,EAARA;OAFF;;;;uCAWiBA,UAAU;UACrBpL,IAAI,GAAGoL,QAAQ,CAAC4O,OAAT,EAAb;UACM5B,MAAM,GAAG;QAAEvO,UAAU,EAAE,KAAKwH,SAAL,CAAetP;OAA5C;UACImY,GAAG,GAAG,EAAV;UACEtP,GAAG,GAAG,CADR;;cAEQ5K,IAAR;aACO,SAAL;UACE4K,GAAG,GAAGuP,OAAO,CAAC/O,QAAD,EAAWgN,MAAX,CAAb;UACA8B,GAAG,GAAGrF,kBAAkB,CAACjK,GAAD,CAAxB;;;aAEG,YAAL;UACEA,GAAG,GAAGwP,SAAS,CAAChP,QAAD,EAAWgN,MAAX,CAAf;UACA8B,GAAG,GAAGzF,iBAAiB,CAAC7J,GAAD,CAAvB;;;;;;aAIG;QAAEsP,GAAG,EAAHA,GAAF;QAAOtP,GAAG,EAAHA;OAAd;;;;;;;ICzdiByP;;;;;gBAiBPtS,GAAZ,EAAiB;;;;;8EACT,mBAAN;;;;;;;;;;;;;;;;+DAVS,QASM;;sEARC,UAQD;;0EAPK,WAOL;;uEANE,UAMF;;oEALD,CAAC,SAAD,EAAY,YAAZ,EAA0B,QAA1B,EAAoC,OAApC,CAKC;;;;;;gEAFL,EAEK;;UAGVyJ,IAAL,GAAYzJ,GAAZ;UACK4K,MAAL,GAAc5K,GAAG,CAAC1D,KAAlB;UACKiW,SAAL,GAAiBvS,GAAG,CAAC1D,KAAJ,CAAUkW,WAAV,EAAjB;UACKC,aAAL,GAAqBzS,GAAG,CAACgQ,YAAzB;UAGK0C,mBAAL,GAA2B,MAAKA,mBAAL,CAAyBC,IAAzB,+BAA3B;UACKC,uBAAL,GAA+B,MAAKA,uBAAL,CAA6BD,IAA7B,+BAA/B;IAEA3S,GAAG,CAACjC,QAAJ,CAAanB,EAAb,CAAgB,OAAhB,EAAyB;aAAM,MAAKiV,KAAL,EAAN;KAAzB;;;;;;mCAQa5Z,MAAM4a,YAAY;UAE3B,CAAC,KAAKC,aAAL,CAAmBtV,QAAnB,CAA4BvF,IAA5B,CAAL,EAAwC;eAC/B+N,YAAY,WACd/N,IADc,mGACS,KAAK6a,aADd,EAAnB;;;WAMGC,kBAAL;;WAGKnI,MAAL,CAAYhO,EAAZ,CAAe,aAAf,EAA8B,KAAK8V,mBAAnC;;WACKH,SAAL,CAAeS,gBAAf,CAAgC,UAAhC,EAA4C,KAAKJ,uBAAjD;;WAGKK,eAAL,CAAqBhb,IAArB,EAA2B4a,UAA3B;;;;uCAMiB;WAEZK,kBAAL;;WAGKtI,MAAL,CAAYuI,EAAZ,CAAe,aAAf,EAA8B,KAAKT,mBAAnC;;WACKH,SAAL,CAAea,mBAAf,CACE,UADF,EAEE,KAAKR,uBAFP;;WAMKS,kBAAL;;;;4BAMM;WACD5J,IAAL,CAAUyG,aAAV,CAAwB,KAAKoD,SAA7B;;WACKA,SAAL,GAAiB,EAAjB;;;;8CAOwB;WACnBC,mBAAL,CAAyBC,SAAzB,CAAmChE,GAAnC,CAAuC,eAAvC;;;;wCAQkBiE,KAAK;UACnBA,GAAG,CAACC,QAAR,EAAkB;;;;UAIdC,OAAO,GAAG,KAAKC,QAAnB;;cACQ,KAAKC,YAAb;aACO,YAAL;UACEF,OAAO,GAAG,KAAKG,gBAAf;;;aAEG,SAAL;UACEH,OAAO,GAAG,KAAKI,mBAAf;;;aAEG,QAAL;UACEJ,OAAO,GAAG,KAAKK,eAAf;;;;;;UAKA,KAAKC,gBAAL,IAAyBN,OAA7B,EAAsC;aAC/BO,YAAL,CAAkBC,WAAlB,CAA8BV,GAAG,CAACzH,UAAlC;;aACKuH,mBAAL,CAAyBa,SAAzB,GAAqCT,OAArC;;aACKJ,mBAAL,CAAyBC,SAAzB,CAAmCa,MAAnC,CAA0C,eAA1C;OAHF,MAIO;aACAd,mBAAL,CAAyBC,SAAzB,CAAmChE,GAAnC,CAAuC,eAAvC;;;;;oCAUYvX,MAAM4a,YAAY;;;UAC1B7S,GAAG,GAAG,KAAKyJ,IAAjB;WAEKwK,gBAAL,GAAwB,CAACpB,UAAzB;WAEKyB,KAAL,GAAa,IAAIC,MAAJ,CAAW;QACtBlZ,MAAM,EAAE,KAAKoX,aADS;QAEtBxa,IAAI,EAAEA,IAFgB;QAGtBuc,QAAQ,EAAE3B;OAHC,CAAb;;WAKKjI,MAAL,CAAYE,cAAZ,CAA2B,KAAKwJ,KAAhC;;WAEKA,KAAL,CAAW1X,EAAX,CAAc,WAAd,EAA2B,UAAC6W,GAAD,EAAS;QAClCzT,GAAG,CAACyU,uBAAJ,CAA4B,KAA5B;;QACA,MAAI,CAACzW,QAAL,CAAc,WAAd,EAA2B,MAAI,CAAC0W,gBAAL,CAAsBjB,GAAtB,CAA3B;;QACA,MAAI,CAACI,YAAL,GAAoB5b,IAApB;OAHF;;WAKKqc,KAAL,CAAW1X,EAAX,CAAc,SAAd,EAAyB,UAAC6W,GAAD,EAAS;QAChC,MAAI,CAACH,SAAL,CAAezV,IAAf,CAAoB4V,GAAG,CAAC1D,OAAxB;;QACA/P,GAAG,CAACyU,uBAAJ,CAA4B,IAA5B;QAEAnH,UAAU,CAAC;iBAAM,MAAI,CAACtP,QAAL,CAAc,SAAd,EAAyB,MAAI,CAAC0W,gBAAL,CAAsBjB,GAAtB,CAAzB,CAAN;SAAD,EAA6D,CAA7D,CAAV;QACA,MAAI,CAACI,YAAL,GAAoB,EAApB;OALF;;;;yCAamB;WACdjJ,MAAL,CAAYI,iBAAZ,CAA8B,KAAKsJ,KAAnC;;WACKA,KAAL,GAAa,IAAb;;;;yCAOmB;WACdf,mBAAL,GAA2B9Y,QAAQ,CAACI,aAAT,CAAuB,KAAvB,CAA3B;WACK0Y,mBAAL,CAAyBoB,SAAzB,GAAqC,sCAArC;WACKT,YAAL,GAAoB,IAAIU,OAAJ,CAAY;QAC9BC,OAAO,EAAE,KAAKtB,mBADgB;QAE9BuB,MAAM,EAAE,CAAC,EAAD,EAAK,CAAL,CAFsB;QAG9BC,WAAW,EAAE;OAHK,CAApB;;WAKKnK,MAAL,CAAYoK,UAAZ,CAAuB,KAAKd,YAA5B;;;;yCAOmB;WACdX,mBAAL,GAA2B,IAA3B;;WACK3I,MAAL,CAAYqK,aAAZ,CAA0B,KAAKf,YAA/B;;WACKA,YAAL,GAAoB,IAApB;;;;qCAOeT,KAAK;UACdpQ,QAAQ,GAAGoQ,GAAG,CAAC1D,OAAJ,CAAY5F,WAAZ,EAAjB;UACMlS,IAAI,GAAGoL,QAAQ,CAAC4O,OAAT,EAAb;UACMtQ,MAAM,GACV1J,IAAI,KAAK,SAAT,GACI,KAAKwR,IAAL,CAAUkG,cAAV,CAAyBuF,aAAzB,CAAuC7R,QAAvC,CADJ,GAEIA,QAAQ,CAAC+G,SAAT,EAHN;aAIO;QACL/G,QAAQ,EAARA,QADK;QAELpL,IAAI,EAAJA,IAFK;QAGL0J,MAAM,EAANA;OAHF;;;;;EAxM8BwT,UAAU,CAACC,QAAD,EAAWnK,YAAX;;ICfvBoK;;;;;oBASPrV,GAAZ,EAAiB;;;;;kFACT,iBAAN;;;;;;+DAPS;MACTsV,GAAG,EAAE,IADI;MAETC,MAAM,EAAE,KAFC;MAGTC,SAAS,EAAEC;KAGI;;UAGVhM,IAAL,GAAYzJ,GAAZ;UACK4K,MAAL,GAAc5K,GAAG,CAAC1D,KAAlB;;;;;;iCAMW0R,OAAO/V,MAAM;UAClBqd,GAAG,GAAGrd,IAAI,KAAK,SAArB;;UACI+V,KAAJ,EAAW;aACJ0H,QAAL,CAAcJ,GAAd;OADF,MAEO;aACAK,UAAL;;;;;mCAKWL,KAAK;;;WACbM,QAAL,CAAcN,GAAd,GAAoBA,GAApB;;WACK1K,MAAL,CAAYE,cAAZ,CACG,KAAK+K,SAAL,GAAiB,IAAIC,UAAJ,CAAe,KAAKF,QAApB,CADpB;;WAGKC,SAAL,CAAejZ,EAAf,CAAkB,UAAlB,EAA8B,UAAC+O,CAAD;eAAO,MAAI,CAAC3N,QAAL,CAAc,UAAd,EAA0B2N,CAA1B,CAAP;OAA9B;;WACKkK,SAAL,CAAejZ,EAAf,CAAkB,QAAlB,EAA4B,UAAC+O,CAAD;eAAO,MAAI,CAAC3N,QAAL,CAAc,QAAd,EAAwB2N,CAAxB,CAAP;OAA5B;;WACKlC,IAAL,CAAUsM,iBAAV,CAA4BT,GAAG,GAAG,UAAH,GAAgB,SAA/C;;;;uCAIiB;WACZM,QAAL,CAAcN,GAAd,GAAoB,IAApB;;WACK1K,MAAL,CAAYI,iBAAZ,CAA8B,KAAK6K,SAAnC;;WACKpM,IAAL,CAAUsM,iBAAV;;;;;EA3CkCZ,UAAU,CAACC,QAAD,EAAWnK,YAAX;;ACHjC,SAAS+K,YAAT,CAAsBpI,OAAtB,EAA+BqI,eAA/B,EAAgD;EAC7DrI,OAAO,CAACsI,aAAR,GAAwBtI,OAAO,CAACsI,aAAR,IAAyBpe,OAAO,CAACqe,OAAR,EAAjD;SACO,CAACvI,OAAO,CAACsI,aAAR,GAAwBtI,OAAO,CAACsI,aAAR,CAAsBxe,IAAtB,CAA2B,YAAM;WACxDue,eAAe,EAAtB;GAD8B,CAAzB,EAEHve,IAFG,CAEE,UAAC8N,GAAD,EAAS;IAChBoI,OAAO,CAACsI,aAAR,GAAwBpe,OAAO,CAACqe,OAAR,EAAxB;WACO3Q,GAAP;GAJK,CAAP;;;ACsBF,IAAI4Q,KAAK,GAAG,CAAZ;;IAQqBC;;;;;qBAqB4B;;;QAAjC/Z,KAAiC,QAAjCA,KAAiC;QAA1B7D,YAA0B,QAA1BA,YAA0B;QAAZK,QAAY,QAAZA,QAAY;;;;6EACvCwD,KAAN;;yDArBG8Z,KAAK,EAoBqC;;;;;;;;mEAhBhC,EAgBgC;;+DAfpC,EAeoC;;+DAdpC,IAAIhB,QAAJ,CAAa,+BAAb,CAcoC;;8DAXrC,EAWqC;;wEAR3B,IAAIkB,MAAJ,EAQ2B;;mEAPhC,IAAIC,YAAJ,EAOgC;;kEANjC,IAAIC,WAAJ,CAAgB;MAC5Bnb,MAAM,EAAE,MAAK2U,YADe;MAE5BhR,MAAM,EAAE;KAFI,CAMiC;;;;UAGxC1C,KAAL,GAAaA,KAAb;IAGAA,KAAK,CAACwO,cAAN,CAAqB,MAAKuD,iBAA1B;IACA/R,KAAK,CAACgF,QAAN,CAAe,MAAKmV,WAApB;UACKvF,gBAAL,GAAwB,MAAK7C,iBAAL,CAAuBqI,WAAvB,EAAxB;;UAGKC,cAAL,CAAoBle,YAApB,EAAkCK,QAAlC;;;;;;;gCAGyC;;;UAApC4I,WAAoC,SAApCA,WAAoC;UAAvB1E,UAAuB,SAAvBA,UAAuB;UAAXlG,OAAW,SAAXA,OAAW;aAClCwO,SAAS,CAACsR,MAAV,CAAiBlV,WAAjB,EACJhK,IADI,CACC,UAAC4R,SAAD,EAAe;QACnB,MAAI,CAACA,SAAL,GAAiBA,SAAjB;;QAGA,MAAI,CAACuN,QAAL;;QAEA,MAAI,CAACC,eAAL,CAAqBxN,SAAS,CAACnL,WAA/B,EAA4CnB,UAA5C;;QAEA,MAAI,CAAC6M,YAAL,GAAoB;UAClBnC,IAAI,EAAE,IAAI0B,IAAJ,CAAS,MAAT,CADY;UAElB2N,OAAO,EAAE,IAAIrM,OAAJ,CAAY,MAAZ,CAFS;UAGlBsM,YAAY,EAAE,IAAIC,YAAJ,CAAiB,MAAjB,CAHI;UAIlBC,IAAI,EAAE,IAAI5E,IAAJ,CAAS,MAAT,CAJY;UAKlB6E,QAAQ,EAAE,IAAI9B,QAAJ,CAAa,MAAb;SALZ;eAQO,MAAI,CAAC+B,WAAL,CAAiBtgB,OAAjB,EAA0BY,IAA1B,CAA+B;iBAAM,MAAN;SAA/B,CAAP;OAjBG,EAmBJ2f,KAnBI,CAmBErR,YAnBF,CAAP;;;;+BAuBS;UACHsD,SAAS,GAAG,KAAKA,SAAvB;UAGMxH,UAAU,GAAG,IAAIwV,UAAJ,CAAsB;QACvCtU,IAAI,EAAEsG,SAAS,CAACtP,IADuB;QAEvCud,eAAe,EAAE;OAFA,CAAnB;MAIAzV,UAAU,CAAC0V,SAAX,CAAqBlO,SAAS,CAAC3H,MAA/B;WAEKrF,KAAL,CAAWmb,OAAX,CACG,KAAK1W,MAAL,GAAc,IAAI2W,MAAJ,CAAW;QACxBtQ,MAAM,EAAEkC,SAAS,CAAClC,MADM;QAExBzF,MAAM,EAAE2H,SAAS,CAAC3H,MAFM;QAGxB+F,IAAI,EAAE4B,SAAS,CAAC5B,IAHQ;QAIxB5F,UAAU,EAAVA,UAJwB;QAKxBF,WAAW,EAAE0H,SAAS,CAAC1H;OALV,CADjB;;;;gCAgBU9K,SAAS;;;WACdA,OAAL,GAAe,EAAf;aACOgB,OAAO,CAACyN,GAAR,CACLrN,KAAK,CAACuX,IAAN,CAAW3Y,OAAX,EAAoBkJ,GAApB,CAAwB,UAAC2X,UAAD,EAAgB;eAC/BpgB,SAAS,CAACogB,UAAD,CAAT,CAAsBjgB,IAAtB,CAA2B,UAACC,MAAD,EAAY;UAC5C,MAAI,CAACb,OAAL,CAAa8gB,SAAS,CAACD,UAAD,CAAtB,IAAsC,IAAIhgB,MAAJ,CAAW,MAAX,CAAtC;SADK,CAAP;OADF,CADK,CAAP;;;;kCAyCC;UAVDkgB,MAUC,SAVDA,MAUC;oCATDnW,WASC;UATDA,WASC,kCATa,EASb;iCARDqC,QAQC;UARDA,QAQC,+BARU,EAQV;mCAPD/G,UAOC;UAPDA,UAOC,iCAPY,EAOZ;gCANDlG,OAMC;UANDA,OAMC,8BANS,EAMT;qCALD2B,YAKC;UALDA,YAKC,mCALc,IAKd;iCAJDK,QAIC;UAJDA,QAIC,+BAJU,EAIV;wCAHD4C,qBAGC;UAHDA,qBAGC,sCAHuB,EAGvB;mCAFD3B,UAEC;UAFDA,UAEC,iCAFY,EAEZ;wCADDkC,kBACC;UADDA,kBACC,sCADoB,EACpB;;UACG,CAAC4b,MAAL,EAAa;eACJ/f,OAAO,CAACC,MAAR,CAAe,mBAAf,CAAP;;;aAIKie,YAAY,CAAC6B,MAAD,EAAS,YAAM;YAC1BC,QAAQ,GAAGD,MAAM,CAACE,gBAAP,CAAwB,cAAxB,CAAjB;;YACIpS,eAAe,CAACmS,QAAD,CAAnB,EAA+B;UAC7BA,QAAQ,CAACra,OAAT,CAAiB,UAAClC,IAAD;mBAAUA,IAAI,CAAC8Y,MAAL,EAAV;WAAjB;;;QAIFnP,WAAW,CAACnB,QAAD,CAAX;QAGA3H,wBAAwB,CAACV,qBAAD,CAAxB;QAGA5B,YAAY,CAACC,UAAD,CAAZ;QAGAoC,qBAAqB,CAACF,kBAAD,CAArB;YAEMK,KAAK,GAAG,IAAI0b,KAAJ,CAAU;UACtBH,MAAM,EAAEA,MADc;UAEtB/e,QAAQ,EAAEmf,QAAA,CAAmB;YAC3BC,WAAW,EAAE,KADc;YAE3BxQ,IAAI,EAAE;WAFE,CAFY;UAMtBmC,YAAY,EAAEsO,UAAA,CACmB;YAC7BpB,OAAO,EAAE;WAFC;SANF,CAAd;YAYM/W,GAAG,GAAG,IAAIqW,GAAJ,CAAQ;UAAE/Z,KAAK,EAALA,KAAF;UAAS7D,YAAY,EAAZA,YAAT;UAAuBK,QAAQ,EAARA;SAA/B,CAAZ;eACOkH,GAAG,CAACoY,IAAJ,CAAS;UAAE1W,WAAW,EAAXA,WAAF;UAAe1E,UAAU,EAAVA,UAAf;UAA2BlG,OAAO,EAAPA;SAApC,CAAP;OA/BiB,CAAnB;;;;;EAtI6Bqe,UAAU,CAAC9Y,SAAD,EAAY2Q,QAAZ;;ACzB3C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;CAAA;;;;;ACXA,SAASqL,kBAAT,CAA4BC,QAA5B,EAAsC1d,KAAtC,EAA6C2d,MAA7C,EAAqDC,OAArD,EAA8DC,oBAA9D,EAAoFC,gBAApF,EAEEC,UAFF,EAEcC,cAFd,EAE8BC,iBAF9B,EAEiDC,oBAFjD,EAEuE;MACjE,OAAOH,UAAP,KAAsB,SAA1B,EAAqC;IACnCE,iBAAiB,GAAGD,cAApB;IACAA,cAAc,GAAGD,UAAjB;IACAA,UAAU,GAAG,KAAb;;;MAIE/f,OAAO,GAAG,OAAO2f,MAAP,KAAkB,UAAlB,GAA+BA,MAAM,CAAC3f,OAAtC,GAAgD2f,MAA9D;;MAEID,QAAQ,IAAIA,QAAQ,CAACS,MAAzB,EAAiC;IAC/BngB,OAAO,CAACmgB,MAAR,GAAiBT,QAAQ,CAACS,MAA1B;IACAngB,OAAO,CAACogB,eAAR,GAA0BV,QAAQ,CAACU,eAAnC;IACApgB,OAAO,CAACqgB,SAAR,GAAoB,IAApB;;QAEIR,oBAAJ,EAA0B;MACxB7f,OAAO,CAACsgB,UAAR,GAAqB,IAArB;;;;MAKAV,OAAJ,EAAa;IACX5f,OAAO,CAACugB,QAAR,GAAmBX,OAAnB;;;MAGEY,IAAJ;;MAEIV,gBAAJ,EAAsB;IAEpBU,IAAI,GAAG,SAASA,IAAT,CAAcxL,OAAd,EAAuB;MAE5BA,OAAO,GAAGA,OAAO,IACjB,KAAKyL,MAAL,IAAe,KAAKA,MAAL,CAAYC,UADjB,IAEV,KAAK1a,MAAL,IAAe,KAAKA,MAAL,CAAYya,MAA3B,IAAqC,KAAKza,MAAL,CAAYya,MAAZ,CAAmBC,UAFxD;;UAKI,CAAC1L,OAAD,IAAY,OAAO2L,mBAAP,KAA+B,WAA/C,EAA4D;QAC1D3L,OAAO,GAAG2L,mBAAV;;;UAIE3e,KAAJ,EAAW;QACTA,KAAK,CAAC4e,IAAN,CAAW,IAAX,EAAiBX,iBAAiB,CAACjL,OAAD,CAAlC;;;UAIEA,OAAO,IAAIA,OAAO,CAAC6L,qBAAvB,EAA8C;QAC5C7L,OAAO,CAAC6L,qBAAR,CAA8BjK,GAA9B,CAAkCkJ,gBAAlC;;KAlBJ;;IAwBA9f,OAAO,CAAC8gB,YAAR,GAAuBN,IAAvB;GA1BF,MA2BO,IAAIxe,KAAJ,EAAW;IAChBwe,IAAI,GAAGT,UAAU,GAAG,YAAY;MAC9B/d,KAAK,CAAC4e,IAAN,CAAW,IAAX,EAAiBV,oBAAoB,CAAC,KAAKa,KAAL,CAAWC,QAAX,CAAoBC,UAArB,CAArC;KADe,GAEb,UAAUjM,OAAV,EAAmB;MACrBhT,KAAK,CAAC4e,IAAN,CAAW,IAAX,EAAiBZ,cAAc,CAAChL,OAAD,CAA/B;KAHF;;;MAOEwL,IAAJ,EAAU;QACJxgB,OAAO,CAACsgB,UAAZ,EAAwB;UAElBY,cAAc,GAAGlhB,OAAO,CAACmgB,MAA7B;;MAEAngB,OAAO,CAACmgB,MAAR,GAAiB,SAASgB,wBAAT,CAAkCC,CAAlC,EAAqCpM,OAArC,EAA8C;QAC7DwL,IAAI,CAACI,IAAL,CAAU5L,OAAV;eACOkM,cAAc,CAACE,CAAD,EAAIpM,OAAJ,CAArB;OAFF;KAJF,MAQO;UAEDqM,QAAQ,GAAGrhB,OAAO,CAACshB,YAAvB;MACAthB,OAAO,CAACshB,YAAR,GAAuBD,QAAQ,GAAG,GAAGE,MAAH,CAAUF,QAAV,EAAoBb,IAApB,CAAH,GAA+B,CAACA,IAAD,CAA9D;;;;SAIGb,MAAP;;;AAGF,wBAAc,GAAGF,kBAAjB;;;ADrFA,AAEA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AEUA;;;;;;;;;;;;;CAAA;;;;;;AAbA,AAEA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACKA,uBAAe;EACb5e,IADa,kBACN;WACE;MACL2gB,WAAW,EAAE;KADf;GAFW;EAMb1gB,OANa,qBAMH;SACH2gB,OAAL,GAAe,IAAf;GAPW;EASbC,OAAO,EAAE;IAEPC,gBAFO,4BAEUC,MAFV,EAEkB;WAClBJ,WAAL,GAAmB,IAAnB;;UACII,MAAJ,EAAY;aACLH,OAAL,GAAeG,MAAf;;YACI,KAAKC,eAAL,YAAgCC,QAApC,EAA8C;eACvCD,eAAL;;;;;CAhBV;;ACgBO,IAAME,sBAAsB,GAAG;EACpCxhB,OADoC,qBAC1B;WACD;MACLyhB,UAAU,EAAE,KAAKC;KADnB;GAFkC;EAMpCX,YANoC,0BAMrB;QAET,KAAKW,SAAT,EAAoB;aACXriB,WAAW,CAAC,sBAAD,CAAlB;;;SAEGqiB,SAAL,GAAiB,IAAIC,GAAJ,EAAjB;;CAXG;AAeP,AAAO,IAAMC,qBAAqB,GAAG;EACnCvhB,MAAM,EAAE;IACNohB,UAAU,EAAE;MACV3iB,IAAI,EAAEY,MADI;MAEVjB,OAAO,EAAE;;GAJsB;EAOnC8B,OAPmC,qBAOzB;SACHmhB,SAAL,GAAiB,KAAKD,UAAL,IAAmB,KAAKI,KAAL,CAAWC,QAA/C;;CARG;;AC1BP,IAAMC,SAAS,GAAG,oBAAlB;AAEA,IAAaC,aAAa,GAAG;EAC3BC,MAAM,EAAE,CAACC,gBAAD,EAAmBV,sBAAnB,CADmB;EAE3BL,OAAO,EAAE;IACPgB,UADO,sBACId,MADJ,EACY;WACZe,KAAL,CAAW,MAAX,EAAmBf,MAAnB;WACKK,SAAL,CAAeU,KAAf,CAAqBL,SAArB,EAAgCV,MAAhC;WACKK,SAAL,CAAeR,OAAf,GAAyBG,MAAzB;;WACKD,gBAAL,CAAsBC,MAAtB;;;CAPC;AAYP,IAAagB,YAAY,GAAG;EAC1BJ,MAAM,EAAE,CAACC,gBAAD,EAAmBN,qBAAnB,CADkB;EAE1BT,OAAO,EAAE;IACPmB,WADO,uBACKjB,MADL,EACa;WAEbK,SAAL,CAAea,IAAf,CAAoBR,SAApB,EAA+B,KAAKO,WAApC;;WACKlB,gBAAL,CAAsBC,MAAtB;;GANsB;EAS1B9gB,OAT0B,qBAShB;QAEF8gB,MAAM,GAAG,KAAKK,SAAL,CAAeR,OAA9B;;QACIG,MAAJ,EAAY;WACLH,OAAL,GAAeG,MAAf;;WACKiB,WAAL,CAAiBjB,MAAjB;KAFF,MAGO;WACAK,SAAL,CAAec,GAAf,CAAmBT,SAAnB,EAA8B,KAAKO,WAAnC;;;CAhBC;;AC8BP;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;CAAA;;;;;;AAzDA,AAEA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACoCA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;CAAA;;;;;;AAvCA,AAEA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACoCA,8BAAA;AAEA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;CAAA;;;;;;AAzCA,AAEA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACgBA,oBAAe;EACbL,MAAM,EAAE,CAACL,qBAAD,EAAwBS,YAAxB,CADK;EAEblB,OAAO,EAAE;IACPzI,KADO,mBACC;WACDgJ,SAAL,CAAeU,KAAf,CAAqB,OAArB;;;CAJN;;ACGA,4BAAe;EACbH,MAAM,EAAE,CAACL,qBAAD,EAAwBS,YAAxB,CADK;EAEb/hB,IAFa,kBAEN;WACE;MACLmiB,mBAAmB,EAAE;KADvB;GAHW;EAObtB,OAAO,EAAE;IACPuB,mBADO,iCACgD;UAAnC7N,KAAmC,uEAA3B,CAAC,KAAK4N,mBAAqB;WAChDA,mBAAL,GAA2B5N,KAA3B;WACKqM,OAAL,CAAavjB,OAAb,CAAqBglB,aAArB,CAAmCjR,YAAnC,CAAgDmD,KAAhD;KAHK;IAQPyM,eARO,6BAQW;;;UACVqB,aAAa,GAAG,KAAKzB,OAAL,CAAavjB,OAAb,CAAqBglB,aAA3C;MACAA,aAAa,CAAClf,EAAd,CAAiB,KAAjB,EAAwB,UAAC4I,GAAD,EAAS;YAC3BA,GAAG,CAACwI,KAAR,EAAe;cACP0B,WAAW,GAAGlK,GAAG,CAAC/L,IAAxB;;cACIiW,WAAW,CAACnX,MAAhB,EAAwB;YACtB,KAAI,CAACsjB,mBAAL,CAAyB,KAAzB;;YACA,KAAI,CAAChB,SAAL,CAAeU,KAAf,CAAqB,aAArB,EAAoC,gBAApC,EAAsD7L,WAAtD;WAFF,MAGO;YACL,KAAI,CAACqM,QAAL,CAAcC,IAAd,CAAmB,MAAnB;;YACA,KAAI,CAACnB,SAAL,CAAeU,KAAf,CAAqB,aAArB;;SAPJ,MASO;UACLvV,YAAY,CAACR,GAAG,CAACyW,OAAL,CAAZ;;UACA,KAAI,CAACpB,SAAL,CAAeU,KAAf,CAAqB,aAArB;;OAZJ;MAeAO,aAAa,CAAClf,EAAd,CAAiB,QAAjB,EAA2B,UAACgU,GAAD;eACzB,KAAI,CAACiK,SAAL,CAAeU,KAAf,CAAqB,mBAArB,EAA0C3K,GAA1C,CADyB;OAA3B;;GAhCS;EAqCblX,OArCa,qBAqCH;SACHmhB,SAAL,CAAec,GAAf,CAAmB,qBAAnB,EAA0C,KAAKE,mBAA/C;GAtCW;EAwCbK,aAxCa,2BAwCG;SACTrB,SAAL,CAAea,IAAf,CAAoB,qBAApB,EAA2C,KAAKG,mBAAhD;;QAGI,KAAKxB,OAAT,EAAkB;UACVyB,aAAa,GAAG,KAAKzB,OAAL,CAAavjB,OAAb,CAAqBglB,aAA3C;MACAA,aAAa,CAACK,MAAd;;;CA9CN;;ACpBA,eAAe,IAAIrB,GAAJ,EAAf;;ACgBA,wBAAe;EACbR,OAAO,EAAE;IACP8B,iBADO,+BACa;MAClBre,QAAQ,CAACwd,KAAT,CAAe,mBAAf;;;CAHN;;ACyDA;;;;;;;;;;;;;;;;;;;;;;;;;CAAA;;;;;;AA3EA,AAEA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACeA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;CAAA;;;;;;AAlBA,AAEA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACqBA;;;;;;;CAAA;;;;;;AAxBA,AAEA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC2EA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;CAAA;;;;;;AA9EA,AAEA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACuCA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;CAAA;;;;;;;;;AA1CA,AAEA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACgBA;;;;;;;;CAAA;;;;;;AAnBA,AAEA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACiBA;;;;;;;;;CAAA;;;;;;AApBA,AAEA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACqEA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;CAAA;;;;;;AAxEA,AAEA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACwBA;;;;;;;;;;;;;;;;;;;;;;;;;CAAA;;;;;;;;;AA3BA,AAEA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACaA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;CAAA;;;AAhBA,AAEA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACeA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;CAAA;;;AAjBA,AAEA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACaA;;;;CAAA;AAMA;;;;;;;;;;;;;;;;;;;;;;CAAA;;;AArBA,AAEA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACoBA;;;;;;;;;;;;;;;;;;;;;;;;;;CAAA;;;;;;;;;AAtBA,AAEA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACyDA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;CAAA;;;;;;AA5DA,AAEA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACMA,iBAAe;KACV;IACDc,MAAM,EAAE,MADP;IAEDC,KAAK,EAAE,CAAC,EAAD;GAHI;KAKV;IACDD,MAAM,EAAE,MADP;IAEDC,KAAK,EAAE,CAAC,EAAD,EAAK,EAAL;GAPI;KASV;IACDD,MAAM,EAAE,KADP;IAEDC,KAAK,EAAE,CAAC,EAAD,EAAK,EAAL,EAAS,EAAT;GAXI;KAaV;IACDD,MAAM,EAAE,KADP;IAEDC,KAAK,EAAE,CAAC,EAAD,EAAK,EAAL,EAAS,EAAT,EAAa,EAAb;GAfI;KAiBV;IACDD,MAAM,EAAE,KADP;IAEDC,KAAK,EAAE,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,EAAV,EAAc,EAAd;GAnBI;KAqBV;IACDD,MAAM,EAAE,KADP;IAEDC,KAAK,EAAE,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,EAAa,CAAb,EAAgB,CAAhB;;CAvBX;;ACCA;;;;;CAAA;;;;;;AAVA,AAEA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACkCA;;;;;;;;;CAAA;;;;;;AArCA,AAEA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACyBA;;;;;;;;;;;;;;;;;;;CAAA;;;;;;AA5BA,AAEA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACwBA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;CAAA;;;;;;AA3BA,AAEA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACuFA;;;;;;;;;;;;;;;;;CAAA;;;;;;AA1FA,AAEA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACuBA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;CAAA;;;;;;AA1BA,AAEA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACsBA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;CAAA;;;AAzBA,AAEA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACqDA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;CAAA;;;;;;AAvDA,AAEA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACCAjlB,YAAY,CAACklB,OAAb,GAAuB,UAACzB,GAAD,EAAS;EAC9BA,GAAG,CAAC0B,SAAJ,CAAc,oBAAd,EAAoCnlB,YAApC;CADF;;;;;ACWA,IAAM0G,UAAQ,GAAG,IAAI+c,GAAJ,EAAjB;AACA,IAAMI,WAAS,GAAG,mBAAlB;AAGA,IAAauB,mBAAmB,GAAG;EACjCrB,MAAM,EAAE,CAACC,gBAAD,CADyB;EAEjCf,OAAO,EAAE;IACPgB,UADO,sBACId,MADJ,EACY;MACjBzc,UAAQ,CAACwd,KAAT,CAAeL,WAAf,EAA0BV,MAA1B;MACAzc,UAAQ,CAACsc,OAAT,GAAmBG,MAAnB;;WACKD,gBAAL,CAAsBC,MAAtB;;;CANC;AAYP,IAAakC,kBAAkB,GAAG;EAChCtB,MAAM,EAAE,CAACC,gBAAD,CADwB;EAEhCf,OAAO,EAAE;IACPmB,WADO,uBACKjB,MADL,EACa;MAElBzc,UAAQ,CAAC2d,IAAT,CAAcR,WAAd,EAAyB,KAAKO,WAA9B;;WACKlB,gBAAL,CAAsBC,MAAtB;;GAN4B;EAShC9gB,OATgC,qBAStB;QAEF8gB,MAAM,GAAGzc,UAAQ,CAACsc,OAAxB;;QACIG,MAAJ,EAAY;WACLH,OAAL,GAAeG,MAAf;;WACKiB,WAAL,CAAiBjB,MAAjB;KAFF,MAGO;MACLzc,UAAQ,CAAC4d,GAAT,CAAaT,WAAb,EAAwB,KAAKO,WAA7B;;;CAhBC;AAsBP;AASAkB,QAAM,CAACJ,OAAP,GAAiB,UAACzB,GAAD,EAAS;EACxBA,GAAG,CAAC0B,SAAJ,CAAc,QAAd,EAAwBG,QAAxB;EACA7B,GAAG,CAAC8B,GAAJ,CAAQC,YAAR;CAFF;;;;;"}