[TOC]

# 其他组件

| 组件名          | 描述         |
| --------------- | ------------ |
| `diff-analysis` | 差异分析组件 |

## 组件说明

### diff-analysis 差异分析组件（待完成）

```vue
<template>
  <WebGISDiffAnalysis
    v-if="webgisGroup.item1 || webgisGroup.item2"
    ref="webgisDiffAnalysis"
    :webgis-group="webgisGroup"
    @webgisGroupInit="webgisGroupInit"
    @webgisResultInit="webgisResultInit"
  />
</template>

<script>
import WebGISDiffAnalysis from '@greatmap/vue-webgis/packages/diff-analysis';

export default {
  components: {
    WebGISDiffAnalysis
  },
  data() {
    return {
      webgisGroup: {
        item1: { id: 'X620102DC2018GDLTB', name: '城关区 2018 地类图斑' },
        item2: { id: 'X620102DC2019GDLTB', name: '城关区 2019 地类图斑' }
      }
    };
  },
  methods: {
    // 开始分析
    start() {
      this.$refs.webgisDiffAnalysis.doAnalysis().then(
        (res) => {
          // success
        },
        () => {
          // error
        }
      );
    },
    /**
     * 更新地图的 feature
     * @param {String} name webgis 名称 item1/2
     * @param {FeatureLike[]} features example:{ features: [], attributes: [] }
     */
    updateFeatures(name, features) {
      this.$refs.webgisDiffAnalysis.updateFeature(name, features);
    },

    // webgis 列表有地图完成了初始化
    webgisGroupInit(index, webgis) {},

    // 展示结果的地图完成了初始化
    webgisResultInit(webgis) {}
  }
};
</script>
```

#### Props

- `webgisGroup.item1/2` : Object，webgis 待分析的地图列表，例如：

```js
const webgisGroup = {
  item1: { id: 'X620102DC2018GDLTB', name: '城关区 2018 地类图斑' },
  item2: { id: 'X620102DC2019GDLTB', name: '城关区 2019 地类图斑' }
};
```

| 参数名 | 类型   | 说明       |
| ------ | ------ | ---------- |
| `id`   | String | 图层的 id  |
| `name` | String | 地图的名称 |

### Events

- `webgisGroupInit(index, webgis)` webgis 列表有地图完成了初始化

| 参数名   | 类型   | 说明                 |
| -------- | ------ | -------------------- |
| `index`  | Number | 初始化的 index 值    |
| `webgis` | Map    | 初始化的 webgis 实例 |

- `webgisResultInit(webgis)` 展示结果的地图完成了初始化

| 参数名   | 类型 | 说明                 |
| -------- | ---- | -------------------- |
| `webgis` | Map  | 初始化的 webgis 实例 |

#### Methods

- `doAnalysis()` 开始分析，返回 Promise 分析结果状态

- `updateFeature(name, features)` 更新地图的 feature，主要用于在选取完字段值后更新地图上的要素

| 参数名     | 类型             | 说明                     |
| ---------- | ---------------- | ------------------------ |
| `name`     | 'item1', 'item2' | 所更新列表项的 key 值    |
| `features` | FeatureLike[]    | 所更新列表项的的要素集合 |
